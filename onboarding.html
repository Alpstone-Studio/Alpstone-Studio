<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Concepteur de site - CrÃ©ez l'identitÃ© visuelle de votre site web">
    <title>Concepteur de site | Alpstone Studio</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Roboto:wght@400;500;700&family=Playfair+Display:wght@400;700;900&family=Source+Sans+Pro:wght@400;600;700&family=Montserrat:wght@400;600;700;900&family=Open+Sans:wght@400;600;700&family=Poppins:wght@400;600;700;900&family=Nunito:wght@400;600;700;900&family=Raleway:wght@400;600;700;900&family=Lato:wght@400;700;900&family=Kaushan+Script&family=Aref+Ruqaa:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="32x32" href="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png">
    <link rel="icon" type="image/png" sizes="16x16" href="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png">
    <link rel="apple-touch-icon" href="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png">
    <style>
        /* ==========================================
           ONBOARDING SPECIFIC STYLES
           ========================================== */

        :root {
            --text-dark: #1a1a1a;
            --text-light: rgba(0, 0, 0, 0.6);
            --text-secondary: rgba(0, 0, 0, 0.6);
            --primary-color: #438DD7;
        }

        /* Smooth color transition for all text elements */
        .step-title, .substep-title, h1, h2, h3,
        .step-description, .substep-description,
        p, .style-name, .typo-name, .typo-description,
        .setting-label, .color-section-title, .color-label {
            transition: color 0.3s ease;
        }

        /* Header and step indicator always black */
        .onboarding-header .onboarding-title,
        .onboarding-header .onboarding-subtitle,
        .step-indicator .step-number,
        .step-indicator .step-label {
            color: #1a1a1a !important;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
        }

        .onboarding-container {
            min-height: 100vh;
            padding: 90px 20px 110px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .onboarding-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(67, 141, 215, 0.1);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            z-index: 1000;
            animation: fadeInDown 0.8s ease;
            transition: all 0.3s ease;
        }

        .onboarding-logo {
            height: 36px;
            margin-bottom: 0;
            filter: drop-shadow(0 2px 8px rgba(67, 141, 215, 0.15));
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        .onboarding-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0;
            letter-spacing: -0.02em;
            display: inline-block;
            vertical-align: middle;
        }

        .onboarding-subtitle {
            font-size: 0.8rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 3px auto 0;
            transition: all 0.3s ease;
            overflow: hidden;
            display: block;
        }

        .onboarding-subtitle.hidden {
            display: none;
        }

        /* Back Button */
        .back-button {
            position: fixed;
            top: 12px;
            left: 16px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 10px;
            border: 1px solid rgba(67, 141, 215, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-size: 1.1rem;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(67, 141, 215, 0.1);
            z-index: 1001;
        }

        .back-button:hover {
            background: rgba(67, 141, 215, 0.1);
            border-color: rgba(67, 141, 215, 0.4);
            transform: translateX(-4px);
            box-shadow: 0 8px 24px rgba(67, 141, 215, 0.2);
        }

        .back-button:active {
            transform: translateX(-2px);
        }

        /* Step Indicator */
        .step-indicator {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: fit-content;
            display: flex;
            justify-content: center;
            gap: 12px;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(67, 141, 215, 0.15);
            border-radius: 50px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            position: relative;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(67, 141, 215, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-light);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 4px 4px 8px rgba(174, 174, 192, 0.15),
                        -4px -4px 8px rgba(255, 255, 255, 0.7);
        }

        .step.active .step-number {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.08);
            box-shadow: 0 3px 12px rgba(67, 141, 215, 0.4);
        }

        .step.completed .step-number {
            background: var(--primary-dark);
            color: white;
            border-color: var(--primary-dark);
        }

        .step-label {
            font-size: 0.7rem;
            color: var(--text-light);
            font-weight: 500;
            white-space: nowrap;
        }

        .step.active .step-label {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Content Area */
        .onboarding-content {
            width: 100%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        .content-main {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 48px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08),
                        0 2px 8px rgba(0, 0, 0, 0.04);
            min-height: 500px;
        }


        /* Animation indicator */
        .animation-indicator {
            display: none; /* Hidden as per user request */
        }

        /* Step Content */
        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .step-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-dark);
        }

        .step-description {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: 32px;
            line-height: 1.6;
        }

        /* Style Preview & Text */
        .style-preview {
            width: 100%;
            height: 80px;
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            padding: 12px;
            gap: 8px;
        }

        /* MIN - Minimal Pro: Clean animations */
        .style-preview-min {
            background: #ffffff;
            flex-direction: column;
            gap: 6px;
        }
        .preview-header {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            animation: minPulse 2s ease-in-out infinite;
        }
        .preview-card {
            width: 100%;
            height: 16px;
            background: #f5f5f5;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
            animation: minSlide 3s ease-in-out infinite;
        }
        .preview-card:nth-child(3) {
            animation-delay: 0.3s;
        }
        @keyframes minPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        @keyframes minSlide {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(3px); }
        }

        /* GLS - Modern Glass: Floating glass cards */
        .style-preview-gls {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            gap: 10px;
        }
        .preview-glass-card {
            width: 40px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: glassFloat 3s ease-in-out infinite;
        }
        .preview-glass-card-2 {
            animation-delay: 1.5s;
        }
        @keyframes glassFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-5px) scale(1.05); }
        }

        /* SFT - Soft UI: Soft elevating elements */
        .style-preview-sft {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            flex-direction: column;
            gap: 8px;
        }
        .preview-soft-card {
            width: 70%;
            height: 28px;
            background: #ffffff;
            border-radius: 14px;
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.2);
            animation: softElevate 2.5s ease-in-out infinite;
        }
        .preview-soft-btn {
            width: 40%;
            height: 18px;
            background: #4285F4;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(66, 133, 244, 0.4);
            animation: softPulse 2s ease-in-out infinite;
        }
        @keyframes softElevate {
            0%, 100% { transform: translateY(0); box-shadow: 0 4px 12px rgba(66, 133, 244, 0.2); }
            50% { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(66, 133, 244, 0.3); }
        }
        @keyframes softPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* EDT - Editorial: Bold borders */
        .style-preview-edt {
            background: #ffffff;
            flex-direction: column;
            gap: 8px;
        }
        .preview-edt-header {
            width: 100%;
            height: 12px;
            background: transparent;
            border-top: 4px solid #E91E63;
            animation: edtExpand 2s ease-in-out infinite;
        }
        .preview-edt-box {
            width: 60%;
            height: 35px;
            background: transparent;
            border: 3px solid #E91E63;
            border-radius: 4px;
            animation: edtRotate 3s ease-in-out infinite;
        }
        @keyframes edtExpand {
            0%, 100% { width: 100%; }
            50% { width: 80%; }
        }
        @keyframes edtRotate {
            0%, 100% { transform: rotate(0deg); border-color: #E91E63; }
            50% { transform: rotate(2deg); border-color: #9C27B0; }
        }

        /* LUX - Luxury Dark: Glowing gold accents */
        .style-preview-lux {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            gap: 10px;
        }
        .preview-lux-card {
            width: 45px;
            height: 50px;
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 6px;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            animation: luxGlow 2s ease-in-out infinite;
        }
        .preview-lux-accent {
            width: 20px;
            height: 20px;
            background: #D4AF37;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            animation: luxPulse 2s ease-in-out infinite;
        }
        @keyframes luxGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
            50% { box-shadow: 0 0 30px rgba(212, 175, 55, 0.6), 0 0 40px rgba(212, 175, 55, 0.3); }
        }
        @keyframes luxPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 15px rgba(212, 175, 55, 0.6); }
            50% { transform: scale(1.2); box-shadow: 0 0 25px rgba(212, 175, 55, 0.8); }
        }

        /* BRT - Brutal Modern: Hard shadows */
        .style-preview-brt {
            background: #000000;
            gap: 12px;
        }
        .preview-brt-box {
            width: 45px;
            height: 45px;
            background: #ffffff;
            border: 3px solid #FF5722;
            border-radius: 4px;
            box-shadow: 6px 6px 0 #FF5722;
            animation: brtShift 2s ease-in-out infinite;
        }
        .preview-brt-line {
            width: 25px;
            height: 4px;
            background: #FF5722;
            animation: brtGrow 2s ease-in-out infinite;
        }
        @keyframes brtShift {
            0%, 100% { transform: translate(0, 0); box-shadow: 6px 6px 0 #FF5722; }
            50% { transform: translate(-2px, -2px); box-shadow: 8px 8px 0 #FF5722; }
        }
        @keyframes brtGrow {
            0%, 100% { width: 25px; }
            50% { width: 35px; }
        }

        /* RTF - Retro Future: Neon glow */
        .style-preview-rtf {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 100%);
            gap: 10px;
        }
        .preview-rtf-grid {
            width: 40px;
            height: 40px;
            background: transparent;
            border: 2px solid #9C27B0;
            border-radius: 4px;
            box-shadow: 0 0 15px rgba(156, 39, 176, 0.6), inset 0 0 10px rgba(156, 39, 176, 0.2);
            animation: rtfGlow 2s ease-in-out infinite;
            position: relative;
        }
        .preview-rtf-grid::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: #9C27B0;
            box-shadow: 0 0 8px rgba(156, 39, 176, 0.8);
        }
        .preview-rtf-glow {
            width: 15px;
            height: 15px;
            background: #9C27B0;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(156, 39, 176, 0.8), 0 0 40px rgba(156, 39, 176, 0.4);
            animation: rtfPulse 1.5s ease-in-out infinite;
        }
        @keyframes rtfGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(156, 39, 176, 0.6), inset 0 0 10px rgba(156, 39, 176, 0.2); }
            50% { box-shadow: 0 0 30px rgba(156, 39, 176, 0.8), 0 0 50px rgba(156, 39, 176, 0.4), inset 0 0 15px rgba(156, 39, 176, 0.3); }
        }
        @keyframes rtfPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(156, 39, 176, 0.8), 0 0 40px rgba(156, 39, 176, 0.4); }
            50% { transform: scale(1.3); box-shadow: 0 0 30px rgba(156, 39, 176, 1), 0 0 60px rgba(156, 39, 176, 0.6); }
        }

        .style-name {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-dark);
        }

        .style-category {
            font-size: 0.7rem;
            color: var(--primary-color);
            font-weight: 500;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .style-description {
            font-size: 0.8rem;
            color: var(--text-light);
            line-height: 1.4;
        }

        /* Color Picker Section */
        .colors-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 24px;
        }

        .color-section {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            padding: 20px;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.05);
        }

        .color-role-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-dark);
            text-align: center;
        }

        .color-picker-wrapper {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
        }

        .color-input {
            width: 80px;
            height: 80px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            position: relative;
            display: none; /* Hide default input */
        }

        .color-input:hover {
            transform: scale(1.05);
        }

        /* Custom Color Picker */
        .custom-color-picker {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            position: relative;
            border: 3px solid white;
        }

        .custom-color-picker:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        }

        .custom-color-picker::after {
            content: 'ðŸŽ¨';
            position: absolute;
            bottom: 4px;
            right: 4px;
            font-size: 1.2rem;
            background: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* Color Picker Modal */
        .color-picker-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .color-picker-modal.active {
            display: flex;
        }

        .color-picker-content {
            background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }

        .color-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .color-picker-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .color-picker-close {
            background: rgba(255, 255, 255, 0.6);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .color-picker-close:hover {
            background: rgba(255, 0, 0, 0.1);
            transform: rotate(90deg);
        }

        .color-picker-preview {
            width: 100%;
            height: 80px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .color-picker-section {
            margin-bottom: 24px;
        }

        .color-picker-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
            display: block;
        }

        .color-presets {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .color-preset {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .color-preset:hover {
            transform: scale(1.1);
            border-color: var(--primary-color);
        }

        .color-preset.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary-color);
        }

        .hue-slider-container {
            margin-bottom: 16px;
        }

        .hue-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 12px;
            border-radius: 6px;
            background: linear-gradient(to right,
                #ff0000 0%, #ffff00 17%, #00ff00 33%,
                #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%);
            outline: none;
            cursor: pointer;
        }

        .hue-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 2px solid #333;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hue-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 2px solid #333;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .lightness-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 12px;
            border-radius: 6px;
            outline: none;
            cursor: pointer;
        }

        .lightness-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 2px solid #333;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .lightness-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            border: 2px solid #333;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .color-text-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            font-family: var(--font-primary);
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            text-align: center;
        }

        .color-text-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(67, 141, 215, 0.1);
        }

        .color-feedback {
            margin-top: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 0.9rem;
            display: none;
        }

        .color-feedback.valid {
            background: rgba(76, 175, 80, 0.1);
            color: #2E7D32;
            border: 1px solid rgba(76, 175, 80, 0.3);
            display: block;
        }

        .color-feedback.warning {
            background: rgba(255, 152, 0, 0.1);
            color: #E65100;
            border: 1px solid rgba(255, 152, 0, 0.3);
            display: block;
        }

        .color-feedback.error {
            background: rgba(244, 67, 54, 0.1);
            color: #C62828;
            border: 1px solid rgba(244, 67, 54, 0.3);
            display: block;
        }

        /* Typography Options */
        .typo-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 24px;
        }

        .typo-option {
            background: #ffffff;
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px 20px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06),
                        0 1px 2px rgba(0, 0, 0, 0.04);
        }

        .typo-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1),
                        0 4px 8px rgba(0, 0, 0, 0.06);
            border-color: rgba(67, 141, 215, 0.3);
        }

        .typo-option.selected {
            border-color: var(--primary-color);
            background: rgba(67, 141, 215, 0.04);
            box-shadow: 0 0 0 3px rgba(67, 141, 215, 0.15),
                        0 4px 12px rgba(67, 141, 215, 0.2);
        }

        .typo-sample {
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .typo-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-dark);
        }

        .typo-desc {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        /* Settings Section */
        .settings-grid {
            display: grid;
            gap: 24px;
            margin-top: 24px;
        }

        .setting-item {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            padding: 24px;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* Sub-steps for Step 4 */
        .substep-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 32px;
        }

        .substep-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(67, 141, 215, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .substep-dot.active {
            background: var(--primary-color);
            width: 32px;
            border-radius: 6px;
        }

        .substep-dot:hover {
            background: rgba(67, 141, 215, 0.4);
        }

        .substep-content {
            display: none;
        }

        .substep-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .substep-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-dark);
        }

        .substep-description {
            font-size: 1rem;
            color: var(--text-light);
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .setting-label {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-dark);
        }

        .setting-options {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .setting-option {
            padding: 14px 28px;
            border-radius: 12px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            background: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        }

        .setting-option:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: rgba(67, 141, 215, 0.3);
        }

        .setting-option.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 4px 16px rgba(67, 141, 215, 0.3);
            font-weight: 600;
        }

        /* Summary Section */
        .summary-section {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.05);
        }

        .summary-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1a1a1a !important;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-weight: 500;
            color: #2c3e50 !important;
        }

        .summary-value {
            font-weight: 600;
            color: #1a1a1a !important;
        }

        /* Token Display */
        .token-display {
            background: var(--primary-dark);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(32, 55, 93, 0.3);
        }

        .token-label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .token-value {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            word-break: break-all;
            background: rgba(0, 0, 0, 0.2);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .token-actions {
            display: flex;
            gap: 12px;
        }

        .token-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .token-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 32px;
            gap: 16px;
        }

        .btn-nav {
            padding: 16px 40px;
            border-radius: 12px;
            border: 2px solid transparent;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-prev {
            background: transparent;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .btn-prev:hover {
            background: rgba(67, 141, 215, 0.1);
            transform: translateY(-2px);
        }

        .btn-next {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 16px rgba(67, 141, 215, 0.25);
        }

        .btn-next:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(67, 141, 215, 0.35);
        }

        .btn-next.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-validate {
            background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%);
            color: white;
            box-shadow: 0 4px 16px rgba(76, 175, 80, 0.3);
        }

        .btn-validate:hover {
            box-shadow: 0 8px 24px rgba(76, 175, 80, 0.4);
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes ctaPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            }
        }

        /* Welcome Screen */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.5s ease;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .welcome-content {
            text-align: center;
            max-width: 600px;
            padding: 20px;
        }

        /* Welcome screen specific sizes (large) */
        .welcome-screen .onboarding-logo {
            height: 80px;
            margin-bottom: 24px;
            filter: drop-shadow(0 2px 8px rgba(67, 141, 215, 0.15));
        }

        .welcome-screen .onboarding-title {
            font-size: 3rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .welcome-screen .onboarding-subtitle {
            font-size: 1.2rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto 32px;
        }

        .welcome-actions {
            display: flex;
            gap: 24px;
            margin-top: 48px;
            justify-content: center;
            flex-wrap: nowrap;
            align-items: center;
        }

        .welcome-btn {
            padding: 24px 32px;
            border-radius: 16px;
            border: none;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 300px;
            min-height: 180px;
            box-shadow: 12px 12px 24px rgba(174, 174, 192, 0.2),
                        -12px -12px 24px rgba(255, 255, 255, 0.8);
        }

        .welcome-btn i {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        .welcome-btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .welcome-btn-primary:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(67, 141, 215, 0.4);
        }

        .welcome-btn-secondary {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            color: var(--text-dark);
            border: 2px solid var(--primary-color);
        }

        .welcome-btn-secondary:hover {
            transform: translateY(-4px);
            background: rgba(67, 141, 215, 0.1);
        }

        .welcome-btn-subtitle {
            font-size: 0.85rem;
            font-weight: 400;
            opacity: 0.9;
        }

        /* Custom Modal */
        .custom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .custom-modal.active {
            display: flex;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(30px);
            border-radius: 30px;
            padding: 48px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .modal-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }

        .modal-icon.success {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
        }

        .modal-icon.error {
            background: rgba(244, 67, 54, 0.1);
            color: #F44336;
        }

        .modal-icon.warning {
            background: rgba(255, 152, 0, 0.1);
            color: #FF9800;
        }

        .modal-icon.info {
            background: rgba(67, 141, 215, 0.1);
            color: var(--primary-color);
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1a1a1a !important;
            flex: 1;
        }

        .modal-body {
            margin-bottom: 32px;
            font-size: 1.05rem;
            color: #2c3e50 !important;
            line-height: 1.6;
        }

        .modal-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(67, 141, 215, 0.2);
            border-radius: 12px;
            font-family: var(--font-primary);
            font-size: 1rem;
            margin-bottom: 24px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(67, 141, 215, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 14px 32px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 16px rgba(67, 141, 215, 0.3);
        }

        .modal-btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .modal-btn-secondary {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-dark);
        }

        .modal-btn-secondary:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Example Fullscreen Modal */
        .example-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            z-index: 3000;
            overflow-y: auto;
        }

        .example-modal.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .example-close {
            position: fixed;
            top: 32px;
            right: 32px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 3001;
        }

        .example-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .example-content {
            padding: 80px 40px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .example-header {
            text-align: center;
            margin-bottom: 48px;
            color: white;
        }

        .example-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.7;
            margin-bottom: 12px;
        }

        .example-name {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .example-desc {
            font-size: 1.2rem;
            opacity: 0.8;
            max-width: 600px;
            margin: 0 auto;
        }

        .example-preview {
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
            margin-bottom: 32px;
        }

        .example-site {
            min-height: 600px;
            padding: 0;
        }

        /* Full Site Demo Modal */
        .full-site-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.98);
            display: none;
            z-index: 4000;
            flex-direction: column;
        }

        .full-site-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .full-site-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 32px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .full-site-title {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .full-site-title i {
            font-size: 1.4rem;
            color: var(--primary-color);
        }

        .full-site-close {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .full-site-close:hover {
            background: rgba(255, 59, 48, 0.8);
            border-color: rgba(255, 59, 48, 1);
            transform: rotate(90deg);
        }

        .full-site-content {
            flex: 1;
            background: #1a1a1a;
            overflow: hidden;
        }

        /* Smaller cards for full picture mode */
        .style-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 24px;
        }

        .style-card {
            background: #ffffff;
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06),
                        0 1px 2px rgba(0, 0, 0, 0.04);
            position: relative;
        }

        .style-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1),
                        0 4px 8px rgba(0, 0, 0, 0.06);
            border-color: rgba(67, 141, 215, 0.3);
        }

        .style-card.selected {
            border-color: var(--primary-color);
            background: rgba(67, 141, 215, 0.04);
            box-shadow: 0 0 0 3px rgba(67, 141, 215, 0.15),
                        0 4px 12px rgba(67, 141, 215, 0.2);
        }

        .style-preview-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(67, 141, 215, 0.95);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 1;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(67, 141, 215, 0.3);
        }

        .style-card:hover .style-preview-btn {
            opacity: 1;
        }

        .style-preview-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(67, 141, 215, 0.4);
        }

        /* Responsive */
        @media (max-width: 968px) {

            .step-indicator {
                flex-wrap: wrap;
                gap: 8px;
                padding: 10px 16px;
            }

            .step-label {
                display: none;
            }

            .style-grid,
            .typo-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .example-name {
                font-size: 2rem;
            }
        }

        @media (max-width: 640px) {
            .onboarding-title {
                font-size: 2rem;
            }

            .content-main {
                padding: 24px;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .welcome-actions {
                flex-direction: column;
            }

            .welcome-btn {
                width: 100%;
                max-width: 300px;
            }

            .btn-nav {
                width: 100%;
                justify-content: center;
            }

            .modal-content {
                padding: 32px 24px;
            }

            .example-content {
                padding: 60px 20px 20px;
            }

            .style-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 12px;
            }
        }

        /* Set animations and transitions to 0 duration when animations are off */
        body.no-animations *,
        body.no-animations *::before,
        body.no-animations *::after {
            animation-duration: 0s !important;
            animation-delay: 0s !important;
            transition-duration: 0s !important;
            transition-delay: 0s !important;
        }

        /* Disable hover transform effects when animations are off (keep colors/shadows) */
        body.no-animations .style-card:hover,
        body.no-animations .typo-option:hover,
        body.no-animations .setting-option:hover,
        body.no-animations .btn:hover,
        body.no-animations .btn-next:hover,
        body.no-animations .btn-prev:hover,
        body.no-animations .btn-validate:hover,
        body.no-animations .custom-color-picker:hover,
        body.no-animations .color-preset:hover,
        body.no-animations .substep-dot:hover {
            transform: none !important;
        }
    </style>
</head>
<body>
    <!-- Back Button -->
    <a href="index.html" class="back-button" title="Retour Ã  l'accueil">
        <i class="fas fa-arrow-left"></i>
    </a>

    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <img src="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png" alt="Alpstone Studio" class="onboarding-logo">
            <h1 class="onboarding-title">Concepteur de site</h1>
            <p class="onboarding-subtitle">Inspirez-vous et trouvez le style visuel parfait pour votre projet</p>

            <div class="welcome-actions">
                <button class="welcome-btn welcome-btn-primary" onclick="startOnboarding()">
                    <i class="fas fa-paint-brush"></i>
                    <span>CrÃ©er mon design</span>
                    <span class="welcome-btn-subtitle">Commencer la crÃ©ation</span>
                </button>
                <button class="welcome-btn welcome-btn-secondary" onclick="showTokenInput()">
                    <i class="fas fa-key"></i>
                    <span>J'ai dÃ©jÃ  un code de design</span>
                    <span class="welcome-btn-subtitle">Charger une configuration</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Modal -->
    <div class="custom-modal" id="customModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon" id="modalIcon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <h3 class="modal-title" id="modalTitle">Titre</h3>
            </div>
            <div class="modal-body" id="modalBody">Message</div>
            <div id="modalInputContainer"></div>
            <div class="modal-actions" id="modalActions">
                <button class="modal-btn modal-btn-primary" id="modalConfirm">OK</button>
            </div>
        </div>
    </div>

    <!-- Example Fullscreen Modal -->
    <div class="example-modal" id="exampleModal">
        <button class="example-close" onclick="closeExample()">
            <i class="fas fa-times"></i>
        </button>
        <div class="example-content">
            <div class="example-header">
                <div class="example-label" id="exampleCategory">CATÃ‰GORIE</div>
                <h2 class="example-name" id="exampleName">Nom du style</h2>
                <p class="example-desc" id="exampleDesc">Description du style</p>
            </div>
            <div class="example-preview">
                <div class="example-site" id="exampleSite">
                    <!-- Dynamic content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Full Site Demo Modal -->
    <div class="full-site-modal" id="fullSiteModal">
        <div class="full-site-header">
            <div class="full-site-title">
                <i class="fas fa-globe"></i>
                <span>AperÃ§u du site complet</span>
            </div>
            <button class="full-site-close" onclick="closeFullSite()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="full-site-content">
            <iframe id="fullSiteFrame" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <div class="onboarding-container" id="onboardingContainer" style="display: none;">
        <!-- Header -->
        <div class="onboarding-header">
            <div>
                <img src="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png" alt="Alpstone Studio" class="onboarding-logo">
                <h1 class="onboarding-title">Concepteur de site</h1>
                <p class="onboarding-subtitle" id="onboardingSubtitle">Inspirez-vous et trouvez le style visuel parfait pour votre projet</p>
            </div>
        </div>

        <!-- Content -->
        <div class="onboarding-content">
            <!-- Main Content -->
            <div class="content-main">
                <!-- Step 1: Style Selection -->
                <div class="step-content active" data-step="1">
                    <h2 class="step-title">Choisissez votre style visuel</h2>
                    <p class="step-description">SÃ©lectionnez le style qui correspond le mieux Ã  votre vision</p>

                    <div class="style-grid">
                        <div class="style-card" data-style="MIN" data-category="Classique">
                            <button class="style-preview-btn" onclick="showExample('MIN', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-min">
                                <div class="preview-header"></div>
                                <div class="preview-card"></div>
                                <div class="preview-card"></div>
                            </div>
                            <div class="style-category">Classique</div>
                            <div class="style-name">Minimal Pro</div>
                            <div class="style-description">Ã‰purÃ© et moderne</div>
                        </div>

                        <div class="style-card" data-style="GLS" data-category="Moderne">
                            <button class="style-preview-btn" onclick="showExample('GLS', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-gls">
                                <div class="preview-glass-card"></div>
                                <div class="preview-glass-card preview-glass-card-2"></div>
                            </div>
                            <div class="style-category">Moderne</div>
                            <div class="style-name">Modern Glass</div>
                            <div class="style-description">Transparences premium</div>
                        </div>

                        <div class="style-card" data-style="SFT" data-category="Classique">
                            <button class="style-preview-btn" onclick="showExample('SFT', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-sft">
                                <div class="preview-soft-card"></div>
                                <div class="preview-soft-btn"></div>
                            </div>
                            <div class="style-category">Classique</div>
                            <div class="style-name">Soft UI</div>
                            <div class="style-description">Doux et arrondi</div>
                        </div>

                        <div class="style-card" data-style="EDT" data-category="Audacieux">
                            <button class="style-preview-btn" onclick="showExample('EDT', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-edt">
                                <div class="preview-edt-header"></div>
                                <div class="preview-edt-box"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Editorial</div>
                            <div class="style-description">ColorÃ© et expressif</div>
                        </div>

                        <div class="style-card" data-style="LUX" data-category="Premium">
                            <button class="style-preview-btn" onclick="showExample('LUX', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-lux">
                                <div class="preview-lux-card"></div>
                                <div class="preview-lux-accent"></div>
                            </div>
                            <div class="style-category">Premium</div>
                            <div class="style-name">Luxury Dark</div>
                            <div class="style-description">Ã‰lÃ©gance sombre</div>
                        </div>

                        <div class="style-card" data-style="BRT" data-category="Audacieux">
                            <button class="style-preview-btn" onclick="showExample('BRT', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-brt">
                                <div class="preview-brt-box"></div>
                                <div class="preview-brt-line"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Brutal Modern</div>
                            <div class="style-description">Industriel audacieux</div>
                        </div>

                        <div class="style-card" data-style="RTF" data-category="Audacieux">
                            <button class="style-preview-btn" onclick="showExample('RTF', event)">
                                <i class="fas fa-eye"></i> Exemple
                            </button>
                            <div class="style-preview style-preview-rtf">
                                <div class="preview-rtf-grid"></div>
                                <div class="preview-rtf-glow"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Retro Future</div>
                            <div class="style-description">NÃ©ons et gÃ©omÃ©trie</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Colors -->
                <div class="step-content" data-step="2">
                    <h2 class="step-title">DÃ©finissez vos couleurs</h2>
                    <p class="step-description">Choisissez les couleurs principales de votre identitÃ© visuelle</p>

                    <div class="colors-grid">
                        <div class="color-section">
                            <h3 class="color-role-title">Couleur Principale</h3>
                            <div class="color-picker-wrapper">
                                <div class="custom-color-picker" id="picker-primary" data-color-type="primary" style="background-color: #438DD7;"></div>
                                <input type="color" id="color-primary" class="color-input" value="#438DD7">
                                <input type="text" id="color-primary-text" class="color-text-input" value="#438DD7" placeholder="#438DD7">
                            </div>
                            <div class="color-feedback" id="feedback-primary"></div>
                        </div>

                        <div class="color-section">
                            <h3 class="color-role-title">Couleur d'ArriÃ¨re-plan</h3>
                            <div class="color-picker-wrapper">
                                <div class="custom-color-picker" id="picker-background" data-color-type="background" style="background-color: #FFFFFF;"></div>
                                <input type="color" id="color-background" class="color-input" value="#FFFFFF">
                                <input type="text" id="color-background-text" class="color-text-input" value="#FFFFFF" placeholder="#FFFFFF">
                            </div>
                            <div class="color-feedback" id="feedback-background"></div>
                        </div>

                        <div class="color-section">
                            <h3 class="color-role-title">Couleur d'Accent</h3>
                            <div class="color-picker-wrapper">
                                <div class="custom-color-picker" id="picker-accent" data-color-type="accent" style="background-color: #20375D;"></div>
                                <input type="color" id="color-accent" class="color-input" value="#20375D">
                                <input type="text" id="color-accent-text" class="color-text-input" value="#20375D" placeholder="#20375D">
                            </div>
                            <div class="color-feedback" id="feedback-accent"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Typography -->
                <div class="step-content" data-step="3">
                    <h2 class="step-title">Style typographique</h2>
                    <p class="step-description">SÃ©lectionnez l'ambiance typographique de votre site</p>

                    <div class="typo-grid">
                        <div class="typo-option" data-typo="M1">
                            <div class="typo-sample" style="font-family: 'Inter', sans-serif; font-weight: 600;">Aa</div>
                            <div class="typo-name">Moderne & lisible</div>
                            <div class="typo-desc">SystÃ¨me, neutre, universel</div>
                        </div>

                        <div class="typo-option" data-typo="M2">
                            <div class="typo-sample" style="font-family: 'Aref Ruqaa', serif; font-weight: 700;">Aa</div>
                            <div class="typo-name">Ã‰lÃ©gant & premium</div>
                            <div class="typo-desc">Serif, raffinÃ©, Ã©lÃ©gant</div>
                        </div>

                        <div class="typo-option" data-typo="M3">
                            <div class="typo-sample" style="font-family: 'Kaushan Script', cursive;">Aa</div>
                            <div class="typo-name">Expressif & crÃ©atif</div>
                            <div class="typo-desc">Script, dynamique, crÃ©atif</div>
                        </div>

                        <div class="typo-option" data-typo="M4">
                            <div class="typo-sample" style="font-family: 'Times New Roman', serif;">Aa</div>
                            <div class="typo-name">Neutre & corporate</div>
                            <div class="typo-desc">Classique, sobre, fiable</div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Ambiance -->
                <div class="step-content" data-step="4">
                    <h2 class="step-title">Ambiance & interactions</h2>
                    <p class="step-description">Affinez l'expÃ©rience utilisateur de votre site</p>

                    <!-- Sub-step indicator -->
                    <div class="substep-indicator" id="substep-indicator">
                        <div class="substep-dot active" data-substep="1"></div>
                        <div class="substep-dot" data-substep="2"></div>
                        <div class="substep-dot" data-substep="3"></div>
                        <div class="substep-dot" data-substep="4"></div>
                        <div class="substep-dot" data-substep="5"></div>
                    </div>

                    <!-- Sub-step 1: Animations -->
                    <div class="substep-content active" data-substep="1">
                        <h3 class="substep-title">Animations</h3>
                        <p class="substep-description">Choisissez le niveau d'animations pour votre site</p>

                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-options">
                                    <div class="setting-option" data-setting="anim" data-value="0">Aucune</div>
                                    <div class="setting-option" data-setting="anim" data-value="1">LÃ©gÃ¨res</div>
                                    <div class="setting-option selected" data-setting="anim" data-value="2">PrÃ©sentes</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-step 2: Arrondis -->
                    <div class="substep-content" data-substep="2">
                        <h3 class="substep-title">Arrondis</h3>
                        <p class="substep-description">DÃ©finissez le style des bords de vos Ã©lÃ©ments</p>

                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-options">
                                    <div class="setting-option" data-setting="radius" data-value="1">Nets</div>
                                    <div class="setting-option" data-setting="radius" data-value="2">ModÃ©rÃ©s</div>
                                    <div class="setting-option selected" data-setting="radius" data-value="3">Doux</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-step 3: DensitÃ© -->
                    <div class="substep-content" data-substep="3">
                        <h3 class="substep-title">DensitÃ©</h3>
                        <p class="substep-description">Ajustez l'espacement entre les Ã©lÃ©ments</p>

                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-options">
                                    <div class="setting-option" data-setting="density" data-value="1">Compacte</div>
                                    <div class="setting-option selected" data-setting="density" data-value="2">Ã‰quilibrÃ©e</div>
                                    <div class="setting-option" data-setting="density" data-value="3">AÃ©rÃ©e</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-step 4: Transitions -->
                    <div class="substep-content" data-substep="4">
                        <h3 class="substep-title">Transitions</h3>
                        <p class="substep-description">Choisissez la vitesse des transitions</p>

                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-options">
                                    <div class="setting-option" data-setting="trans" data-value="1">Instant</div>
                                    <div class="setting-option selected" data-setting="trans" data-value="2">Fluide</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sub-step 5: Scroll -->
                    <div class="substep-content" data-substep="5">
                        <h3 class="substep-title">Scroll</h3>
                        <p class="substep-description">DÃ©finissez le comportement du dÃ©filement (non reprÃ©sentÃ© dans l'aperÃ§u)</p>

                        <div class="settings-grid">
                            <div class="setting-item">
                                <div class="setting-options">
                                    <div class="setting-option selected" data-setting="scroll" data-value="1">Standard</div>
                                    <div class="setting-option" data-setting="scroll" data-value="2">AnimÃ© lÃ©ger</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Summary -->
                <div class="step-content" data-step="5">
                    <h2 class="step-title">RÃ©sumÃ© de votre design</h2>
                    <p class="step-description">VÃ©rifiez vos choix avant de valider</p>

                    <div class="summary-section">
                        <h3 class="summary-title">Configuration</h3>
                        <div class="summary-item">
                            <span class="summary-label">Style Visuel</span>
                            <span class="summary-value" id="summary-style">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Couleur Principale</span>
                            <span class="summary-value" id="summary-primary">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">ArriÃ¨re-plan</span>
                            <span class="summary-value" id="summary-background">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Accent</span>
                            <span class="summary-value" id="summary-accent">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Typographie</span>
                            <span class="summary-value" id="summary-typo">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Animations</span>
                            <span class="summary-value" id="summary-anim">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Arrondis</span>
                            <span class="summary-value" id="summary-radius">â€”</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">DensitÃ©</span>
                            <span class="summary-value" id="summary-density">â€”</span>
                        </div>
                    </div>

                    <div class="token-display">
                        <div class="token-label">Votre Code de Design</div>
                        <div class="token-value" id="token-value">DG1|S:GLS|C:438DD7-FFFFFF-20375D|T:M1|A:2|R:3|D:2|TR:2|SC:1</div>
                        <div class="token-actions">
                            <button class="token-btn" onclick="copyToken()">
                                <i class="fas fa-copy"></i> Copier
                            </button>
                            <button class="token-btn" onclick="loadToken()">
                                <i class="fas fa-download"></i> Charger
                            </button>
                        </div>
                    </div>

                    <div style="background: rgba(67, 141, 215, 0.1); padding: 20px; border-radius: 16px; border-left: 4px solid var(--primary-color);">
                        <h4 style="font-weight: 600; margin-bottom: 8px; color: var(--primary-dark);">
                            <i class="fas fa-info-circle"></i> Ã€ propos du code de design
                        </h4>
                        <p style="font-size: 0.95rem; color: var(--text-light); line-height: 1.6;">
                            Ce code contient l'intÃ©gralitÃ© de vos choix design. Conservez-le prÃ©cieusement pour rÃ©utiliser ou modifier votre configuration Ã  tout moment. Aucune donnÃ©e n'est stockÃ©e sur nos serveurs.
                        </p>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="nav-buttons">
                    <button class="btn-nav btn-prev" onclick="previousStep()" style="visibility: hidden;">
                        <i class="fas fa-chevron-left"></i> PrÃ©cÃ©dent
                    </button>
                    <button class="btn-nav btn-next" onclick="nextStep()">
                        Suivant <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

        </div>

        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Style Visuel</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Couleurs</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Typographie</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Ambiance</div>
            </div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">RÃ©sumÃ©</div>
            </div>
        </div>
    </div>

    <!-- Color Picker Modal -->
    <div class="color-picker-modal" id="colorPickerModal">
        <div class="color-picker-content">
            <div class="color-picker-header">
                <h3 class="color-picker-title">Choisir une couleur</h3>
                <button class="color-picker-close" onclick="closeColorPicker()">Ã—</button>
            </div>

            <div class="color-picker-preview" id="pickerPreview">#438DD7</div>

            <div class="color-picker-section">
                <label class="color-picker-label">Couleurs prÃ©dÃ©finies</label>
                <div class="color-presets" id="colorPresets"></div>
            </div>

            <div class="color-picker-section">
                <label class="color-picker-label">Teinte</label>
                <div class="hue-slider-container">
                    <input type="range" class="hue-slider" id="hueSlider" min="0" max="360" value="210">
                </div>
            </div>

            <div class="color-picker-section">
                <label class="color-picker-label">LuminositÃ©</label>
                <div class="lightness-slider-container">
                    <input type="range" class="lightness-slider" id="lightnessSlider" min="0" max="100" value="50">
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let currentStep = 1;
        const totalSteps = 5;
        let currentSubstep = 1;
        const totalSubsteps = 5; // For step 4

        const designState = {
            version: 'DG1',
            style: '',
            colors: {
                primary: '#438DD7',
                background: '#FFFFFF',
                accent: '#20375D'
            },
            typography: 'inter-roboto',
            settings: {
                animations: 2,
                radius: 3,
                density: 2,
                transitions: 2,
                scroll: 1
            }
        };

        // Track manual overrides - true means user has manually changed this setting
        const manualOverrides = {
            radius: false,
            density: false,
            animations: false,
            transitions: false,
            colors: false  // Track if user manually changed colors
        };

        // Default settings for each style (including default colors for dark themes)
        const styleDefaults = {
            'MIN': { radius: 1, density: 1 },
            'GLS': { radius: 2, density: 2, backgroundColor: '#0a0a0a' },
            'SFT': { radius: 3, density: 3 },
            'EDT': { radius: 1, density: 2 },
            'LUX': { radius: 2, density: 2, backgroundColor: '#0a0a0a' },
            'BRT': { radius: 1, density: 2, backgroundColor: '#000000' },
            'RTF': { radius: 2, density: 2, backgroundColor: '#0a0a0a' }
        };

        // Style mappings
        const styleNames = {
            'MIN': 'Minimal Pro',
            'GLS': 'Modern Glass',
            'SFT': 'Soft UI',
            'EDT': 'Editorial',
            'LUX': 'Luxury Dark',
            'BRT': 'Brutal Modern',
            'RTF': 'Retro Future'
        };

        const typoNames = {
            'M1': 'Moderne & lisible',
            'M2': 'Ã‰lÃ©gant & premium',
            'M3': 'Expressif & crÃ©atif',
            'M4': 'Neutre & corporate'
        };

        const settingLabels = {
            animations: ['Aucune', 'LÃ©gÃ¨res', 'PrÃ©sentes'],
            radius: ['Nets', 'ModÃ©rÃ©s', 'Doux'],
            density: ['Compacte', 'Ã‰quilibrÃ©e', 'AÃ©rÃ©e'],
            transitions: ['Instant', 'Fluide'],
            scroll: ['Standard', 'AnimÃ© lÃ©ger']
        };


        // Initialize substeps
        function initSubsteps() {
            const substepDots = document.querySelectorAll('.substep-dot');
            substepDots.forEach(dot => {
                dot.addEventListener('click', () => {
                    const substep = parseInt(dot.dataset.substep);
                    currentSubstep = substep;
                    updateSubstepDisplay();
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            initStyleCards();
            initColorPickers();
            initCustomColorPicker();
            initTypoOptions();
            initSettings();
            initSubsteps();

            // Wait for fonts to load before first preview update
            try {
                await document.fonts.ready;
                console.log('âœ… Fonts loaded successfully');
            } catch (e) {
                console.warn('âš ï¸ Font loading timeout, proceeding anyway');
            }

            // Check if token in URL BEFORE applying styles
            const hasToken = checkURLToken();

            // Only apply default styles if no token was loaded
            if (!hasToken) {
                applyGlobalStyles();
            }

            // Final contrast check after everything is loaded (with longer delay for token scenarios)
            setTimeout(() => {
                console.log('ðŸ”„ Final contrast check on page load...');
                autoAdjustTextContrast();
            }, 300);
        });

        // Check if token in URL
        function checkURLToken() {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            if (token) {
                console.log('ðŸ”‘ Loading token from URL');
                parseToken(token);
                updateUI();
                return true;
            }
            return false;
        }

        // Style Cards
        function initStyleCards() {
            document.querySelectorAll('.style-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.style-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    const selectedStyle = card.dataset.style;
                    designState.style = selectedStyle;

                    // Apply style defaults only for settings that haven't been manually changed
                    if (styleDefaults[selectedStyle]) {
                        if (!manualOverrides.radius) {
                            designState.settings.radius = styleDefaults[selectedStyle].radius;
                            updateSettingUI('radius', styleDefaults[selectedStyle].radius);
                        }
                        if (!manualOverrides.density) {
                            designState.settings.density = styleDefaults[selectedStyle].density;
                            updateSettingUI('density', styleDefaults[selectedStyle].density);
                        }
                        // Always reset colors to theme defaults when changing theme
                        if (styleDefaults[selectedStyle].backgroundColor) {
                            designState.colors.background = styleDefaults[selectedStyle].backgroundColor;
                            console.log('âœ¨ Applied default background color for ' + selectedStyle + ':', styleDefaults[selectedStyle].backgroundColor);
                        } else {
                            // Reset to default white for themes without specific background
                            designState.colors.background = '#FFFFFF';
                            console.log('âœ¨ Reset background to white for ' + selectedStyle);
                        }
                        // Reset the manual override flag since we're changing themes
                        manualOverrides.colors = false;
                    }

                    applyGlobalStyles();
                    setTimeout(() => autoAdjustTextContrast(), 100);
                    enableNextButton();
                });
            });
        }

        // Color Pickers
        function initColorPickers() {
            const colorTypes = ['primary', 'background', 'accent'];

            colorTypes.forEach(type => {
                const colorInput = document.getElementById(`color-${type}`);
                const textInput = document.getElementById(`color-${type}-text`);
                const feedback = document.getElementById(`feedback-${type}`);

                colorInput.addEventListener('input', (e) => {
                    const color = e.target.value;
                    textInput.value = color;
                    designState.colors[type] = color;
                    validateColors();
                    applyGlobalStyles();
                    setTimeout(() => autoAdjustTextContrast(), 100);
                });

                textInput.addEventListener('input', (e) => {
                    let color = e.target.value;
                    if (color.startsWith('#') && /^#[0-9A-F]{6}$/i.test(color)) {
                        colorInput.value = color;
                        designState.colors[type] = color;
                        validateColors();
                        applyGlobalStyles();
                        setTimeout(() => autoAdjustTextContrast(), 100);
                    }
                });
            });
        }

        // Color utility functions - Global scope for accessibility
        const getLuminance = (hex) => {
            const rgb = parseInt(hex.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;
            const [rs, gs, bs] = [r, g, b].map(c => {
                c = c / 255;
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });
            return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
        };

        const getContrast = (color1, color2) => {
            const l1 = getLuminance(color1);
            const l2 = getLuminance(color2);
            const lighter = Math.max(l1, l2);
            const darker = Math.min(l1, l2);
            return (lighter + 0.05) / (darker + 0.05);
        };

        const getSuggestion = (baseColor, targetColor, targetContrast) => {
            const targetLum = getLuminance(targetColor);

            // Extract RGB
            let rgb = parseInt(baseColor.slice(1), 16);
            let r = (rgb >> 16) & 0xff;
            let g = (rgb >> 8) & 0xff;
            let b = (rgb >> 0) & 0xff;

            // Determine if we need to darken or lighten based on target background
            const needsDarker = targetLum > 0.5; // If background is light, we need dark text

            // Iteratively adjust until we reach target contrast
            let attempts = 0;
            const maxAttempts = 50;
            const step = needsDarker ? -5 : 5;

            while (attempts < maxAttempts) {
                // Calculate current contrast
                const testColor = '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
                const currentContrast = getContrast(testColor, targetColor);

                // Check if we've reached our target
                if (currentContrast >= targetContrast) {
                    return testColor;
                }

                // Adjust all channels proportionally
                r = Math.max(0, Math.min(255, r + step));
                g = Math.max(0, Math.min(255, g + step));
                b = Math.max(0, Math.min(255, b + step));

                // Safety check - if we've hit 0 or 255 on all channels, we can't improve further
                if (needsDarker && r === 0 && g === 0 && b === 0) break;
                if (!needsDarker && r === 255 && g === 255 && b === 255) break;

                attempts++;
            }

            // Return best effort
            return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        };

        // Validate Colors with enhanced feedback
        function validateColors() {
            const { primary, background, accent } = designState.colors;

            const primaryBgContrast = getContrast(primary, background);
            const accentBgContrast = getContrast(accent, background);

            // Enhanced feedback for primary
            const feedbackPrimary = document.getElementById('feedback-primary');
            if (primaryBgContrast >= 4.5) {
                feedbackPrimary.className = 'color-feedback valid';
                feedbackPrimary.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <strong>Parfait !</strong> Votre couleur principale est parfaitement lisible sur le fond.
                    Le contraste de ${primaryBgContrast.toFixed(1)}:1 garantit une excellente accessibilitÃ©.
                `;
            } else if (primaryBgContrast >= 3) {
                feedbackPrimary.className = 'color-feedback warning';
                const suggestionPrimary = getSuggestion(primary, background, 4.5);
                const suggestionBg = getSuggestion(background, primary, 4.5);

                // Only show background button if the suggestion is different from current background
                const showBgButton = suggestionBg.toLowerCase() !== background.toLowerCase();

                feedbackPrimary.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Acceptable mais peut mieux faire</strong><br>
                    Le contraste actuel de ${primaryBgContrast.toFixed(1)}:1 est correct pour les gros textes,
                    mais peut poser des problÃ¨mes de lisibilitÃ© sur les petits textes.<br>
                    <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('primary', '${suggestionPrimary}')">
                            <i class="fas fa-palette"></i> Modifier couleur principale
                        </button>
                        ${showBgButton ? `
                        <button class="modal-btn modal-btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('background', '${suggestionBg}')">
                            <i class="fas fa-fill"></i> Modifier fond
                        </button>
                        ` : ''}
                    </div>
                `;
            } else {
                feedbackPrimary.className = 'color-feedback error';
                const suggestionPrimary = getSuggestion(primary, background, 4.5);
                const suggestionBg = getSuggestion(background, primary, 4.5);

                // Only show background button if the suggestion is different from current background
                const showBgButton = suggestionBg.toLowerCase() !== background.toLowerCase();

                feedbackPrimary.innerHTML = `
                    <i class="fas fa-times-circle"></i>
                    <strong>Attention : contraste trop faible</strong><br>
                    Avec un ratio de seulement ${primaryBgContrast.toFixed(1)}:1, votre texte sera difficile Ã  lire.
                    Les visiteurs malvoyants ne pourront pas utiliser votre site correctement.<br>
                    <strong>Choisissez une solution :</strong><br>
                    <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('primary', '${suggestionPrimary}')">
                            <i class="fas fa-palette"></i> Corriger couleur (${suggestionPrimary})
                        </button>
                        ${showBgButton ? `
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('background', '${suggestionBg}')">
                            <i class="fas fa-fill"></i> Corriger fond (${suggestionBg})
                        </button>
                        ` : ''}
                    </div>
                `;
            }

            // Enhanced feedback for accent
            const feedbackAccent = document.getElementById('feedback-accent');
            if (accentBgContrast >= 4.5) {
                feedbackAccent.className = 'color-feedback valid';
                feedbackAccent.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <strong>Excellent !</strong> Votre couleur d'accent a un contraste parfait (${accentBgContrast.toFixed(1)}:1).
                `;
            } else if (accentBgContrast >= 3) {
                feedbackAccent.className = 'color-feedback warning';
                const suggestionAccent = getSuggestion(accent, background, 4.5);
                const suggestionBg = getSuggestion(background, accent, 4.5);

                // Only show background button if the suggestion is different from current background
                const showBgButton = suggestionBg.toLowerCase() !== background.toLowerCase();

                feedbackAccent.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Contraste moyen</strong> (${accentBgContrast.toFixed(1)}:1) -
                    Convenable pour les Ã©lÃ©ments dÃ©coratifs, mais Ã©vitez de l'utiliser pour du texte important.<br>
                    <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('accent', '${suggestionAccent}')">
                            <i class="fas fa-palette"></i> Modifier couleur accent
                        </button>
                        ${showBgButton ? `
                        <button class="modal-btn modal-btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('background', '${suggestionBg}')">
                            <i class="fas fa-fill"></i> Modifier fond
                        </button>
                        ` : ''}
                    </div>
                `;
            } else {
                feedbackAccent.className = 'color-feedback error';
                const suggestionAccent = getSuggestion(accent, background, 4.5);
                const suggestionBg = getSuggestion(background, accent, 4.5);

                // Only show background button if the suggestion is different from current background
                const showBgButton = suggestionBg.toLowerCase() !== background.toLowerCase();

                feedbackAccent.innerHTML = `
                    <i class="fas fa-times-circle"></i>
                    <strong>Contraste insuffisant</strong> (${accentBgContrast.toFixed(1)}:1)<br>
                    Cette couleur sera invisible sur votre fond. ${getLuminance(background) > 0.5 ? 'Choisissez une teinte plus foncÃ©e' : 'Choisissez une teinte plus claire'}.<br>
                    <div style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;">
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('accent', '${suggestionAccent}')">
                            <i class="fas fa-palette"></i> Corriger accent (${suggestionAccent})
                        </button>
                        ${showBgButton ? `
                        <button class="modal-btn modal-btn-primary" style="padding: 8px 16px; font-size: 0.9rem;"
                                onclick="applySuggestion('background', '${suggestionBg}')">
                            <i class="fas fa-fill"></i> Corriger fond (${suggestionBg})
                        </button>
                        ` : ''}
                    </div>
                `;
            }
        }

        // Apply color suggestion
        function applySuggestion(colorType, suggestedColor) {
            designState.colors[colorType] = suggestedColor;
            manualOverrides.colors = true;  // Mark colors as manually changed
            document.getElementById(`color-${colorType}`).value = suggestedColor;
            document.getElementById(`color-${colorType}-text`).value = suggestedColor;
            document.getElementById(`picker-${colorType}`).style.backgroundColor = suggestedColor;
            validateColors();
            applyGlobalStyles();
        }

        // Custom Color Picker
        let currentColorType = 'primary';
        const colorPresets = [
            '#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#9400D3', '#FF1493',
            '#FF6B6B', '#FFB347', '#FFFF99', '#77DD77', '#779ECB', '#B19CD9', '#FFB6C1', '#FFC0CB',
            '#8B0000', '#FF8C00', '#FFD700', '#008000', '#000080', '#800080', '#DC143C', '#FF69B4',
            '#F08080', '#FFDAB9', '#FFFFE0', '#90EE90', '#ADD8E6', '#E6E6FA', '#FFE4E1', '#FFF0F5',
            '#000000', '#404040', '#808080', '#C0C0C0', '#FFFFFF', '#F5F5DC', '#FAEBD7', '#F0E68C'
        ];

        function openColorPicker(colorType) {
            currentColorType = colorType;
            const currentColor = designState.colors[colorType];

            // Update modal
            const modal = document.getElementById('colorPickerModal');
            modal.classList.add('active');

            // Update preview
            updatePickerPreview(currentColor);

            // Initialize presets
            const presetsContainer = document.getElementById('colorPresets');
            presetsContainer.innerHTML = '';
            colorPresets.forEach(color => {
                const preset = document.createElement('div');
                preset.className = 'color-preset';
                preset.style.backgroundColor = color;
                if (color.toUpperCase() === currentColor.toUpperCase()) {
                    preset.classList.add('selected');
                }
                preset.onclick = () => selectPresetColor(color);
                presetsContainer.appendChild(preset);
            });

            // Set slider values from current color
            const hsl = hexToHSL(currentColor);
            document.getElementById('hueSlider').value = hsl.h;
            document.getElementById('lightnessSlider').value = hsl.l;
            updateLightnessSliderGradient(hsl.h);
        }

        function closeColorPicker() {
            document.getElementById('colorPickerModal').classList.remove('active');
        }

        function selectPresetColor(color) {
            applyPickerColor(color);
            document.querySelectorAll('.color-preset').forEach(p => p.classList.remove('selected'));
            event.target.classList.add('selected');
        }

        function applyPickerColor(color) {
            designState.colors[currentColorType] = color;
            manualOverrides.colors = true;  // Mark colors as manually changed
            document.getElementById(`color-${currentColorType}`).value = color;
            document.getElementById(`color-${currentColorType}-text`).value = color;
            document.getElementById(`picker-${currentColorType}`).style.backgroundColor = color;
            updatePickerPreview(color);
            validateColors();
            applyGlobalStyles();
            setTimeout(() => autoAdjustTextContrast(), 100);
        }

        function updatePickerPreview(color) {
            const preview = document.getElementById('pickerPreview');
            preview.style.backgroundColor = color;
            preview.textContent = color.toUpperCase();

            // Calculate if we need dark or light text
            const rgb = parseInt(color.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            preview.style.color = luminance > 0.5 ? '#000' : '#fff';
        }

        function hexToHSL(hex) {
            let r = parseInt(hex.slice(1, 3), 16) / 255;
            let g = parseInt(hex.slice(3, 5), 16) / 255;
            let b = parseInt(hex.slice(5, 7), 16) / 255;

            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                let d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
        }

        function hslToHex(h, s, l) {
            l /= 100;
            const a = s * Math.min(l, 1 - l) / 100;
            const f = n => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return `#${f(0)}${f(8)}${f(4)}`;
        }

        function updateLightnessSliderGradient(hue) {
            const slider = document.getElementById('lightnessSlider');
            const gradient = `linear-gradient(to right,
                ${hslToHex(hue, 70, 0)},
                ${hslToHex(hue, 70, 50)},
                ${hslToHex(hue, 70, 100)})`;
            slider.style.background = gradient;
        }

        function initCustomColorPicker() {
            // Add click events to custom pickers
            document.querySelectorAll('.custom-color-picker').forEach(picker => {
                picker.addEventListener('click', () => {
                    openColorPicker(picker.dataset.colorType);
                });
            });

            // Hue slider
            const hueSlider = document.getElementById('hueSlider');
            hueSlider.addEventListener('input', (e) => {
                const hue = parseInt(e.target.value);
                const lightness = parseInt(document.getElementById('lightnessSlider').value);
                const color = hslToHex(hue, 70, lightness);
                applyPickerColor(color);
                updateLightnessSliderGradient(hue);
            });

            // Lightness slider
            const lightnessSlider = document.getElementById('lightnessSlider');
            lightnessSlider.addEventListener('input', (e) => {
                const hue = parseInt(document.getElementById('hueSlider').value);
                const lightness = parseInt(e.target.value);
                const color = hslToHex(hue, 70, lightness);
                applyPickerColor(color);
            });

            // Close on outside click
            document.getElementById('colorPickerModal').addEventListener('click', (e) => {
                if (e.target.id === 'colorPickerModal') {
                    closeColorPicker();
                }
            });
        }

        // Typography Options
        function initTypoOptions() {
            document.querySelectorAll('.typo-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.typo-option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    designState.typography = option.dataset.typo;
                    applyGlobalStyles();
                    setTimeout(() => autoAdjustTextContrast(), 100);
                    enableNextButton();
                });
            });
        }

        // Helper to update setting UI
        function updateSettingUI(setting, value) {
            const dataAttr = setting === 'animations' ? 'anim' :
                           setting === 'transitions' ? 'trans' : setting;
            document.querySelectorAll(`.setting-option[data-setting="${dataAttr}"]`).forEach(o => o.classList.remove('selected'));
            const targetOption = document.querySelector(`.setting-option[data-setting="${dataAttr}"][data-value="${value}"]`);
            if (targetOption) {
                targetOption.classList.add('selected');
            }
        }

        // Settings
        function initSettings() {
            document.querySelectorAll('.setting-option').forEach(option => {
                option.addEventListener('click', () => {
                    const setting = option.dataset.setting;
                    const value = parseInt(option.dataset.value);

                    console.log('ðŸ–±ï¸ Setting clicked:', setting, value);

                    document.querySelectorAll(`.setting-option[data-setting="${setting}"]`).forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');

                    const mappedSetting = setting === 'anim' ? 'animations' :
                                         setting === 'trans' ? 'transitions' : setting;

                    console.log('ðŸ“ Updating designState.settings.' + mappedSetting + ' to', value);
                    designState.settings[mappedSetting] = value;

                    // Mark as manually overridden
                    if (manualOverrides.hasOwnProperty(mappedSetting)) {
                        manualOverrides[mappedSetting] = true;
                        console.log('âœ… Marked ' + mappedSetting + ' as manually overridden');
                    }

                    applyGlobalStyles();
                    setTimeout(() => autoAdjustTextContrast(), 100);
                });
            });
        }

        // Helper function to check if a color is light or dark
        function isLightColor(hexColor) {
            if (!hexColor || hexColor === 'transparent') return true;
            const hex = hexColor.replace('#', '');
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.55; // Slightly higher threshold for better readability
        }

        // Helper function to get contrasting text color
        function getContrastColor(bgColor) {
            return isLightColor(bgColor) ? '#1a1a1a' : '#ffffff';
        }

        // Helper function to get readable text color with better contrast
        function getReadableTextColor(bgColor) {
            // Check if background is transparent or undefined
            if (!bgColor || bgColor === 'transparent' || bgColor.includes('rgba(0, 0, 0, 0)')) {
                return 'rgba(0, 0, 0, 0.85)'; // Default to dark text
            }
            return isLightColor(bgColor) ? 'rgba(0, 0, 0, 0.85)' : 'rgba(255, 255, 255, 0.95)';
        }

        // Helper function to get secondary text color
        function getSecondaryTextColor(bgColor) {
            // Check if background is transparent or undefined
            if (!bgColor || bgColor === 'transparent' || bgColor.includes('rgba(0, 0, 0, 0)')) {
                return 'rgba(0, 0, 0, 0.6)'; // Default to dark text
            }
            return isLightColor(bgColor) ? 'rgba(0, 0, 0, 0.6)' : 'rgba(255, 255, 255, 0.75)';
        }

        // Reset all style-specific properties
        function resetElementStyles(element) {
            element.style.backdropFilter = '';
            element.style.boxShadow = '';
            element.style.transform = '';
            element.style.textShadow = '';
            element.style.filter = '';
            element.style.background = '';
            element.style.position = '';
            element.onmouseenter = null;
            element.onmouseleave = null;
        }

        // Update Preview - Enhanced with ALL design choices
        function applyGlobalStyles() {
            const { primary, background, accent } = designState.colors;
            const { radius, density, animations, transitions } = designState.settings;
            const style = designState.style;
            const typo = designState.typography;

            console.log('ðŸŽ¨ Applying global styles:', { style, colors: designState.colors, typo, radius, density, animations, transitions });

            // Calculate values based on settings
            const borderRadius = radius === 1 ? '4px' : radius === 2 ? '12px' : '20px';
            const cardPadding = density === 1 ? '16px' : density === 2 ? '20px' : '24px';
            const buttonPadding = density === 1 ? '10px 20px' : density === 2 ? '12px 24px' : '14px 28px';
            const gap = density === 1 ? '12px' : density === 2 ? '16px' : '20px';

            // If animations are disabled, add class to body to disable all CSS animations/transitions
            if (animations === 0) {
                document.body.classList.add('no-animations');
            } else {
                document.body.classList.remove('no-animations');
            }

            // If animations are disabled, force transitions to none
            const transition = animations === 0 ? 'none' :
                              (transitions === 1 ? 'none' :
                              (transitions === 2 ? 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)' :
                              'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)'));

            // Get typography fonts
            const fonts = {
                'M1': { heading: 'Inter, -apple-system, sans-serif', body: 'Inter, sans-serif', name: 'Moderne & lisible' },
                'M2': { heading: 'Aref Ruqaa, serif', body: 'Aref Ruqaa, serif', name: 'Ã‰lÃ©gant & premium' },
                'M3': { heading: 'Kaushan Script, cursive', body: 'Kaushan Script, cursive', name: 'Expressif & crÃ©atif' },
                'M4': { heading: 'Times New Roman, serif', body: 'Times New Roman, serif', name: 'Neutre & corporate' },
                // Legacy support
                'inter-roboto': { heading: 'Inter, sans-serif', body: 'Roboto, sans-serif', name: 'Inter + Roboto' },
                'playfair-source': { heading: 'Playfair Display, serif', body: 'Source Sans Pro, sans-serif', name: 'Playfair + Source' },
                'montserrat-open': { heading: 'Montserrat, sans-serif', body: 'Open Sans, sans-serif', name: 'Montserrat + Open' },
                'poppins-nunito': { heading: 'Poppins, sans-serif', body: 'Nunito, sans-serif', name: 'Poppins + Nunito' },
                'raleway-lato': { heading: 'Raleway, sans-serif', body: 'Lato, sans-serif', name: 'Raleway + Lato' }
            };

            const selectedFont = fonts[typo] || fonts['M1'];
            const headingFont = selectedFont.heading;
            const bodyFont = selectedFont.body;

            // Determine if we're in dark mode based on actual background color
            const isDarkBg = !isLightColor(background);

            console.log('ðŸ” DEBUG applyGlobalStyles:', {
                background,
                isDarkBg,
                isLight: isLightColor(background),
                style
            });

            // Apply background color to body and container
            if (style === 'GLS') {
                // For glass style, add a gradient to make transparency more visible
                document.body.style.background = `linear-gradient(135deg, ${background} 0%, ${primary}15 100%)`;
            } else {
                document.body.style.backgroundColor = background;
                document.body.style.background = background;
            }
            document.body.style.transition = transition;

            const container = document.querySelector('.onboarding-container');
            if (container) {
                container.style.transition = transition;
            }

            // Apply styles to .content-main (the main content area)
            const contentMain = document.querySelector('.content-main');
            if (contentMain) {
                // Reset all previous styles
                resetElementStyles(contentMain);

                // Remove RTF-specific elements if they exist (cleanup from previous theme)
                const existingScanline = contentMain.querySelector('.rtf-scanline');
                if (existingScanline) {
                    existingScanline.remove();
                }

                contentMain.style.transition = transition;

                // MIN - Minimal: Clean, simple, maximum white space
                if (style === 'MIN') {
                    contentMain.style.backgroundColor = background;
                    contentMain.style.border = `1px solid rgba(0, 0, 0, 0.06)`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.04)';
                }
                // GLS - Glass: Transparent, blur effect, light borders (like hero-glass-container)
                else if (style === 'GLS') {
                    contentMain.style.backdropFilter = 'blur(20px) saturate(180%)';
                    contentMain.style.backgroundColor = 'rgba(255, 255, 255, 0.08)'; // Very transparent like original
                    contentMain.style.border = `1px solid rgba(255, 255, 255, 0.18)`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = `0 8px 32px rgba(0, 0, 0, 0.1),
                                                    inset 0 1px 1px rgba(255, 255, 255, 0.2)`;
                }
                // SFT - Soft: Material Design inspired, solid colors, elevated cards
                else if (style === 'SFT') {
                    contentMain.style.backgroundColor = background;
                    contentMain.style.border = 'none';
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = `0 8px 16px rgba(0, 0, 0, 0.1),
                                                    0 4px 8px rgba(0, 0, 0, 0.06)`;
                }
                // EDT - Editorial: Magazine-like, clean lines, serif-friendly
                else if (style === 'EDT') {
                    contentMain.style.backgroundColor = background;
                    contentMain.style.border = `3px solid ${primary}`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = 'none';
                    contentMain.style.borderTop = `8px solid ${primary}`;
                }
                // LUX - Luxury: Dark, gold accents, premium feel
                else if (style === 'LUX') {
                    const luxBg = manualOverrides.colors ? background : (styleDefaults['LUX'].backgroundColor || background);
                    contentMain.style.backgroundColor = luxBg;
                    contentMain.style.border = `2px solid ${accent}`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = `0 0 80px ${accent}15,
                                                    0 20px 60px rgba(0, 0, 0, 0.6),
                                                    inset 0 1px 0 ${accent}30`;
                }
                // BRT - Brutal: Hard edges, bold borders, no shadows
                else if (style === 'BRT') {
                    const brtBg = manualOverrides.colors ? background : (styleDefaults['BRT'].backgroundColor || background);
                    contentMain.style.backgroundColor = brtBg;
                    contentMain.style.border = `5px solid ${accent}`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = `12px 12px 0 ${accent}`;
                    contentMain.style.transform = 'rotate(-0.5deg)'; // Slight tilt
                }
                // RTF - Retro Future: Neon, glow, cyber aesthetic (inspired by example)
                else if (style === 'RTF') {
                    const rtfBg = manualOverrides.colors ? background : (styleDefaults['RTF'].backgroundColor || background);
                    contentMain.style.background = `linear-gradient(180deg, ${rtfBg} 0%, ${rtfBg}dd 50%, ${rtfBg} 100%)`;
                    contentMain.style.border = `3px solid ${primary}`;
                    contentMain.style.borderRadius = borderRadius;
                    contentMain.style.boxShadow = `0 0 40px ${primary}80,
                                                    0 0 80px ${primary}40,
                                                    inset 0 0 60px ${primary}08`;
                    contentMain.style.position = 'relative';

                    // Add scanline overlay if not already present
                    if (!contentMain.querySelector('.rtf-scanline')) {
                        const scanline = document.createElement('div');
                        scanline.className = 'rtf-scanline';
                        scanline.style.cssText = `
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: repeating-linear-gradient(0deg, transparent, transparent 2px, ${primary}06 2px, ${primary}06 4px);
                            pointer-events: none;
                            z-index: 1;
                        `;
                        contentMain.appendChild(scanline);
                    }
                }
            }

            // Apply typography to all headings (step-title, substep-title)
            document.querySelectorAll('.step-title, .substep-title, h1, h2, h3').forEach(heading => {
                // Skip if it's in the header or footer
                if (!heading.closest('.onboarding-header') && !heading.closest('.step-indicator')) {
                    heading.style.fontFamily = headingFont;
                    heading.style.transition = 'color 0.3s ease';
                }
            });

            // Apply typography to all body text (step-description, substep-description, p)
            document.querySelectorAll('.step-description, .substep-description, p, .style-name, .typo-name, .typo-description, .setting-label').forEach(text => {
                // Skip if it's in the header or footer
                if (!text.closest('.onboarding-header') && !text.closest('.step-indicator')) {
                    text.style.fontFamily = bodyFont;
                    text.style.transition = 'color 0.3s ease';
                }
            });

            // Apply styles to all cards (style-card, typo-option)
            document.querySelectorAll('.style-card, .typo-option').forEach(card => {
                // Reset previous styles
                resetElementStyles(card);
                card.style.transition = transition;
                card.style.cursor = animations === 0 ? 'default' : 'pointer';

                // Determine card background and text color
                let cardBgColor;

                // MIN - Minimal: Ultra clean
                if (style === 'MIN') {
                    cardBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.05)' : '#ffffff';
                    card.style.backgroundColor = cardBgColor;
                    card.style.border = `1px solid ${isDarkBg ? primary + '30' : 'rgba(0, 0, 0, 0.08)'}`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.05)';
                }
                // GLS - Glass: Frosted glass effect with high transparency
                else if (style === 'GLS') {
                    cardBgColor = 'rgba(255, 255, 255, 0.1)'; // Original low opacity for glass effect
                    card.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
                    card.style.backdropFilter = 'blur(15px) saturate(180%)';
                    card.style.border = `1px solid rgba(255, 255, 255, 0.2)`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = `0 8px 32px rgba(0, 0, 0, 0.08),
                                            inset 0 1px 1px rgba(255, 255, 255, 0.3)`;
                }
                // SFT - Soft: Material Design elevated cards, solid
                else if (style === 'SFT') {
                    cardBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.08)' : '#ffffff';
                    card.style.backgroundColor = cardBgColor;
                    card.style.border = 'none';
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = `0 4px 8px rgba(0, 0, 0, 0.12),
                                            0 2px 4px rgba(0, 0, 0, 0.08)`;
                }
                // EDT - Editorial: Clean borders
                else if (style === 'EDT') {
                    cardBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.05)' : '#ffffff';
                    card.style.backgroundColor = cardBgColor;
                    card.style.border = `2px solid ${primary}40`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = 'none';
                }
                // LUX - Luxury: Dark premium
                else if (style === 'LUX') {
                    const luxCardBg = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#141414';
                    cardBgColor = luxCardBg;
                    card.style.backgroundColor = manualOverrides.colors ? (isDarkBg ? `${background}E6` : '#ffffff') : 'rgba(20, 20, 20, 0.9)';
                    card.style.border = `1px solid ${accent}60`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = `0 4px 20px rgba(0, 0, 0, 0.5), 0 0 20px ${accent}10`;
                }
                // BRT - Brutal: Hard edges, bold
                else if (style === 'BRT') {
                    const brtCardBg = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#000000';
                    cardBgColor = brtCardBg;
                    card.style.backgroundColor = brtCardBg;
                    card.style.border = `3px solid ${primary}`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = `4px 4px 0 ${primary}60`;
                }
                // RTF - Retro Future: Neon glow
                else if (style === 'RTF') {
                    const rtfCardBg = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#0a0a0a';
                    cardBgColor = rtfCardBg;
                    card.style.backgroundColor = manualOverrides.colors ? (isDarkBg ? `${background}E6` : '#ffffff') : 'rgba(10, 10, 10, 0.9)';
                    card.style.border = `1px solid ${primary}`;
                    card.style.borderRadius = borderRadius;
                    card.style.boxShadow = `0 0 20px ${primary}40, 0 4px 12px rgba(0, 0, 0, 0.4)`;
                }

                // Set text color based on card background
                const cardTextColor = getReadableTextColor(cardBgColor);
                card.style.color = cardTextColor;

                // Apply text color to all child elements in the card
                card.querySelectorAll('.style-name, .typo-name, .typo-description').forEach(textEl => {
                    textEl.style.color = cardTextColor;
                });

                // Apply padding based on density setting
                card.style.padding = cardPadding;

                // Apply animations based on level: 0 = none, 1 = subtle, 2 = full
                if (animations === 0) {
                    // No animations - ensure no hover effects
                    card.onmouseenter = null;
                    card.onmouseleave = null;
                } else {
                    // Animation intensity multiplier
                    const animIntensity = animations === 1 ? 0.5 : 1;

                    card.onmouseenter = () => {
                        if (style === 'MIN') {
                            card.style.transform = `translateY(${-2 * animIntensity}px)`;
                            card.style.boxShadow = `0 ${4 * animIntensity}px ${12 * animIntensity}px ${primary}15`;
                        } else if (style === 'GLS') {
                            card.style.transform = `translateY(${-2 * animIntensity}px)`;
                            card.style.boxShadow = `0 ${8 * animIntensity}px ${24 * animIntensity}px ${primary}20, inset 0 1px 0 rgba(255, 255, 255, 0.4)`;
                        } else if (style === 'SFT') {
                            card.style.transform = `translateY(${-3 * animIntensity}px)`;
                            card.style.boxShadow = `0 ${12 * animIntensity}px ${32 * animIntensity}px ${primary}15`;
                        } else if (style === 'EDT') {
                            card.style.borderColor = primary;
                            card.style.boxShadow = animations === 2 ? `0 0 0 2px ${primary}30` : 'none';
                        } else if (style === 'LUX') {
                            card.style.boxShadow = `0 ${8 * animIntensity}px ${32 * animIntensity}px rgba(0, 0, 0, 0.6), 0 0 ${30 * animIntensity}px ${accent}30`;
                        } else if (style === 'BRT') {
                            card.style.transform = `translate(${-2 * animIntensity}px, ${-2 * animIntensity}px)`;
                            card.style.boxShadow = `${6 * animIntensity}px ${6 * animIntensity}px 0 ${primary}`;
                        } else if (style === 'RTF') {
                            card.style.boxShadow = `0 0 ${30 * animIntensity}px ${primary}60, 0 0 ${60 * animIntensity}px ${primary}30`;
                        }
                    };
                    card.onmouseleave = () => {
                        card.style.transform = '';
                        // Restore original shadow based on style
                        if (style === 'MIN') {
                            card.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.05)';
                        } else if (style === 'GLS') {
                            card.style.boxShadow = `0 4px 16px ${primary}10, inset 0 1px 0 rgba(255, 255, 255, 0.3)`;
                        } else if (style === 'SFT') {
                            card.style.boxShadow = `0 8px 24px ${primary}08, 0 2px 6px rgba(0, 0, 0, 0.04)`;
                        } else if (style === 'EDT') {
                            card.style.borderColor = `${primary}40`;
                            card.style.boxShadow = 'none';
                        } else if (style === 'LUX') {
                            card.style.boxShadow = `0 4px 20px rgba(0, 0, 0, 0.5), 0 0 20px ${accent}10`;
                        } else if (style === 'BRT') {
                            card.style.boxShadow = `4px 4px 0 ${primary}60`;
                        } else if (style === 'RTF') {
                            card.style.boxShadow = `0 0 20px ${primary}40, 0 4px 12px rgba(0, 0, 0, 0.4)`;
                        }
                    };
                }
            });

            // Apply styles to setting options separately
            document.querySelectorAll('.setting-option').forEach(option => {
                resetElementStyles(option);
                option.style.padding = buttonPadding;
                option.style.transition = transition;
                option.style.cursor = animations === 0 ? 'default' : 'pointer';

                const isSelected = option.classList.contains('selected');
                let optionBgColor;

                if (!isSelected) {

                    if (style === 'MIN') {
                        optionBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.05)' : '#ffffff';
                        option.style.backgroundColor = optionBgColor;
                        option.style.border = `1px solid ${isDarkBg ? primary + '30' : 'rgba(0, 0, 0, 0.08)'}`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = '0 1px 2px rgba(0, 0, 0, 0.04)';
                    } else if (style === 'GLS') {
                        optionBgColor = 'rgba(255, 255, 255, 0.08)'; // Original low opacity
                        option.style.backgroundColor = 'rgba(255, 255, 255, 0.08)';
                        option.style.backdropFilter = 'blur(12px) saturate(180%)';
                        option.style.border = `1px solid rgba(255, 255, 255, 0.15)`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = `0 4px 16px rgba(0, 0, 0, 0.05),
                                                  inset 0 1px 1px rgba(255, 255, 255, 0.2)`;
                    } else if (style === 'SFT') {
                        optionBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.06)' : '#ffffff';
                        option.style.backgroundColor = optionBgColor;
                        option.style.border = 'none';
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = `0 2px 4px rgba(0, 0, 0, 0.1),
                                                  0 1px 2px rgba(0, 0, 0, 0.06)`;
                    } else if (style === 'EDT') {
                        optionBgColor = isDarkBg ? 'rgba(255, 255, 255, 0.05)' : '#ffffff';
                        option.style.backgroundColor = optionBgColor;
                        option.style.border = `2px solid ${primary}30`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = 'none';
                    } else if (style === 'LUX') {
                        optionBgColor = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#141414';
                        option.style.backgroundColor = manualOverrides.colors ? (isDarkBg ? `${background}CC` : '#ffffff') : 'rgba(20, 20, 20, 0.8)';
                        option.style.border = `1px solid ${accent}40`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = `0 2px 8px rgba(0, 0, 0, 0.4)`;
                    } else if (style === 'BRT') {
                        optionBgColor = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#000000';
                        option.style.backgroundColor = optionBgColor;
                        option.style.border = `2px solid ${primary}`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = `3px 3px 0 ${primary}40`;
                    } else if (style === 'RTF') {
                        optionBgColor = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#0a0a0a';
                        option.style.backgroundColor = manualOverrides.colors ? (isDarkBg ? `${background}CC` : '#ffffff') : 'rgba(10, 10, 10, 0.8)';
                        option.style.border = `1px solid ${primary}60`;
                        option.style.borderRadius = borderRadius;
                        option.style.boxShadow = `0 0 10px ${primary}20`;
                    }

                    // Set text color based on option background
                    option.style.color = getReadableTextColor(optionBgColor);

                    // Hover effects for non-selected options - with animation level support
                    if (animations === 0) {
                        option.onmouseenter = null;
                        option.onmouseleave = null;
                    } else {
                        const animIntensity = animations === 1 ? 0.5 : 1;
                        option.onmouseenter = () => {
                            if (style === 'MIN') {
                                option.style.borderColor = primary;
                                option.style.boxShadow = `0 ${2 * animIntensity}px ${8 * animIntensity}px ${primary}15`;
                            } else if (style === 'GLS') {
                                option.style.borderColor = primary;
                                option.style.boxShadow = `0 ${4 * animIntensity}px ${12 * animIntensity}px ${primary}20`;
                            } else if (style === 'SFT') {
                                option.style.borderColor = primary;
                                option.style.transform = `translateY(${-1 * animIntensity}px)`;
                                option.style.boxShadow = `0 ${6 * animIntensity}px ${16 * animIntensity}px ${primary}15`;
                            } else if (style === 'EDT') {
                                option.style.borderColor = primary;
                                if (animations === 2) option.style.backgroundColor = `${primary}05`;
                            } else if (style === 'LUX') {
                                option.style.borderColor = accent;
                                option.style.boxShadow = `0 ${4 * animIntensity}px ${16 * animIntensity}px ${accent}30`;
                            } else if (style === 'BRT') {
                                option.style.transform = `translate(${-1 * animIntensity}px, ${-1 * animIntensity}px)`;
                                option.style.boxShadow = `${4 * animIntensity}px ${4 * animIntensity}px 0 ${primary}`;
                            } else if (style === 'RTF') {
                                option.style.boxShadow = `0 0 ${20 * animIntensity}px ${primary}50`;
                            }
                        };
                        option.onmouseleave = () => {
                            option.style.transform = '';
                            // Restore original styles
                            if (style === 'MIN') {
                                option.style.borderColor = isDarkBg ? `${primary}30` : 'rgba(0, 0, 0, 0.08)';
                                option.style.boxShadow = '0 1px 2px rgba(0, 0, 0, 0.04)';
                            } else if (style === 'GLS') {
                                option.style.borderColor = `${primary}30`;
                                option.style.boxShadow = `0 2px 6px ${primary}08`;
                            } else if (style === 'SFT') {
                                option.style.borderColor = `${primary}20`;
                                option.style.boxShadow = `0 4px 12px ${primary}06`;
                            } else if (style === 'EDT') {
                                option.style.borderColor = `${primary}30`;
                                option.style.backgroundColor = optionBgColor;
                            } else if (style === 'LUX') {
                                option.style.borderColor = `${accent}40`;
                                option.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.4)';
                            } else if (style === 'BRT') {
                                option.style.boxShadow = `3px 3px 0 ${primary}40`;
                            } else if (style === 'RTF') {
                                option.style.boxShadow = `0 0 10px ${primary}20`;
                            }
                        };
                    }
                }
            });

            // Apply primary color to selected state
            document.querySelectorAll('.style-card.selected, .typo-option.selected').forEach(selected => {
                if (style === 'MIN') {
                    selected.style.borderColor = primary;
                    selected.style.backgroundColor = `${primary}08`;
                    selected.style.boxShadow = `0 0 0 2px ${primary}40, 0 2px 8px ${primary}15`;
                } else if (style === 'GLS') {
                    selected.style.borderColor = primary;
                    selected.style.backgroundColor = `${primary}20`;
                    selected.style.boxShadow = `0 0 0 3px ${primary}30, 0 8px 24px ${primary}20, inset 0 1px 0 rgba(255, 255, 255, 0.4)`;
                } else if (style === 'SFT') {
                    selected.style.borderColor = primary;
                    selected.style.backgroundColor = `${primary}12`;
                    selected.style.boxShadow = `0 0 0 4px ${primary}20, 0 12px 32px ${primary}20`;
                } else if (style === 'EDT') {
                    selected.style.borderColor = primary;
                    selected.style.backgroundColor = `${primary}10`;
                    selected.style.boxShadow = `inset 0 0 0 2px ${primary}`;
                } else if (style === 'LUX') {
                    selected.style.borderColor = accent;
                    selected.style.backgroundColor = `${accent}15`;
                    selected.style.boxShadow = `0 0 40px ${accent}40, 0 8px 32px rgba(0, 0, 0, 0.6)`;
                } else if (style === 'BRT') {
                    selected.style.borderColor = accent;
                    selected.style.backgroundColor = manualOverrides.colors ? (isDarkBg ? background : '#ffffff') : '#000';
                    selected.style.boxShadow = `8px 8px 0 ${accent}`;
                } else if (style === 'RTF') {
                    selected.style.borderColor = primary;
                    selected.style.backgroundColor = `${primary}15`;
                    selected.style.boxShadow = `0 0 40px ${primary}80, 0 0 80px ${primary}40`;
                }
            });

            // Handle selected setting options separately
            document.querySelectorAll('.setting-option.selected').forEach(selected => {
                selected.style.backgroundColor = primary;
                selected.style.color = getContrastColor(primary);
                selected.style.borderColor = primary;
                selected.style.fontWeight = '600';

                if (style === 'MIN') {
                    selected.style.boxShadow = `0 2px 8px ${primary}30`;
                } else if (style === 'GLS') {
                    selected.style.backdropFilter = 'none';
                    selected.style.boxShadow = `0 4px 16px ${primary}40, inset 0 1px 0 rgba(255, 255, 255, 0.2)`;
                } else if (style === 'SFT') {
                    selected.style.boxShadow = `0 6px 20px ${primary}40`;
                } else if (style === 'EDT') {
                    selected.style.boxShadow = 'none';
                    selected.style.border = `2px solid ${primary}`;
                } else if (style === 'LUX') {
                    selected.style.backgroundColor = accent;
                    selected.style.color = getContrastColor(accent);
                    selected.style.borderColor = accent;
                    selected.style.boxShadow = `0 0 30px ${accent}50, 0 4px 16px rgba(0, 0, 0, 0.4)`;
                } else if (style === 'BRT') {
                    selected.style.backgroundColor = accent;
                    selected.style.color = getContrastColor(accent);
                    selected.style.borderColor = accent;
                    selected.style.boxShadow = `5px 5px 0 ${primary}`;
                } else if (style === 'RTF') {
                    selected.style.boxShadow = `0 0 30px ${primary}70, 0 4px 12px ${primary}40`;
                }
            });

            // Apply styles to buttons
            document.querySelectorAll('.btn, .btn-primary, .btn-secondary, .btn-next, .btn-prev, .btn-validate').forEach(btn => {
                // Skip if it's in the header or footer
                if (!btn.closest('.onboarding-header') && !btn.closest('.step-indicator')) {
                    resetElementStyles(btn);
                    btn.style.padding = buttonPadding;
                    btn.style.transition = transition;
                    btn.style.fontFamily = headingFont;
                    btn.style.fontWeight = '600';
                    btn.style.cursor = animations === 0 ? 'default' : 'pointer';

                    if (btn.classList.contains('btn-primary') || btn.classList.contains('btn-next') || btn.classList.contains('btn-validate')) {
                        btn.style.backgroundColor = primary;
                        btn.style.color = getContrastColor(primary);

                        if (style === 'MIN') {
                            btn.style.border = 'none';
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = `0 2px 8px ${primary}30`;
                        } else if (style === 'GLS') {
                            btn.style.backgroundColor = primary; // Use solid color for buttons in glass mode for better readability
                            btn.style.border = `1px solid ${isDarkBg ? 'rgba(255, 255, 255, 0.3)' : 'rgba(0, 0, 0, 0.1)'}`;
                            btn.style.borderRadius = borderRadius;
                            btn.style.backdropFilter = 'blur(10px) saturate(180%)';
                            btn.style.boxShadow = `0 8px 24px ${primary}50,
                                                   inset 0 1px 1px ${isDarkBg ? 'rgba(255, 255, 255, 0.3)' : 'rgba(255, 255, 255, 0.8)'}`;
                        } else if (style === 'SFT') {
                            btn.style.backgroundColor = primary;
                            btn.style.border = 'none';
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = `0 4px 8px rgba(0, 0, 0, 0.15),
                                                   0 2px 4px rgba(0, 0, 0, 0.1)`;
                        } else if (style === 'EDT') {
                            btn.style.border = `2px solid ${primary}`;
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = 'none';
                        } else if (style === 'LUX') {
                            btn.style.backgroundColor = accent;
                            btn.style.color = getContrastColor(accent);
                            btn.style.border = `1px solid ${accent}`;
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = `0 0 40px ${accent}50, 0 8px 24px rgba(0, 0, 0, 0.4)`;
                        } else if (style === 'BRT') {
                            btn.style.backgroundColor = accent;
                            btn.style.color = getContrastColor(accent);
                            btn.style.border = `4px solid ${primary}`;
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = `6px 6px 0 ${primary}`;
                        } else if (style === 'RTF') {
                            btn.style.border = `2px solid ${primary}`;
                            btn.style.borderRadius = borderRadius;
                            btn.style.boxShadow = `0 0 30px ${primary}70, 0 0 60px ${primary}30`;
                        }

                        // Add hover effect if animations are enabled
                        if (animations === 0) {
                            btn.onmouseenter = null;
                            btn.onmouseleave = null;
                        } else {
                            const animIntensity = animations === 1 ? 0.5 : 1;

                            btn.onmouseenter = () => {
                                if (style === 'MIN') {
                                    btn.style.transform = `translateY(${-2 * animIntensity}px)`;
                                    btn.style.boxShadow = `0 ${4 * animIntensity}px ${16 * animIntensity}px ${primary}40`;
                                } else if (style === 'GLS') {
                                    btn.style.transform = `translateY(${-2 * animIntensity}px)`;
                                    btn.style.boxShadow = `0 ${6 * animIntensity}px ${24 * animIntensity}px ${primary}50, inset 0 1px 0 rgba(255, 255, 255, 0.3)`;
                                } else if (style === 'SFT') {
                                    btn.style.transform = `translateY(${-3 * animIntensity}px)`;
                                    btn.style.boxShadow = `0 ${12 * animIntensity}px ${32 * animIntensity}px ${primary}50`;
                                } else if (style === 'EDT') {
                                    if (animations === 2) {
                                        btn.style.backgroundColor = accent;
                                        btn.style.color = getContrastColor(accent);
                                        btn.style.borderColor = accent;
                                    }
                                } else if (style === 'LUX') {
                                    btn.style.boxShadow = `0 0 ${60 * animIntensity}px ${accent}70, 0 ${12 * animIntensity}px ${32 * animIntensity}px rgba(0, 0, 0, 0.5)`;
                                } else if (style === 'BRT') {
                                    btn.style.transform = `translate(${-2 * animIntensity}px, ${-2 * animIntensity}px)`;
                                    btn.style.boxShadow = `${8 * animIntensity}px ${8 * animIntensity}px 0 ${primary}`;
                                } else if (style === 'RTF') {
                                    btn.style.boxShadow = `0 0 ${50 * animIntensity}px ${primary}90, 0 0 ${100 * animIntensity}px ${primary}50`;
                                }
                            };
                            btn.onmouseleave = () => {
                                btn.style.transform = 'none';
                                // Restore original button styles
                                if (style === 'MIN') {
                                    btn.style.boxShadow = `0 2px 8px ${primary}30`;
                                } else if (style === 'GLS') {
                                    btn.style.boxShadow = `0 4px 16px ${primary}40, inset 0 1px 0 rgba(255, 255, 255, 0.2)`;
                                } else if (style === 'SFT') {
                                    btn.style.boxShadow = `0 8px 24px ${primary}40`;
                                } else if (style === 'EDT') {
                                    btn.style.backgroundColor = primary;
                                    btn.style.color = getContrastColor(primary);
                                    btn.style.borderColor = primary;
                                } else if (style === 'LUX') {
                                    btn.style.boxShadow = `0 0 40px ${accent}50, 0 8px 24px rgba(0, 0, 0, 0.4)`;
                                } else if (style === 'BRT') {
                                    btn.style.boxShadow = `6px 6px 0 ${primary}`;
                                } else if (style === 'RTF') {
                                    btn.style.boxShadow = `0 0 30px ${primary}70, 0 0 60px ${primary}30`;
                                }
                            };
                        }
                    }
                }
            });

            // Apply styles to color sections
            document.querySelectorAll('.color-section').forEach(el => {
                el.style.borderRadius = borderRadius;
                el.style.transition = transition;
                if (isDarkBg && style !== 'GLS') {
                    el.style.backgroundColor = 'rgba(255, 255, 255, 0.05)';
                } else {
                    el.style.backgroundColor = '';
                }
            });

            // Apply styles to custom color pickers
            document.querySelectorAll('.custom-color-picker').forEach(el => {
                el.style.borderRadius = borderRadius;
                el.style.transition = transition;
            });

            // Add subtle frosted overlay to text containers in Glass mode for readability
            if (style === 'GLS') {
                // Determine overlay color based on background
                const textOverlayColor = isLightColor(background) ? 'rgba(255, 255, 255, 0.5)' : 'rgba(0, 0, 0, 0.5)';
                const textColor = isLightColor(background) ? '#000000' : '#ffffff';

                // Add frosted overlay to cards with text
                document.querySelectorAll('.style-card, .typo-option').forEach(el => {
                    el.style.backgroundColor = textOverlayColor;
                });

                // Add frosted overlay to setting options (non-selected)
                document.querySelectorAll('.setting-option:not(.selected)').forEach(el => {
                    el.style.backgroundColor = textOverlayColor;
                });

                // Add frosted overlay to color sections
                document.querySelectorAll('.color-section').forEach(el => {
                    el.style.backgroundColor = textOverlayColor;
                    el.style.padding = cardPadding;
                    el.style.backdropFilter = 'blur(10px) saturate(180%)';
                });

                // Ensure readable text color
                document.querySelectorAll('.style-name, .typo-name, .typo-description, .setting-label').forEach(el => {
                    if (!el.closest('.onboarding-header') && !el.closest('.step-indicator')) {
                        el.style.color = textColor;
                    }
                });
            } else {
                // Reset for non-glass modes
                document.querySelectorAll('.color-section').forEach(el => {
                    el.style.padding = '';
                    el.style.backdropFilter = '';
                });
            }

            // Apply accent color to specific elements
            document.querySelectorAll('.style-category').forEach(el => {
                el.style.color = accent;
                el.style.transition = transition;
            });

            console.log('âœ… Global styles applied successfully');

            // Call the automatic contrast system after styles are applied
            setTimeout(() => {
                autoAdjustTextContrast();
            }, 100);
        }

        // ============================================
        // AUTOMATIC TEXT CONTRAST ADJUSTMENT SYSTEM
        // ============================================
        function autoAdjustTextContrast() {
            console.log('ðŸŽ¨ Starting automatic contrast adjustment...');

            // Calculate the REAL background color that's being displayed
            // This takes into account theme defaults vs user overrides
            const style = designState.style;
            const userBg = designState.colors.background || '#ffffff';
            let bgColor = userBg;

            // For themes with dark defaults, check if user has overridden
            if (!manualOverrides.colors) {
                // User hasn't overridden, so theme defaults may apply
                if (style === 'LUX' && styleDefaults['LUX']?.backgroundColor) {
                    bgColor = styleDefaults['LUX'].backgroundColor;
                } else if (style === 'BRT' && styleDefaults['BRT']?.backgroundColor) {
                    bgColor = styleDefaults['BRT'].backgroundColor;
                } else if (style === 'RTF' && styleDefaults['RTF']?.backgroundColor) {
                    bgColor = styleDefaults['RTF'].backgroundColor;
                } else if (style === 'GLS' && styleDefaults['GLS']?.backgroundColor) {
                    bgColor = styleDefaults['GLS'].backgroundColor;
                }
            }

            console.log('ðŸ“ Background color calculation:', {
                style,
                userBg,
                manualOverrides: manualOverrides.colors,
                finalBgColor: bgColor
            });

            // Calculate the best text color for this background
            const textColor = getBestContrastColor(bgColor);
            const secondaryTextColor = textColor === '#ffffff' ? 'rgba(255, 255, 255, 0.7)' : 'rgba(0, 0, 0, 0.6)';

            console.log('ðŸ“ Calculated text color:', textColor);

            // Set the CSS variables globally - this affects all elements using var(--text-dark) and var(--text-light)
            document.documentElement.style.setProperty('--text-dark', textColor);
            document.documentElement.style.setProperty('--text-light', secondaryTextColor);
            document.documentElement.style.setProperty('--text-secondary', secondaryTextColor);

            // Apply to primary text elements (titles, labels) - EXCLUDING header and steps (always black)
            const primaryTextElements = document.querySelectorAll(
                '.step-title, .substep-title, h1, h2, h3, ' +
                '.style-name, .typo-name, .setting-label, ' +
                '.color-section-title, .color-label'
            );

            // Apply to secondary text elements (descriptions)
            const secondaryTextElements = document.querySelectorAll(
                '.step-description, .substep-description, ' +
                '.style-description, .typo-description, ' +
                '.substep-dot-label'
            );

            let adjustedCount = 0;

            primaryTextElements.forEach(element => {
                // Skip elements in header, step indicator, modals, or hidden elements
                if (element.closest('.onboarding-header') ||
                    element.closest('.step-indicator') ||
                    element.closest('.modal') ||
                    element.closest('.color-picker-modal') ||
                    element.offsetParent === null) {
                    return;
                }

                // Apply the primary text color with !important to override CSS
                element.style.setProperty('color', textColor, 'important');
                adjustedCount++;
            });

            secondaryTextElements.forEach(element => {
                // Skip elements in header, step indicator, modals, or hidden elements
                if (element.closest('.onboarding-header') ||
                    element.closest('.step-indicator') ||
                    element.closest('.modal') ||
                    element.closest('.color-picker-modal') ||
                    element.offsetParent === null) {
                    return;
                }

                // Apply the secondary text color with !important to override CSS
                element.style.setProperty('color', secondaryTextColor, 'important');
                adjustedCount++;
            });

            console.log(`âœ… Contrast adjustment complete. CSS variables set, ${adjustedCount} elements directly adjusted.`);
        }

        // Get the effective background color of an element (walks up the DOM tree)
        function getEffectiveBackgroundColor(element) {
            let current = element;

            while (current) {
                const computed = window.getComputedStyle(current);
                const bg = computed.backgroundColor;

                // Check if background is not transparent
                if (bg && bg !== 'rgba(0, 0, 0, 0)' && bg !== 'transparent') {
                    const hex = rgbToHex(bg);
                    if (hex) return hex;
                }

                // Check if we've reached the body
                if (current === document.body) {
                    break;
                }

                current = current.parentElement;
            }

            // Use designState.colors.background as the ultimate source of truth
            // This is the most reliable since it's what the user actually selected
            if (designState && designState.colors && designState.colors.background) {
                return designState.colors.background;
            }

            return '#ffffff';
        }

        // Convert RGB/RGBA color to HEX
        function rgbToHex(rgb) {
            if (rgb.startsWith('#')) return rgb;

            const match = rgb.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);
            if (!match) return null;

            const r = parseInt(match[1]);
            const g = parseInt(match[2]);
            const b = parseInt(match[3]);

            return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        // Calculate contrast ratio between two colors (WCAG formula)
        function calculateContrastRatio(color1, color2) {
            const lum1 = getRelativeLuminance(color1);
            const lum2 = getRelativeLuminance(color2);

            const lighter = Math.max(lum1, lum2);
            const darker = Math.min(lum1, lum2);

            return (lighter + 0.05) / (darker + 0.05);
        }

        // Get relative luminance of a color (WCAG formula)
        function getRelativeLuminance(color) {
            const hex = color.startsWith('#') ? color : rgbToHex(color);
            if (!hex) return 0;

            const rgb = parseInt(hex.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;

            const [rs, gs, bs] = [r, g, b].map(c => {
                c = c / 255;
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });

            return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
        }

        // Get the best contrast color (white or black) for a given background
        function getBestContrastColor(bgColor) {
            const whiteContrast = calculateContrastRatio('#ffffff', bgColor);
            const blackContrast = calculateContrastRatio('#1a1a1a', bgColor);

            // Return the color with better contrast
            return whiteContrast > blackContrast ? '#ffffff' : '#1a1a1a';
        }

        // Navigation
        function nextStep() {
            // Handle substeps for step 4
            if (currentStep === 4 && currentSubstep < totalSubsteps) {
                currentSubstep++;
                updateSubstepDisplay();
                setTimeout(() => autoAdjustTextContrast(), 100);
                return;
            }

            if (currentStep < totalSteps) {
                // Validate current step
                if (!validateStep(currentStep)) {
                    return;
                }

                currentStep++;
                currentSubstep = 1; // Reset substep when moving to next step
                updateStepDisplay();

                // Update summary on last step
                if (currentStep === 5) {
                    updateSummary();
                    generateToken();
                }

                // Recheck contrast when navigating steps
                setTimeout(() => autoAdjustTextContrast(), 100);
            }
        }

        function previousStep() {
            // Handle substeps for step 4
            if (currentStep === 4 && currentSubstep > 1) {
                currentSubstep--;
                updateSubstepDisplay();
                setTimeout(() => autoAdjustTextContrast(), 100);
                return;
            }

            if (currentStep > 1) {
                currentStep--;
                // Set to last substep if going back to step 4
                if (currentStep === 4) {
                    currentSubstep = totalSubsteps;
                }
                updateStepDisplay();

                // Recheck contrast when navigating steps
                setTimeout(() => autoAdjustTextContrast(), 100);
            }
        }

        function updateStepDisplay() {
            // Update step indicator
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                }
            });

            // Update content
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.add('active');

            // Initialize substeps if on step 4
            if (currentStep === 4) {
                updateSubstepDisplay();
            }

            // Update color inputs if on step 2 (colors)
            if (currentStep === 2) {
                document.getElementById('color-primary').value = designState.colors.primary;
                document.getElementById('color-primary-text').value = designState.colors.primary;
                document.getElementById('picker-primary').style.backgroundColor = designState.colors.primary;

                document.getElementById('color-background').value = designState.colors.background;
                document.getElementById('color-background-text').value = designState.colors.background;
                document.getElementById('picker-background').style.backgroundColor = designState.colors.background;

                document.getElementById('color-accent').value = designState.colors.accent;
                document.getElementById('color-accent-text').value = designState.colors.accent;
                document.getElementById('picker-accent').style.backgroundColor = designState.colors.accent;

                validateColors();
            }

            // Update navigation buttons
            const prevBtn = document.querySelector('.btn-prev');
            const nextBtn = document.querySelector('.btn-next');

            prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';

            if (currentStep === totalSteps) {
                nextBtn.innerHTML = '<i class="fas fa-check"></i> Valider ce style';
                nextBtn.classList.add('btn-validate');
                nextBtn.onclick = validateDesign;
            } else {
                nextBtn.innerHTML = 'Suivant <i class="fas fa-chevron-right"></i>';
                nextBtn.classList.remove('btn-validate');
                nextBtn.onclick = nextStep;
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateSubstepDisplay() {
            // Update substep dots
            document.querySelectorAll('.substep-dot').forEach((dot, index) => {
                dot.classList.remove('active');
                if (index + 1 === currentSubstep) {
                    dot.classList.add('active');
                }
            });

            // Update substep content
            document.querySelectorAll('.substep-content').forEach(content => {
                content.classList.remove('active');
            });
            const activeSubstep = document.querySelector(`.substep-content[data-substep="${currentSubstep}"]`);
            if (activeSubstep) {
                activeSubstep.classList.add('active');
            }

            // Don't scroll when changing substeps - only smooth scroll to content area
            const contentMain = document.querySelector('.content-main');
            if (contentMain) {
                contentMain.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        function validateStep(step) {
            switch(step) {
                case 1:
                    if (!designState.style) {
                        alert('Veuillez sÃ©lectionner un style visuel');
                        return false;
                    }
                    break;
                case 3:
                    if (!designState.typography) {
                        alert('Veuillez sÃ©lectionner une typographie');
                        return false;
                    }
                    break;
            }
            return true;
        }

        function enableNextButton() {
            document.querySelector('.btn-next').classList.remove('disabled');
        }

        // Update Summary
        function updateSummary() {
            document.getElementById('summary-style').textContent = styleNames[designState.style] || 'â€”';
            document.getElementById('summary-primary').textContent = designState.colors.primary;
            document.getElementById('summary-background').textContent = designState.colors.background;
            document.getElementById('summary-accent').textContent = designState.colors.accent;
            document.getElementById('summary-typo').textContent = typoNames[designState.typography] || 'â€”';
            document.getElementById('summary-anim').textContent = settingLabels.animations[designState.settings.animations];
            document.getElementById('summary-radius').textContent = settingLabels.radius[designState.settings.radius - 1];
            document.getElementById('summary-density').textContent = settingLabels.density[designState.settings.density - 1];
        }

        // Token Generation
        function generateToken() {
            const { version, style, colors, typography, settings } = designState;

            // Format: DG1|S:GLS|C:438DD7-FFFFFF-20375D|T:M1|A:2|R:3|D:2|TR:2|SC:1
            const colorStr = `${colors.primary.replace('#', '')}-${colors.background.replace('#', '')}-${colors.accent.replace('#', '')}`;
            const token = `${version}|S:${style}|C:${colorStr}|T:${typography}|A:${settings.animations}|R:${settings.radius}|D:${settings.density}|TR:${settings.transitions}|SC:${settings.scroll}`;

            document.getElementById('token-value').textContent = token;
            return token;
        }

        // Token Parsing
        function parseToken(token) {
            try {
                const parts = token.split('|');

                designState.version = parts[0];

                parts.forEach(part => {
                    if (part.startsWith('S:')) {
                        designState.style = part.substring(2);
                    } else if (part.startsWith('C:')) {
                        const colors = part.substring(2).split('-');
                        designState.colors.primary = '#' + colors[0];
                        designState.colors.background = '#' + colors[1];
                        designState.colors.accent = '#' + colors[2];
                        // Mark colors as manually set so theme defaults don't override them
                        manualOverrides.colors = true;
                        console.log('ðŸ”‘ Token colors loaded, manualOverrides.colors set to true');
                    } else if (part.startsWith('T:')) {
                        designState.typography = part.substring(2);
                    } else if (part.startsWith('A:')) {
                        designState.settings.animations = parseInt(part.substring(2));
                    } else if (part.startsWith('R:')) {
                        designState.settings.radius = parseInt(part.substring(2));
                    } else if (part.startsWith('D:')) {
                        designState.settings.density = parseInt(part.substring(2));
                    } else if (part.startsWith('TR:')) {
                        designState.settings.transitions = parseInt(part.substring(2));
                    } else if (part.startsWith('SC:')) {
                        designState.settings.scroll = parseInt(part.substring(2));
                    }
                });

                return true;
            } catch (e) {
                console.error('Invalid token:', e);
                return false;
            }
        }

        // Update UI from state
        function updateUI() {
            // Select style card
            document.querySelectorAll('.style-card').forEach(card => {
                if (card.dataset.style === designState.style) {
                    card.classList.add('selected');
                }
            });

            // Update color pickers
            document.getElementById('color-primary').value = designState.colors.primary;
            document.getElementById('color-primary-text').value = designState.colors.primary;
            document.getElementById('color-background').value = designState.colors.background;
            document.getElementById('color-background-text').value = designState.colors.background;
            document.getElementById('color-accent').value = designState.colors.accent;
            document.getElementById('color-accent-text').value = designState.colors.accent;

            // Select typography
            document.querySelectorAll('.typo-option').forEach(option => {
                if (option.dataset.typo === designState.typography) {
                    option.classList.add('selected');
                }
            });

            // Select settings
            Object.keys(designState.settings).forEach(key => {
                const settingKey = key === 'animations' ? 'anim' :
                                  key === 'transitions' ? 'trans' : key;
                const value = designState.settings[key];

                document.querySelectorAll(`.setting-option[data-setting="${settingKey}"]`).forEach(option => {
                    if (parseInt(option.dataset.value) === value) {
                        option.classList.add('selected');
                    }
                });
            });

            validateColors();

            // Force a recalculation by calling applyGlobalStyles with a small delay
            // This ensures all DOM updates are complete before applying styles
            setTimeout(() => {
                console.log('ðŸŽ¨ Applying styles after token load with colors:', designState.colors);
                applyGlobalStyles();
                // Longer delay for contrast adjustment to ensure all styles are rendered
                setTimeout(() => {
                    console.log('ðŸŽ¨ Running contrast adjustment after token load...');
                    autoAdjustTextContrast();
                }, 200);
            }, 100);
        }

        // Welcome Screen Functions
        function startOnboarding() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('onboardingContainer').style.display = 'flex';
        }

        function showTokenInput() {
            showPrompt(
                'Entrez votre code de design',
                'Collez votre code de design pour charger votre configuration existante :',
                'info',
                (token) => {
                    if (token && parseToken(token)) {
                        updateUI();
                        currentStep = 1;
                        updateStepDisplay();
                        document.getElementById('welcomeScreen').classList.add('hidden');
                        document.getElementById('onboardingContainer').style.display = 'flex';
                        showAlert('Code chargÃ© avec succÃ¨s !', 'Votre configuration a Ã©tÃ© restaurÃ©e.', 'success');
                    } else if (token) {
                        showAlert('Code invalide', 'Le code que vous avez entrÃ© n\'est pas valide. Veuillez vÃ©rifier le format.', 'error');
                    }
                }
            );
        }

        // Custom Modal Functions
        function showAlert(title, message, type = 'info', callback = null) {
            const modal = document.getElementById('customModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalActions = document.getElementById('modalActions');
            const modalInputContainer = document.getElementById('modalInputContainer');

            // Set icon based on type
            modalIcon.className = `modal-icon ${type}`;
            if (type === 'success') {
                modalIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
            } else if (type === 'error') {
                modalIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
            } else if (type === 'warning') {
                modalIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
            } else {
                modalIcon.innerHTML = '<i class="fas fa-info-circle"></i>';
            }

            modalTitle.textContent = title;
            modalBody.textContent = message;
            modalInputContainer.innerHTML = '';

            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-primary" onclick="closeModal(${callback ? 'true' : 'false'})">
                    OK
                </button>
            `;

            modal.classList.add('active');

            if (callback) {
                modal.dataset.callback = callback.toString();
            }
        }

        function showConfirm(title, message, type = 'info', onConfirm = null, onCancel = null) {
            const modal = document.getElementById('customModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalActions = document.getElementById('modalActions');
            const modalInputContainer = document.getElementById('modalInputContainer');

            modalIcon.className = `modal-icon ${type}`;
            if (type === 'success') {
                modalIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
            } else if (type === 'error') {
                modalIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
            } else if (type === 'warning') {
                modalIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
            } else {
                modalIcon.innerHTML = '<i class="fas fa-info-circle"></i>';
            }

            modalTitle.textContent = title;
            modalBody.textContent = message;
            modalInputContainer.innerHTML = '';

            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-secondary" onclick="closeModal(false, true)">
                    Annuler
                </button>
                <button class="modal-btn modal-btn-primary" onclick="closeModal(true, false)">
                    Confirmer
                </button>
            `;

            modal.classList.add('active');

            if (onConfirm) {
                modal.dataset.onConfirm = onConfirm.toString();
            }
            if (onCancel) {
                modal.dataset.onCancel = onCancel.toString();
            }
        }

        function showPrompt(title, message, type = 'info', callback = null) {
            const modal = document.getElementById('customModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalActions = document.getElementById('modalActions');
            const modalInputContainer = document.getElementById('modalInputContainer');

            modalIcon.className = `modal-icon ${type}`;
            modalIcon.innerHTML = '<i class="fas fa-keyboard"></i>';

            modalTitle.textContent = title;
            modalBody.textContent = message;

            modalInputContainer.innerHTML = '<input type="text" class="modal-input" id="promptInput" placeholder="Entrez votre code de design...">';

            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-secondary" onclick="closeModal(false, true)">
                    Annuler
                </button>
                <button class="modal-btn modal-btn-primary" onclick="submitPrompt()">
                    Valider
                </button>
            `;

            modal.classList.add('active');

            if (callback) {
                window.promptCallback = callback;
            }

            // Focus input
            setTimeout(() => {
                document.getElementById('promptInput').focus();
            }, 100);
        }

        function submitPrompt() {
            const input = document.getElementById('promptInput');
            const value = input ? input.value : null;

            if (window.promptCallback) {
                window.promptCallback(value);
                window.promptCallback = null;
            }

            closeModal(false);
        }

        function closeModal(executeCallback = false, executeCancel = false) {
            const modal = document.getElementById('customModal');

            if (executeCallback && modal.dataset.onConfirm) {
                eval('(' + modal.dataset.onConfirm + ')()');
                delete modal.dataset.onConfirm;
            } else if (executeCancel && modal.dataset.onCancel) {
                eval('(' + modal.dataset.onCancel + ')()');
                delete modal.dataset.onCancel;
            }

            modal.classList.remove('active');
        }

        // Example Modal Functions
        function showExample(styleCode, event) {
            if (event) {
                event.stopPropagation();
            }

            const styleData = {
                'MIN': {
                    name: 'Minimal Pro',
                    category: 'Classique',
                    description: 'Design Ã©purÃ© et moderne inspirÃ© par Apple. Espaces blancs gÃ©nÃ©reux, typographie claire et Ã©lÃ©gante.',
                },
                'GLS': {
                    name: 'Modern Glass',
                    category: 'Moderne',
                    description: 'Effets de verre dÃ©poli et transparences sophistiquÃ©es. Style premium et innovant avec des effets visuels captivants.',
                },
                'SFT': {
                    name: 'Soft UI',
                    category: 'Classique',
                    description: 'Interface douce inspirÃ©e par Google Material Design. Formes arrondies, couleurs pastel et ombres dÃ©licates.',
                },
                'EDT': {
                    name: 'Editorial',
                    category: 'Audacieux',
                    description: 'Style colorÃ© et expressif avec typographie forte. Contrastes marquÃ©s et mise en page magazine.',
                },
                'LUX': {
                    name: 'Luxury Dark',
                    category: 'Premium',
                    description: 'Ã‰lÃ©gance sombre inspirÃ©e des marques de luxe. Palette or et noir, finitions raffinÃ©es.',
                },
                'BRT': {
                    name: 'Brutal Modern',
                    category: 'Audacieux',
                    description: 'Design industriel audacieux avec formes brutes. Contrastes forts et typographie percutante.',
                },
                'RTF': {
                    name: 'Retro Future',
                    category: 'Audacieux',
                    description: 'EsthÃ©tique arcade et rÃ©tro-futuriste. NÃ©ons vibrants, gÃ©omÃ©trie audacieuse et ambiance annÃ©es 80.',
                }
            };

            const style = styleData[styleCode];
            if (!style) return;

            document.getElementById('exampleCategory').textContent = style.category;
            document.getElementById('exampleName').textContent = style.name;
            document.getElementById('exampleDesc').textContent = style.description;

            // Generate example site based on current design state
            const exampleSite = document.getElementById('exampleSite');
            exampleSite.innerHTML = generateExampleSite(styleCode);

            // Add interactive animations after DOM is ready
            setTimeout(() => {
                applyExampleAnimations(styleCode, exampleSite);
            }, 100);

            document.getElementById('exampleModal').classList.add('active');
        }

        function closeExample() {
            document.getElementById('exampleModal').classList.remove('active');
        }

        function applyExampleAnimations(styleCode, container) {
            const buttons = container.querySelectorAll('button');
            const links = container.querySelectorAll('a');

            // Select only feature cards in grid sections (not nav, sections, etc.)
            const cards = [];
            const gridSections = container.querySelectorAll('[style*="grid-template-columns"]');
            gridSections.forEach(grid => {
                grid.querySelectorAll(':scope > div').forEach(card => cards.push(card));
            });

            if (styleCode === 'MIN') {
                // Minimal: Subtle hover effects
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.3s ease';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'translateY(-2px)';
                        btn.style.boxShadow = '0 6px 20px rgba(0,0,0,0.15)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translateY(0)';
                        btn.style.boxShadow = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.2s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.opacity = '0.7';
                        link.style.transform = 'translateY(-1px)';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.opacity = '1';
                        link.style.transform = 'translateY(0)';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.3s ease';
                    // Force animation replay by removing and re-adding
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `fadeIn 0.5s ease ${i * 0.1}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-4px)';
                        card.style.boxShadow = '0 8px 24px rgba(0,0,0,0.12)';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0)';
                        card.style.boxShadow = '0 2px 8px rgba(0,0,0,0.05)';
                    });
                });
            } else if (styleCode === 'GLS') {
                // Glass: Floating and glow effects
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'translateY(-3px) scale(1.02)';
                        btn.style.boxShadow = '0 8px 32px rgba(67, 141, 215, 0.5), 0 16px 48px rgba(67, 141, 215, 0.3)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translateY(0) scale(1)';
                        btn.style.boxShadow = '0 4px 16px rgba(67, 141, 215, 0.4)';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.3s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.textShadow = '0 0 8px rgba(67, 141, 215, 0.8)';
                        link.style.transform = 'translateY(-1px)';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.textShadow = '0 1px 2px rgba(255,255,255,0.8)';
                        link.style.transform = 'translateY(0)';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `glassSlide 0.6s ease ${i * 0.15}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-6px)';
                        card.style.boxShadow = '0 16px 48px rgba(0,0,0,0.2), inset 0 2px 2px rgba(255,255,255,0.3)';
                        card.style.background = 'rgba(255, 255, 255, 0.15)';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0)';
                        card.style.boxShadow = '0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 1px rgba(255, 255, 255, 0.15)';
                        card.style.background = 'rgba(255, 255, 255, 0.08)';
                    });
                });
            } else if (styleCode === 'SFT') {
                // Soft UI: Bouncy elevations
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'translateY(-3px) scale(1.05)';
                        btn.style.boxShadow = '0 12px 32px rgba(66, 133, 244, 0.4)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translateY(0) scale(1)';
                        btn.style.boxShadow = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
                    link.addEventListener('mouseenter', () => {
                        link.style.transform = 'scale(1.1)';
                        link.style.fontWeight = 'bold';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.transform = 'scale(1)';
                        link.style.fontWeight = '';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `softBounce 0.6s ease ${i * 0.1}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-6px) scale(1.02)';
                        card.style.boxShadow = '0 16px 40px rgba(66, 133, 244, 0.3)';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0) scale(1)';
                        card.style.boxShadow = '';
                    });
                });
            } else if (styleCode === 'EDT') {
                // Editorial: Color shifts and borders
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.3s ease';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'scale(1.05)';
                        btn.style.filter = 'brightness(1.1)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'scale(1)';
                        btn.style.filter = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.2s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.textDecoration = 'underline';
                        link.style.textUnderlineOffset = '4px';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.textDecoration = 'none';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.3s ease';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `edtSlide 0.5s ease ${i * 0.1}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-4px)';
                        card.style.borderWidth = '4px';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0)';
                        card.style.borderWidth = '';
                    });
                });
            } else if (styleCode === 'LUX') {
                // Luxury: Gold glow effects
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.4s ease';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'translateY(-2px)';
                        btn.style.boxShadow = '0 0 40px rgba(212, 175, 55, 0.6), 0 8px 24px rgba(0,0,0,0.8)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translateY(0)';
                        btn.style.boxShadow = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.3s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.textShadow = '0 0 20px rgba(212, 175, 55, 0.8)';
                        link.style.letterSpacing = '3px';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.textShadow = '';
                        link.style.letterSpacing = '2px';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.4s ease';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `luxGlowIn 0.8s ease ${i * 0.2}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-4px)';
                        card.style.boxShadow = '0 0 60px rgba(212, 175, 55, 0.5), 0 12px 40px rgba(0,0,0,0.9)';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0)';
                        card.style.boxShadow = '';
                    });
                });
            } else if (styleCode === 'BRT') {
                // Brutal: Hard shifts
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.2s ease';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'translate(-3px, -3px)';
                        btn.style.boxShadow = '8px 8px 0 ' + (btn.style.boxShadow.match(/#[0-9A-F]{6}/i) || ['#000'])[0];
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'translate(0, 0)';
                        btn.style.boxShadow = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.15s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.textDecoration = 'line-through';
                        link.style.fontWeight = 'bold';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.textDecoration = 'none';
                        link.style.fontWeight = '';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.2s ease';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `brtPop 0.4s ease ${i * 0.1}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translate(-3px, -3px)';
                        card.style.boxShadow = '8px 8px 0 ' + (card.style.boxShadow.match(/#[0-9A-F]{6}/i) || ['#000'])[0];
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translate(0, 0)';
                        card.style.boxShadow = '';
                    });
                });
            } else if (styleCode === 'RTF') {
                // Retro Future: Neon pulses
                buttons.forEach(btn => {
                    btn.style.transition = 'all 0.3s ease';
                    btn.style.cursor = 'pointer';
                    btn.addEventListener('mouseenter', () => {
                        btn.style.transform = 'scale(1.05)';
                        btn.style.boxShadow = '0 0 30px rgba(156, 39, 176, 0.8), 0 0 60px rgba(156, 39, 176, 0.5)';
                    });
                    btn.addEventListener('mouseleave', () => {
                        btn.style.transform = 'scale(1)';
                        btn.style.boxShadow = '';
                    });
                });

                links.forEach(link => {
                    link.style.transition = 'all 0.2s ease';
                    link.addEventListener('mouseenter', () => {
                        link.style.textShadow = '0 0 15px rgba(156, 39, 176, 1)';
                        link.style.transform = 'scale(1.05)';
                    });
                    link.addEventListener('mouseleave', () => {
                        link.style.textShadow = '';
                        link.style.transform = 'scale(1)';
                    });
                });

                cards.forEach((card, i) => {
                    card.style.transition = 'all 0.3s ease';
                    card.style.animation = 'none';
                    setTimeout(() => {
                        card.style.animation = `rtfFlicker 0.6s ease ${i * 0.15}s both`;
                    }, 10);
                    card.style.cursor = 'pointer';
                    card.addEventListener('mouseenter', () => {
                        card.style.transform = 'translateY(-4px)';
                        card.style.boxShadow = '0 0 40px rgba(156, 39, 176, 0.7), 0 8px 32px rgba(0,0,0,0.5)';
                    });
                    card.addEventListener('mouseleave', () => {
                        card.style.transform = 'translateY(0)';
                        card.style.boxShadow = '';
                    });
                });
            }

            // Add CSS animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                @keyframes glassSlide {
                    from { opacity: 0; transform: translateY(30px) scale(0.95); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                @keyframes softBounce {
                    0% { opacity: 0; transform: translateY(40px) scale(0.9); }
                    60% { transform: translateY(-10px) scale(1.02); }
                    100% { opacity: 1; transform: translateY(0) scale(1); }
                }
                @keyframes edtSlide {
                    from { opacity: 0; transform: translateX(-30px); }
                    to { opacity: 1; transform: translateX(0); }
                }
                @keyframes luxGlowIn {
                    from { opacity: 0; transform: scale(0.9); filter: brightness(0.5); }
                    to { opacity: 1; transform: scale(1); filter: brightness(1); }
                }
                @keyframes brtPop {
                    0% { opacity: 0; transform: scale(0.8) rotate(-5deg); }
                    70% { transform: scale(1.05) rotate(2deg); }
                    100% { opacity: 1; transform: scale(1) rotate(0deg); }
                }
                @keyframes rtfFlicker {
                    0%, 50% { opacity: 0; }
                    55% { opacity: 0.5; }
                    60%, 100% { opacity: 1; }
                }
            `;
            container.appendChild(style);
        }

        function generateExampleSite(styleCode) {
            const { primary, background, accent } = designState.colors;
            const { radius, density } = designState.settings;

            const borderRadius = radius === 1 ? '4px' : radius === 2 ? '8px' : '16px';
            const padding = density === 1 ? '12px' : density === 2 ? '20px' : '32px';
            const gap = density === 1 ? '12px' : density === 2 ? '20px' : '32px';

            // Generate different layouts based on style
            let siteHTML = '';

            if (styleCode === 'MIN') {
                siteHTML = `
                    <div style="background: ${background}; min-height: 600px; font-family: -apple-system, sans-serif;">
                        <nav style="padding: ${padding}; background: ${background}; border-bottom: 1px solid rgba(0,0,0,0.1);">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 700; font-size: 1.5rem; color: ${primary};">Logo</div>
                                <div style="display: flex; gap: ${gap};">
                                    <a href="#" style="color: #333; text-decoration: none;">Accueil</a>
                                    <a href="#" style="color: #333; text-decoration: none;">Services</a>
                                    <a href="#" style="color: #333; text-decoration: none;">Contact</a>
                                </div>
                            </div>
                        </nav>
                        <section style="padding: 80px ${padding}; text-align: center;">
                            <h1 style="font-size: 3.5rem; font-weight: 700; margin-bottom: 20px; color: #000;">Design Minimal</h1>
                            <p style="font-size: 1.3rem; color: #666; max-width: 600px; margin: 0 auto 40px;">
                                L'essence de la simplicitÃ© et de l'Ã©lÃ©gance.
                            </p>
                            <button style="background: ${primary}; color: white; padding: 16px 48px; border: none; border-radius: ${borderRadius}; font-size: 1.1rem; cursor: pointer; font-weight: 600;">
                                DÃ©couvrir
                            </button>
                        </section>
                        <section style="padding: ${padding}; max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <h3 style="color: ${primary}; margin-bottom: 12px;">FonctionnalitÃ© 1</h3>
                                    <p style="color: #666;">Description claire et concise.</p>
                                </div>
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <h3 style="color: ${primary}; margin-bottom: 12px;">FonctionnalitÃ© 2</h3>
                                    <p style="color: #666;">Interface Ã©purÃ©e et intuitive.</p>
                                </div>
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <h3 style="color: ${primary}; margin-bottom: 12px;">FonctionnalitÃ© 3</h3>
                                    <p style="color: #666;">ExpÃ©rience utilisateur optimale.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'GLS') {
                siteHTML = `
                    <div style="background: linear-gradient(135deg, ${primary}18 0%, ${primary}08 25%, #e8f4ff 50%, #f0f9ff 75%, ${background} 100%); min-height: 600px; font-family: -apple-system, sans-serif; position: relative; overflow: hidden;">
                        <!-- Ambient gradient blobs for realistic glass depth -->
                        <div style="position: absolute; width: 500px; height: 500px; background: radial-gradient(circle, ${primary}35, ${primary}15 40%, transparent 70%); border-radius: 50%; top: -150px; right: -150px; filter: blur(80px); pointer-events: none;"></div>
                        <div style="position: absolute; width: 400px; height: 400px; background: radial-gradient(circle, ${primary}25, transparent 65%); border-radius: 50%; bottom: 80px; left: -100px; filter: blur(70px); pointer-events: none;"></div>
                        <div style="position: absolute; width: 350px; height: 350px; background: radial-gradient(circle, rgba(255, 255, 255, 0.4), transparent 60%); border-radius: 50%; top: 50%; right: 20%; filter: blur(60px); pointer-events: none;"></div>

                        <nav style="padding: ${padding}; background: linear-gradient(135deg, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0.3) 100%); backdrop-filter: blur(40px) saturate(200%); -webkit-backdrop-filter: blur(40px) saturate(200%); border-bottom: 2px solid rgba(255,255,255,0.6); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.12), 0 2px 8px 0 rgba(31, 38, 135, 0.08), inset 0 1px 0 0 rgba(255,255,255,0.9), inset 0 -1px 0 0 rgba(255,255,255,0.4); position: relative;">
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255,255,255,0.6) 0%, rgba(255,255,255,0.1) 100%); pointer-events: none; opacity: 0.5;"></div>
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 1;">
                                <div style="font-weight: 700; font-size: 1.5rem; background: linear-gradient(135deg, ${primary}, ${primary}dd); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));">Logo</div>
                                <div style="display: flex; gap: ${gap};">
                                    <a href="#" style="color: #1a1a1a; text-decoration: none; font-weight: 500; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">Accueil</a>
                                    <a href="#" style="color: #1a1a1a; text-decoration: none; font-weight: 500; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">Services</a>
                                    <a href="#" style="color: #1a1a1a; text-decoration: none; font-weight: 500; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">Contact</a>
                                </div>
                            </div>
                        </nav>
                        <section style="padding: 80px ${padding}; text-align: center; position: relative;">
                            <h1 style="font-size: 3.5rem; font-weight: 700; margin-bottom: 20px; background: linear-gradient(135deg, #000 0%, #333 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1));">Verre TrempÃ©</h1>
                            <p style="font-size: 1.3rem; color: #444; max-width: 600px; margin: 0 auto 40px; font-weight: 400; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">
                                Effets de verre trempÃ© ultra-rÃ©alistes avec reflets et profondeur.
                            </p>
                            <button style="background: linear-gradient(135deg, ${primary} 0%, ${primary}dd 100%); color: white; padding: 16px 48px; border: none; border-radius: ${borderRadius}; font-size: 1.1rem; cursor: pointer; font-weight: 600; box-shadow: 0 4px 16px ${primary}40, 0 8px 32px ${primary}30, inset 0 1px 0 rgba(255,255,255,0.4), inset 0 -1px 0 rgba(0,0,0,0.2); position: relative;">
                                <span style="position: relative; z-index: 1; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">En savoir plus</span>
                            </button>
                        </section>
                        <section style="padding: ${padding}; max-width: 1200px; margin: 0 auto; position: relative;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <!-- LIQUID GLASS CARD -->
                                <div style="padding: ${padding}; background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); border-radius: ${borderRadius}; border: 1px solid rgba(255, 255, 255, 0.18); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 1px rgba(255, 255, 255, 0.15); position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden;">
                                    <!-- Frost color overlay -->
                                    <div style="position: absolute; inset: 0; background: linear-gradient(135deg, rgba(0, 0, 0, 0.08) 0%, transparent 50%, rgba(0, 0, 0, 0.05) 100%); pointer-events: none; border-radius: ${borderRadius};"></div>
                                    <div style="position: relative; z-index: 1;">
                                        <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 700;">Liquid Glass</h3>
                                        <p style="color: #666; line-height: 1.6;">Verre fluide avec reflets organiques.</p>
                                    </div>
                                </div>

                                <!-- FROSTED GLASS CARD -->
                                <div style="padding: ${padding}; background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); border-radius: ${borderRadius}; border: 1px solid rgba(255, 255, 255, 0.18); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 1px rgba(255, 255, 255, 0.15); position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden;">
                                    <!-- Frost color overlay - more visible -->
                                    <div style="position: absolute; inset: 0; background: linear-gradient(135deg, rgba(0, 0, 0, 0.12) 0%, transparent 50%, rgba(0, 0, 0, 0.08) 100%); pointer-events: none; border-radius: ${borderRadius};"></div>
                                    <div style="position: relative; z-index: 1;">
                                        <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 700;">Frosted Glass</h3>
                                        <p style="color: #666; line-height: 1.6;">Verre dÃ©poli avec effets de profondeur.</p>
                                    </div>
                                </div>

                                <!-- TEMPERED GLASS CARD -->
                                <div style="padding: ${padding}; background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); border-radius: ${borderRadius}; border: 1px solid rgba(255, 255, 255, 0.18); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), inset 0 1px 1px rgba(255, 255, 255, 0.15); position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden;">
                                    <!-- Frost color overlay - max visibility -->
                                    <div style="position: absolute; inset: 0; background: linear-gradient(135deg, rgba(0, 0, 0, 0.15) 0%, transparent 50%, rgba(0, 0, 0, 0.1) 100%); pointer-events: none; border-radius: ${borderRadius};"></div>
                                    <div style="position: relative; z-index: 1;">
                                        <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 700;">Tempered Glass</h3>
                                        <p style="color: #666; line-height: 1.6;">Verre trempÃ© avec biseaux et brillance.</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'LUX') {
                const luxBg = manualOverrides.colors ? background : '#0a0a0a';
                const luxGold = accent || '#D4AF37';
                siteHTML = `
                    <div style="background: ${luxBg}; min-height: 600px; font-family: 'Cormorant Garamond', Georgia, serif; color: #fff; position: relative; overflow: hidden;">
                        <!-- Subtle ambient glow -->
                        <div style="position: absolute; width: 600px; height: 600px; background: radial-gradient(circle, ${luxGold}15 0%, transparent 70%); top: -200px; right: -200px; filter: blur(100px); pointer-events: none;"></div>
                        <div style="position: absolute; width: 500px; height: 500px; background: radial-gradient(circle, ${luxGold}08 0%, transparent 70%); bottom: -150px; left: -150px; filter: blur(80px); pointer-events: none;"></div>

                        <nav style="padding: ${padding}; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(20px); border-bottom: 1px solid ${luxGold}40; box-shadow: 0 4px 24px rgba(0,0,0,0.8); position: relative; z-index: 10;">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 500; font-size: 2rem; color: ${luxGold}; letter-spacing: 6px; font-family: 'Cinzel', serif;">LUXXE</div>
                                <div style="display: flex; gap: 40px; font-family: 'Montserrat', sans-serif;">
                                    <a href="#" style="color: ${luxGold}; text-decoration: none; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 2px; font-weight: 400; transition: all 0.3s; position: relative; padding-bottom: 4px;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='${luxGold}'">Collection</a>
                                    <a href="#" style="color: ${luxGold}; text-decoration: none; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 2px; font-weight: 400; transition: all 0.3s; position: relative; padding-bottom: 4px;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='${luxGold}'">Boutique</a>
                                    <a href="#" style="color: ${luxGold}; text-decoration: none; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 2px; font-weight: 400; transition: all 0.3s; position: relative; padding-bottom: 4px;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='${luxGold}'">Contact</a>
                                </div>
                            </div>
                        </nav>

                        <section style="padding: 120px ${padding}; text-align: center; position: relative; z-index: 5;">
                            <div style="font-size: 0.9rem; color: ${luxGold}; text-transform: uppercase; letter-spacing: 4px; margin-bottom: 24px; font-family: 'Montserrat', sans-serif; font-weight: 300;">Collection Exclusive 2026</div>
                            <h1 style="font-size: 5rem; font-weight: 300; margin-bottom: 32px; color: #fff; letter-spacing: 8px; line-height: 1.1; text-shadow: 0 0 40px ${luxGold}30;">EXCELLENCE<br/><span style="color: ${luxGold}; font-style: italic; font-size: 3.5rem;">Ã‰ternelle</span></h1>
                            <p style="font-size: 1.15rem; color: #ccc; max-width: 650px; margin: 0 auto 50px; font-style: italic; line-height: 1.8; font-weight: 300;">
                                L'art de la perfection rencontre le raffinement absolu.<br/>
                                DÃ©couvrez une expÃ©rience de luxe inÃ©galÃ©e.
                            </p>
                            <button style="background: linear-gradient(135deg, ${luxGold} 0%, ${luxGold}dd 100%); color: #000; padding: 18px 56px; border: none; border-radius: ${borderRadius}; font-size: 0.9rem; cursor: pointer; font-weight: 600; text-transform: uppercase; letter-spacing: 3px; box-shadow: 0 8px 32px ${luxGold}40, 0 0 60px ${luxGold}20; transition: all 0.4s; font-family: 'Montserrat', sans-serif; position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 12px 40px ${luxGold}60, 0 0 80px ${luxGold}30';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 32px ${luxGold}40, 0 0 60px ${luxGold}20';">
                                <span style="position: relative; z-index: 1;">DÃ©couvrir la Collection</span>
                            </button>
                        </section>

                        <section style="padding: 60px ${padding}; max-width: 1200px; margin: 0 auto; position: relative; z-index: 5;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <div style="padding: 40px ${padding}; background: linear-gradient(135deg, rgba(212, 175, 55, 0.08) 0%, rgba(212, 175, 55, 0.02) 100%); border-radius: ${borderRadius}; border: 1px solid ${luxGold}30; box-shadow: 0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 ${luxGold}20; position: relative; overflow: hidden;">
                                    <div style="width: 60px; height: 60px; margin: 0 auto 20px; background: linear-gradient(135deg, ${luxGold}20 0%, ${luxGold}10 100%); border: 2px solid ${luxGold}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; box-shadow: 0 4px 16px ${luxGold}40, inset 0 2px 8px ${luxGold}20;">ðŸ‘‘</div>
                                    <h3 style="color: ${luxGold}; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 3px; font-size: 1.1rem; font-family: 'Montserrat', sans-serif; font-weight: 500;">Prestige</h3>
                                    <p style="color: #bbb; font-size: 0.95rem; line-height: 1.7; font-weight: 300;">Excellence et sophistication dans chaque dÃ©tail.</p>
                                </div>
                                <div style="padding: 40px ${padding}; background: linear-gradient(135deg, rgba(212, 175, 55, 0.08) 0%, rgba(212, 175, 55, 0.02) 100%); border-radius: ${borderRadius}; border: 1px solid ${luxGold}30; box-shadow: 0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 ${luxGold}20; position: relative; overflow: hidden;">
                                    <div style="width: 60px; height: 60px; margin: 0 auto 20px; background: linear-gradient(135deg, ${luxGold}20 0%, ${luxGold}10 100%); border: 2px solid ${luxGold}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; box-shadow: 0 4px 16px ${luxGold}40, inset 0 2px 8px ${luxGold}20;">ðŸ’Ž</div>
                                    <h3 style="color: ${luxGold}; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 3px; font-size: 1.1rem; font-family: 'Montserrat', sans-serif; font-weight: 500;">Exclusif</h3>
                                    <p style="color: #bbb; font-size: 0.95rem; line-height: 1.7; font-weight: 300;">CrÃ©ations uniques en Ã©dition limitÃ©e.</p>
                                </div>
                                <div style="padding: 40px ${padding}; background: linear-gradient(135deg, rgba(212, 175, 55, 0.08) 0%, rgba(212, 175, 55, 0.02) 100%); border-radius: ${borderRadius}; border: 1px solid ${luxGold}30; box-shadow: 0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 ${luxGold}20; position: relative; overflow: hidden;">
                                    <div style="width: 60px; height: 60px; margin: 0 auto 20px; background: linear-gradient(135deg, ${luxGold}20 0%, ${luxGold}10 100%); border: 2px solid ${luxGold}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; box-shadow: 0 4px 16px ${luxGold}40, inset 0 2px 8px ${luxGold}20;">âœ¨</div>
                                    <h3 style="color: ${luxGold}; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 3px; font-size: 1.1rem; font-family: 'Montserrat', sans-serif; font-weight: 500;">Ã‰lÃ©gance</h3>
                                    <p style="color: #bbb; font-size: 0.95rem; line-height: 1.7; font-weight: 300;">Finitions raffinÃ©es haut de gamme.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'SFT') {
                // Soft UI - Google Material inspired
                siteHTML = `
                    <div style="background: linear-gradient(135deg, #E3F2FD 0%, #F5F5F5 100%); min-height: 600px; font-family: 'Roboto', sans-serif;">
                        <nav style="padding: ${padding}; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 500; font-size: 1.5rem; color: ${primary};">Material</div>
                                <div style="display: flex; gap: ${gap}; align-items: center;">
                                    <a href="#" style="color: #666; text-decoration: none; padding: 8px 16px; border-radius: ${borderRadius}; transition: background 0.3s;">Accueil</a>
                                    <a href="#" style="color: #666; text-decoration: none; padding: 8px 16px; border-radius: ${borderRadius};">Services</a>
                                    <button style="background: ${primary}; color: white; padding: 10px 24px; border: none; border-radius: ${borderRadius}; cursor: pointer; box-shadow: 0 2px 8px ${primary}40;">Contact</button>
                                </div>
                            </div>
                        </nav>
                        <section style="padding: 100px ${padding}; text-align: center;">
                            <h1 style="font-size: 3.5rem; font-weight: 400; margin-bottom: 20px; color: #333;">Soft & Smooth</h1>
                            <p style="font-size: 1.3rem; color: #666; max-width: 600px; margin: 0 auto 40px; line-height: 1.6;">
                                Design doux et arrondi inspirÃ© par Material Design
                            </p>
                            <button style="background: ${primary}; color: white; padding: 16px 48px; border: none; border-radius: ${borderRadius}; font-size: 1.1rem; cursor: pointer; box-shadow: 0 4px 16px ${primary}40; transition: all 0.3s;">
                                DÃ©couvrir
                            </button>
                        </section>
                        <section style="padding: ${padding}; max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 4px 16px rgba(0,0,0,0.08); transition: all 0.3s;">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, ${primary} 0%, ${accent} 100%); border-radius: ${borderRadius}; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; box-shadow: 0 4px 12px ${primary}30;">ðŸ“±</div>
                                    <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 500;">Interface douce</h3>
                                    <p style="color: #666; line-height: 1.6;">Formes arrondies et ombres dÃ©licates.</p>
                                </div>
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 4px 16px rgba(0,0,0,0.08);">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, ${primary} 0%, ${accent} 100%); border-radius: ${borderRadius}; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; box-shadow: 0 4px 12px ${primary}30;">ðŸŽ¨</div>
                                    <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 500;">Couleurs pastel</h3>
                                    <p style="color: #666; line-height: 1.6;">Palette de couleurs douces et apaisantes.</p>
                                </div>
                                <div style="padding: ${padding}; background: white; border-radius: ${borderRadius}; box-shadow: 0 4px 16px rgba(0,0,0,0.08);">
                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, ${primary} 0%, ${accent} 100%); border-radius: ${borderRadius}; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; box-shadow: 0 4px 12px ${primary}30;">âœ¨</div>
                                    <h3 style="color: ${primary}; margin-bottom: 12px; font-weight: 500;">Transitions fluides</h3>
                                    <p style="color: #666; line-height: 1.6;">Animations et effets harmonieux.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'EDT') {
                // Editorial - Bold and colorful
                siteHTML = `
                    <div style="background: ${background}; min-height: 600px; font-family: 'Playfair Display', Georgia, serif;">
                        <nav style="padding: ${padding}; background: ${primary}; color: white; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 900; font-size: 2rem; letter-spacing: -1px;">EDITORIAL</div>
                                <div style="display: flex; gap: ${gap}; font-family: sans-serif; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; font-weight: 600;">
                                    <a href="#" style="color: white; text-decoration: none;">Stories</a>
                                    <a href="#" style="color: white; text-decoration: none;">Features</a>
                                    <a href="#" style="color: white; text-decoration: none;">About</a>
                                </div>
                            </div>
                        </nav>
                        <section style="padding: 80px ${padding};">
                            <div style="max-width: 900px; margin: 0 auto;">
                                <div style="display: inline-block; background: ${primary}; color: white; padding: 6px 16px; border-radius: 4px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px; font-family: sans-serif; font-weight: 700;">Magazine</div>
                                <h1 style="font-size: 4.5rem; font-weight: 900; line-height: 1.1; margin-bottom: 24px; color: #000; letter-spacing: -2px;">Bold Typography<br/>& Strong Colors</h1>
                                <p style="font-size: 1.4rem; color: #555; line-height: 1.8; font-family: Georgia, serif; margin-bottom: 40px;">
                                    Un style Ã©ditorial expressif avec des contrastes marquÃ©s, idÃ©al pour raconter des histoires visuelles captivantes.
                                </p>
                                <button style="background: ${accent}; color: white; padding: 18px 48px; border: none; border-radius: 0; font-size: 1rem; cursor: pointer; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; box-shadow: 8px 8px 0 rgba(0,0,0,0.15); transition: all 0.2s;">
                                    Lire la suite â†’
                                </button>
                            </div>
                        </section>
                        <section style="padding: ${padding}; max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <div style="position: relative; overflow: hidden;">
                                    <div style="height: 300px; background: linear-gradient(135deg, ${primary} 0%, ${accent} 100%); border-radius: ${borderRadius}; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem; font-weight: 900;">01</div>
                                    <h3 style="font-size: 1.8rem; font-weight: 900; margin: 16px 0 8px; color: #000;">Typographie Forte</h3>
                                    <p style="color: #666; font-family: sans-serif; line-height: 1.6;">Des titres percutants qui captivent l'attention.</p>
                                </div>
                                <div style="position: relative; overflow: hidden;">
                                    <div style="height: 300px; background: linear-gradient(135deg, ${accent} 0%, ${primary} 100%); border-radius: ${borderRadius}; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem; font-weight: 900;">02</div>
                                    <h3 style="font-size: 1.8rem; font-weight: 900; margin: 16px 0 8px; color: #000;">Couleurs Vives</h3>
                                    <p style="color: #666; font-family: sans-serif; line-height: 1.6;">Palette audacieuse et contrastÃ©e.</p>
                                </div>
                                <div style="position: relative; overflow: hidden;">
                                    <div style="height: 300px; background: linear-gradient(135deg, ${primary}CC 0%, ${accent}CC 100%); border-radius: ${borderRadius}; display: flex; align-items: center; justify-content: center; color: white; font-size: 4rem; font-weight: 900;">03</div>
                                    <h3 style="font-size: 1.8rem; font-weight: 900; margin: 16px 0 8px; color: #000;">Mise en Page</h3>
                                    <p style="color: #666; font-family: sans-serif; line-height: 1.6;">Structure Ã©ditoriale inspirÃ©e des magazines.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'BRT') {
                // Brutal Modern - Industrial and raw
                siteHTML = `
                    <div style="background: ${background}; min-height: 600px; font-family: 'Arial Black', Arial, sans-serif;">
                        <nav style="padding: ${padding}; background: #000; color: white; border-bottom: 4px solid ${primary};">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 900; font-size: 1.8rem; letter-spacing: 2px;">BRUTAL</div>
                                <div style="display: flex; gap: ${gap}; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; font-weight: 900;">
                                    <a href="#" style="color: ${primary}; text-decoration: none;">Index</a>
                                    <a href="#" style="color: white; text-decoration: none;">Work</a>
                                    <a href="#" style="color: white; text-decoration: none;">Info</a>
                                </div>
                            </div>
                        </nav>
                        <section style="padding: 100px ${padding}; background: #000; color: white; border-bottom: 8px solid ${primary};">
                            <div style="max-width: 1000px; margin: 0 auto;">
                                <h1 style="font-size: 5rem; font-weight: 900; line-height: 0.9; margin-bottom: 24px; text-transform: uppercase; letter-spacing: -2px; color: ${primary}; text-shadow: 4px 4px 0 ${accent};">RAW<br/>BRUTAL<br/>MODERN</h1>
                                <p style="font-size: 1.2rem; color: #ccc; max-width: 600px; font-family: monospace; line-height: 1.8; margin-bottom: 40px;">
                                    > Design industriel audacieux<br/>
                                    > Formes brutes et angulaires<br/>
                                    > Contrastes forts et percutants
                                </p>
                                <button style="background: ${primary}; color: #000; padding: 20px 60px; border: 4px solid #000; border-radius: 0; font-size: 1.1rem; cursor: pointer; font-weight: 900; text-transform: uppercase; letter-spacing: 2px; box-shadow: 8px 8px 0 ${accent}; transition: all 0.1s;">
                                    ENTER
                                </button>
                            </div>
                        </section>
                        <section style="padding: ${padding}; max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap}; margin-top: 60px;">
                                <div style="background: #000; color: white; padding: ${padding}; border: 4px solid ${primary}; position: relative;">
                                    <div style="position: absolute; top: -20px; left: ${padding}; background: ${primary}; color: #000; padding: 8px 20px; font-weight: 900; font-size: 1.5rem;">01</div>
                                    <h3 style="font-size: 1.5rem; font-weight: 900; margin: 24px 0 12px; text-transform: uppercase; letter-spacing: 1px;">INDUSTRIAL</h3>
                                    <p style="color: #ccc; font-family: monospace; line-height: 1.6;">EsthÃ©tique brute et minimaliste</p>
                                </div>
                                <div style="background: #000; color: white; padding: ${padding}; border: 4px solid ${accent}; position: relative;">
                                    <div style="position: absolute; top: -20px; left: ${padding}; background: ${accent}; color: #000; padding: 8px 20px; font-weight: 900; font-size: 1.5rem;">02</div>
                                    <h3 style="font-size: 1.5rem; font-weight: 900; margin: 24px 0 12px; text-transform: uppercase; letter-spacing: 1px;">ANGULAR</h3>
                                    <p style="color: #ccc; font-family: monospace; line-height: 1.6;">Formes gÃ©omÃ©triques et angulaires</p>
                                </div>
                                <div style="background: #000; color: white; padding: ${padding}; border: 4px solid ${primary}; position: relative;">
                                    <div style="position: absolute; top: -20px; left: ${padding}; background: ${primary}; color: #000; padding: 8px 20px; font-weight: 900; font-size: 1.5rem;">03</div>
                                    <h3 style="font-size: 1.5rem; font-weight: 900; margin: 24px 0 12px; text-transform: uppercase; letter-spacing: 1px;">BOLD</h3>
                                    <p style="color: #ccc; font-family: monospace; line-height: 1.6;">Typographie audacieuse et forte</p>
                                </div>
                            </div>
                        </section>
                    </div>
                `;
            } else if (styleCode === 'RTF') {
                // Retro Future - Synthwave/Cyberpunk with more effects
                const rtfBg = manualOverrides.colors ? background : '#0a0a1a';
                const neonPink = '#ff00ff';
                const neonCyan = '#00ffff';
                siteHTML = `
                    <div style="background: linear-gradient(180deg, ${rtfBg} 0%, #1a0a2e 30%, #2e0a3e 60%, ${rtfBg} 100%); min-height: 600px; font-family: 'Orbitron', 'Courier New', monospace; color: #fff; position: relative; overflow: hidden;">
                        <!-- Grid scanlines -->
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: repeating-linear-gradient(0deg, transparent, transparent 2px, ${primary}08 2px, ${primary}08 4px); pointer-events: none; z-index: 1;"></div>

                        <!-- Animated neon orbs -->
                        <div style="position: absolute; width: 400px; height: 400px; background: radial-gradient(circle, ${primary}40 0%, transparent 70%); top: 10%; right: 10%; filter: blur(80px); animation: float 8s ease-in-out infinite; pointer-events: none; z-index: 2;"></div>
                        <div style="position: absolute; width: 350px; height: 350px; background: radial-gradient(circle, ${accent}30 0%, transparent 70%); bottom: 15%; left: 15%; filter: blur(70px); animation: float 6s ease-in-out infinite reverse; pointer-events: none; z-index: 2;"></div>
                        <div style="position: absolute; width: 300px; height: 300px; background: radial-gradient(circle, ${neonPink}25 0%, transparent 70%); top: 50%; left: 50%; transform: translate(-50%, -50%); filter: blur(90px); animation: pulse 4s ease-in-out infinite; pointer-events: none; z-index: 2;"></div>

                        <nav style="padding: ${padding}; background: rgba(0,0,0,0.85); backdrop-filter: blur(10px); border-bottom: 3px solid ${primary}; box-shadow: 0 0 30px ${primary}60, 0 4px 20px rgba(0,0,0,0.8); position: relative; z-index: 10;">
                            <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 900; font-size: 2rem; color: ${primary}; text-shadow: 0 0 10px ${primary}, 0 0 20px ${primary}, 0 0 30px ${primary}; letter-spacing: 6px; position: relative;">
                                    <span style="animation: glitch 3s infinite;">CYBERâ–ˆWAVE</span>
                                </div>
                                <div style="display: flex; gap: 30px; font-size: 0.95rem; font-weight: 700; letter-spacing: 3px;">
                                    <a href="#" style="color: ${primary}; text-decoration: none; text-shadow: 0 0 10px ${primary}; transition: all 0.3s; position: relative;" onmouseover="this.style.textShadow='0 0 20px ${primary}, 0 0 40px ${primary}'; this.style.color='${neonCyan}';" onmouseout="this.style.textShadow='0 0 10px ${primary}'; this.style.color='${primary}';">[ENTER]</a>
                                    <a href="#" style="color: ${accent}; text-decoration: none; text-shadow: 0 0 10px ${accent}; transition: all 0.3s;" onmouseover="this.style.textShadow='0 0 20px ${accent}, 0 0 40px ${accent}'; this.style.color='${neonPink}';" onmouseout="this.style.textShadow='0 0 10px ${accent}'; this.style.color='${accent}';">[ARCADE]</a>
                                    <a href="#" style="color: ${neonPink}; text-decoration: none; text-shadow: 0 0 10px ${neonPink}; transition: all 0.3s;" onmouseover="this.style.textShadow='0 0 20px ${neonPink}, 0 0 40px ${neonPink}';" onmouseout="this.style.textShadow='0 0 10px ${neonPink}';">[CREDITS]</a>
                                </div>
                            </div>
                        </nav>

                        <section style="padding: 140px ${padding}; text-align: center; position: relative; z-index: 5;">
                            <div style="font-size: 1rem; color: ${neonCyan}; text-transform: uppercase; letter-spacing: 6px; margin-bottom: 24px; text-shadow: 0 0 10px ${neonCyan}; animation: flicker 2s infinite; font-family: 'Courier New', monospace; font-weight: 700;">&gt;&gt; SYSTEM ONLINE // INITIALIZING &lt;&lt;</div>

                            <h1 style="font-size: 5.5rem; font-weight: 900; line-height: 0.95; margin-bottom: 32px; color: ${primary}; text-shadow: 0 0 20px ${primary}, 0 0 40px ${primary}, 0 0 60px ${primary}, 5px 5px 0 ${accent}; letter-spacing: 8px; position: relative;">
                                <span style="display: block; font-size: 2rem; color: ${neonPink}; text-shadow: 0 0 15px ${neonPink}, 0 0 30px ${neonPink}; margin-bottom: 16px; letter-spacing: 12px; font-weight: 700;">â–¼â–¼â–¼</span>
                                SYNTHWAVE<br/>
                                <span style="color: ${accent}; text-shadow: 0 0 20px ${accent}, 0 0 40px ${accent}, 0 0 60px ${accent}, 5px 5px 0 ${primary};">DREAMS</span>
                            </h1>

                            <p style="font-size: 1.25rem; color: #fff; max-width: 750px; margin: 0 auto 48px; text-shadow: 0 0 10px ${accent}; line-height: 1.9; font-weight: 500; font-family: 'Courier New', monospace;">
                                <span style="color: ${neonCyan}; text-shadow: 0 0 10px ${neonCyan};">[ SYNTHWAVE ]</span> Ã— <span style="color: ${neonPink}; text-shadow: 0 0 10px ${neonPink};">[ CYBERPUNK ]</span> Ã— <span style="color: ${primary}; text-shadow: 0 0 10px ${primary};">[ 80s VIBES ]</span><br/>
                                <span style="font-size: 1rem; color: ${accent}; letter-spacing: 3px;">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><br/>
                                NÃ©ons vibrants â€¢ GÃ©omÃ©trie futuriste â€¢ Nostalgie digitale
                            </p>

                            <button style="background: linear-gradient(135deg, ${primary} 0%, ${accent} 100%); color: #000; padding: 22px 70px; border: 4px solid ${neonPink}; border-radius: 0; font-size: 1.3rem; cursor: pointer; font-weight: 900; text-transform: uppercase; letter-spacing: 6px; box-shadow: 0 0 40px ${primary}80, 0 0 80px ${primary}40, inset 0 0 30px rgba(255,255,255,0.3); transition: all 0.3s; position: relative; font-family: 'Orbitron', sans-serif;" onmouseover="this.style.transform='translateY(-4px) scale(1.05)'; this.style.boxShadow='0 0 60px ${primary}, 0 0 100px ${primary}60, inset 0 0 40px rgba(255,255,255,0.5)'; this.style.borderColor='${neonCyan}';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 0 40px ${primary}80, 0 0 80px ${primary}40, inset 0 0 30px rgba(255,255,255,0.3)'; this.style.borderColor='${neonPink}';">
                                <span style="position: relative; z-index: 1;">â–¶ ENTER THE GRID</span>
                            </button>
                        </section>

                        <section style="padding: 60px ${padding}; max-width: 1200px; margin: 0 auto; position: relative; z-index: 5;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: ${gap};">
                                <!-- Card 1 -->
                                <div style="background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(10,10,26,0.9) 100%); padding: ${padding}; border: 3px solid ${primary}; box-shadow: 0 0 30px ${primary}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8); position: relative; transition: all 0.4s; overflow: hidden;" onmouseover="this.style.transform='translateY(-12px)'; this.style.borderColor='${neonCyan}'; this.style.boxShadow='0 0 50px ${primary}80, 0 0 100px ${primary}40, 0 16px 48px rgba(0,0,0,0.8)';" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='${primary}'; this.style.boxShadow='0 0 30px ${primary}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8)';">
                                    <!-- Corner decorations -->
                                    <div style="position: absolute; top: 12px; right: 12px; width: 50px; height: 50px; border: 3px solid ${primary}; transform: rotate(45deg); box-shadow: 0 0 15px ${primary}; transition: all 0.3s;"></div>
                                    <div style="position: absolute; bottom: 12px; left: 12px; width: 30px; height: 30px; border: 3px solid ${accent}; transform: rotate(45deg); box-shadow: 0 0 15px ${accent};"></div>

                                    <div style="font-size: 3.5rem; color: ${primary}; margin-bottom: 20px; text-shadow: 0 0 30px ${primary}; position: relative; z-index: 1;">â—¢</div>
                                    <h3 style="font-size: 1.4rem; font-weight: 900; margin-bottom: 16px; color: ${primary}; text-shadow: 0 0 15px ${primary}; letter-spacing: 3px; position: relative; z-index: 1; font-family: 'Orbitron', sans-serif;">NEON_AESTHETIC</h3>
                                    <p style="color: ${accent}; line-height: 1.7; text-shadow: 0 0 8px ${accent}; position: relative; z-index: 1; font-family: 'Courier New', monospace;">Couleurs nÃ©on vibrantes qui illuminent l'obscuritÃ©</p>
                                </div>

                                <!-- Card 2 -->
                                <div style="background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(10,10,26,0.9) 100%); padding: ${padding}; border: 3px solid ${accent}; box-shadow: 0 0 30px ${accent}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8); position: relative; transition: all 0.4s; overflow: hidden;" onmouseover="this.style.transform='translateY(-12px)'; this.style.borderColor='${neonPink}'; this.style.boxShadow='0 0 50px ${accent}80, 0 0 100px ${accent}40, 0 16px 48px rgba(0,0,0,0.8)';" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='${accent}'; this.style.boxShadow='0 0 30px ${accent}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8)';">
                                    <div style="position: absolute; top: 12px; right: 12px; width: 50px; height: 50px; border: 3px solid ${accent}; transform: rotate(45deg); box-shadow: 0 0 15px ${accent};"></div>
                                    <div style="position: absolute; bottom: 12px; left: 12px; width: 30px; height: 30px; border: 3px solid ${neonPink}; transform: rotate(45deg); box-shadow: 0 0 15px ${neonPink};"></div>

                                    <div style="font-size: 3.5rem; color: ${accent}; margin-bottom: 20px; text-shadow: 0 0 30px ${accent}; position: relative; z-index: 1;">â–²</div>
                                    <h3 style="font-size: 1.4rem; font-weight: 900; margin-bottom: 16px; color: ${accent}; text-shadow: 0 0 15px ${accent}; letter-spacing: 3px; position: relative; z-index: 1; font-family: 'Orbitron', sans-serif;">RETRO_WAVE</h3>
                                    <p style="color: ${neonPink}; line-height: 1.7; text-shadow: 0 0 8px ${neonPink}; position: relative; z-index: 1; font-family: 'Courier New', monospace;">EsthÃ©tique annÃ©es 80 rÃ©inventÃ©e pour le futur</p>
                                </div>

                                <!-- Card 3 -->
                                <div style="background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(10,10,26,0.9) 100%); padding: ${padding}; border: 3px solid ${neonPink}; box-shadow: 0 0 30px ${neonPink}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8); position: relative; transition: all 0.4s; overflow: hidden;" onmouseover="this.style.transform='translateY(-12px)'; this.style.borderColor='${neonCyan}'; this.style.boxShadow='0 0 50px ${neonPink}80, 0 0 100px ${neonPink}40, 0 16px 48px rgba(0,0,0,0.8)';" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='${neonPink}'; this.style.boxShadow='0 0 30px ${neonPink}50, 0 8px 32px rgba(0,0,0,0.6), inset 0 0 30px rgba(0,0,0,0.8)';">
                                    <div style="position: absolute; top: 12px; right: 12px; width: 50px; height: 50px; border: 3px solid ${neonPink}; transform: rotate(45deg); box-shadow: 0 0 15px ${neonPink};"></div>
                                    <div style="position: absolute; bottom: 12px; left: 12px; width: 30px; height: 30px; border: 3px solid ${primary}; transform: rotate(45deg); box-shadow: 0 0 15px ${primary};"></div>

                                    <div style="font-size: 3.5rem; color: ${neonPink}; margin-bottom: 20px; text-shadow: 0 0 30px ${neonPink}; position: relative; z-index: 1;">â—†</div>
                                    <h3 style="font-size: 1.4rem; font-weight: 900; margin-bottom: 16px; color: ${neonPink}; text-shadow: 0 0 15px ${neonPink}; letter-spacing: 3px; position: relative; z-index: 1; font-family: 'Orbitron', sans-serif;">GEOMETRY_GRID</h3>
                                    <p style="color: ${primary}; line-height: 1.7; text-shadow: 0 0 8px ${primary}; position: relative; z-index: 1; font-family: 'Courier New', monospace;">Formes gÃ©omÃ©triques et grilles infinies</p>
                                </div>
                            </div>
                        </section>

                        <style>
                            @keyframes glitch {
                                0%, 90%, 100% { transform: translate(0); }
                                92% { transform: translate(-2px, 2px); }
                                94% { transform: translate(2px, -2px); }
                                96% { transform: translate(-2px, -2px); }
                            }
                            @keyframes float {
                                0%, 100% { transform: translateY(0); }
                                50% { transform: translateY(-30px); }
                            }
                            @keyframes pulse {
                                0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
                                50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); }
                            }
                            @keyframes flicker {
                                0%, 100% { opacity: 1; }
                                50% { opacity: 0.8; }
                                75% { opacity: 0.95; }
                            }
                        </style>
                    </div>
                `;
            }

            return siteHTML;
        }

        // Copy Token
        function copyToken() {
            const token = document.getElementById('token-value').textContent;
            navigator.clipboard.writeText(token).then(() => {
                showAlert('Code copiÃ© !', 'Votre code de design a Ã©tÃ© copiÃ© dans le presse-papier. Conservez-le prÃ©cieusement.', 'success');
            });
        }

        // Load Token
        function loadToken() {
            showPrompt(
                'Charger un code de design',
                'Collez votre code de design pour charger votre configuration :',
                'info',
                (token) => {
                    if (token && parseToken(token)) {
                        updateUI();
                        currentStep = 1;
                        updateStepDisplay();
                        showAlert('Code chargÃ© avec succÃ¨s !', 'Votre configuration a Ã©tÃ© restaurÃ©e.', 'success');
                    } else if (token) {
                        showAlert('Code invalide', 'Le code que vous avez entrÃ© n\'est pas valide. Veuillez vÃ©rifier le format.', 'error');
                    }
                }
            );
        }

        // Validate Design
        function validateDesign() {
            const token = generateToken();
            const modal = document.getElementById('customModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalActions = document.getElementById('modalActions');
            const modalInputContainer = document.getElementById('modalInputContainer');

            modalIcon.className = 'modal-icon success';
            modalIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
            modalTitle.textContent = 'Configuration prÃªte !';
            modalBody.textContent = 'Votre design est configurÃ©. Que souhaitez-vous faire ?';
            modalInputContainer.innerHTML = '';

            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-secondary" onclick="openFullSiteDemo()">
                    <i class="fas fa-globe"></i> Voir le site d'exemple
                </button>
                <button class="modal-btn modal-btn-primary" onclick="copyToken(); closeModal();">
                    <i class="fas fa-copy"></i> Copier le code
                </button>
            `;

            modal.classList.add('active');
        }

        // Open Full Site Demo
        function openFullSiteDemo() {
            closeModal();

            // Generate complete HTML for the demo site
            const demoHTML = generateFullSiteDemo();

            // Create a blob URL and open in new tab
            const blob = new Blob([demoHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);

            window.open(url, '_blank');
        }

        // Close Full Site Demo
        function closeFullSite() {
            const modal = document.getElementById('fullSiteModal');
            const iframe = document.getElementById('fullSiteFrame');

            modal.classList.remove('active');

            // Clean up blob URL after animation
            setTimeout(() => {
                if (iframe.src.startsWith('blob:')) {
                    URL.revokeObjectURL(iframe.src);
                }
                iframe.src = '';
            }, 300);
        }

        // Generate Full Site Demo
        function generateFullSiteDemo() {
            const { style, colors, typography, settings } = designState;
            const { primary, background, accent } = colors;
            const { animations, radius, density, transitions, scroll } = settings;

            // Typography mapping
            const fonts = {
                'M1': { heading: 'Inter', body: 'Inter' },
                'M2': { heading: 'Roboto', body: 'Roboto' },
                'C1': { heading: 'Playfair Display', body: 'Source Sans Pro' },
                'C2': { heading: 'Montserrat', body: 'Open Sans' },
                'E1': { heading: 'Poppins', body: 'Poppins' },
                'E2': { heading: 'Nunito', body: 'Nunito' },
                'U1': { heading: 'Raleway', body: 'Lato' },
                'U2': { heading: 'Kaushan Script', body: 'Aref Ruqaa' }
            };

            const font = fonts[typography] || fonts['M1'];

            // Calculate values based on settings
            const borderRadius = radius === 1 ? '4px' : radius === 2 ? '12px' : '24px';
            const spacing = density === 1 ? '12px' : density === 2 ? '24px' : '40px';
            const transition = transitions === 1 ? 'none' : transitions === 2 ? 'all 0.2s ease' : 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';

            // Animation styles
            const animationCSS = animations === 0 ? `
                * { animation: none !important; }
            ` : animations === 1 ? `
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
            ` : `
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
                @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
                @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
            `;

            // Scroll behavior - we'll handle this with JavaScript for better iframe support
            const scrollBehavior = scroll === 1 ? 'auto' : 'smooth';
            const smoothScrollJS = scroll === 2 ? `
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const target = document.querySelector(this.getAttribute('href'));
                        if (target) {
                            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    });
                });

                // Scroll storytelling effect
                const storyItems = document.querySelectorAll('.story-item');
                const storyImage = document.querySelector('.story-image img');
                const storyImages = [
                    'https://picsum.photos/800/600?random=story1',
                    'https://picsum.photos/800/600?random=story2',
                    'https://picsum.photos/800/600?random=story3',
                    'https://picsum.photos/800/600?random=story4'
                ];

                if (storyItems.length > 0 && storyImage) {
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const index = parseInt(entry.target.dataset.index);
                                storyItems.forEach(item => item.classList.remove('active'));
                                entry.target.classList.add('active');
                                storyImage.style.opacity = '0';
                                setTimeout(() => {
                                    storyImage.src = storyImages[index];
                                    storyImage.style.opacity = '1';
                                }, 200);
                            }
                        });
                    }, { threshold: 0.5 });

                    storyItems.forEach(item => observer.observe(item));
                }
            ` : '';

            // CSS for scroll storytelling section
            const scrollStoryCSS = scroll === 2 ? `
                .scroll-story {
                    display: flex;
                    min-height: 100vh;
                    position: relative;
                }

                .story-image {
                    flex: 1;
                    position: sticky;
                    top: 0;
                    height: 100vh;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: ${spacing};
                }

                .story-image img {
                    max-width: 100%;
                    max-height: 80vh;
                    object-fit: cover;
                    border-radius: ${borderRadius};
                    transition: opacity 0.4s ease;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                }

                .story-content {
                    flex: 1;
                    display: flex;
                    flex-direction: column;
                }

                .story-item {
                    min-height: 100vh;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    padding: calc(${spacing} * 3);
                    opacity: 0.3;
                    transition: opacity 0.5s ease;
                }

                .story-item.active {
                    opacity: 1;
                }

                .story-item h3 {
                    font-size: 2rem;
                    margin-bottom: ${spacing};
                    color: ${primary};
                }

                .story-item p {
                    font-size: 1.125rem;
                    line-height: 1.8;
                }

                @media (max-width: 768px) {
                    .scroll-story {
                        flex-direction: column;
                    }
                    .story-image {
                        position: relative;
                        height: 50vh;
                    }
                    .story-item {
                        min-height: 50vh;
                    }
                }
            ` : '';

            // HTML for scroll storytelling section
            const scrollStoryHTML = scroll === 2 ? `
                <section class="scroll-story" id="histoire">
                    <div class="story-image">
                        <img src="https://picsum.photos/800/600?random=story1" alt="Histoire">
                    </div>
                    <div class="story-content">
                        <div class="story-item active" data-index="0">
                            <h3>Notre Vision</h3>
                            <p>Nous croyons en un web accessible Ã  tous, oÃ¹ chaque entreprise peut avoir une prÃ©sence digitale Ã  la hauteur de ses ambitions. Notre Ã©quipe met son expertise au service de vos projets.</p>
                        </div>
                        <div class="story-item" data-index="1">
                            <h3>Notre Expertise</h3>
                            <p>Avec des annÃ©es d'expÃ©rience dans le dÃ©veloppement web et le design, nous maÃ®trisons les derniÃ¨res technologies pour crÃ©er des sites performants et esthÃ©tiques.</p>
                        </div>
                        <div class="story-item" data-index="2">
                            <h3>Notre Approche</h3>
                            <p>Chaque projet est unique. Nous prenons le temps de comprendre vos besoins pour proposer des solutions sur mesure qui correspondent Ã  votre identitÃ©.</p>
                        </div>
                        <div class="story-item" data-index="3">
                            <h3>Votre SuccÃ¨s</h3>
                            <p>Votre rÃ©ussite est notre prioritÃ©. Nous vous accompagnons Ã  chaque Ã©tape, de la conception au lancement, et au-delÃ  avec un support continu.</p>
                        </div>
                    </div>
                </section>
            ` : '';

            // Determine if background is dark
            const isDarkBg = getLuminance(background) < 0.5;
            const textColor = isDarkBg ? '#ffffff' : '#1a1a1a';
            const textSecondary = isDarkBg ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.6)';

            // Style-specific adjustments
            let cardBg, cardBorder, navBg, navStyle;

            if (style === 'GLS') {
                cardBg = 'rgba(255,255,255,0.1)';
                cardBorder = 'rgba(255,255,255,0.2)';
                navBg = 'rgba(255,255,255,0.1)';
                navStyle = 'backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);';
            } else if (style === 'LUX') {
                cardBg = isDarkBg ? `${background}E6` : '#ffffff';
                cardBorder = isDarkBg ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)';
                navBg = isDarkBg ? background : '#ffffff';
                navStyle = `box-shadow: 0 4px 24px rgba(0,0,0,${isDarkBg ? '0.3' : '0.1'});`;
            } else if (style === 'BRT') {
                cardBg = isDarkBg ? `${background}E6` : '#ffffff';
                cardBorder = 'transparent';
                navBg = isDarkBg ? background : '#ffffff';
                navStyle = 'border-bottom: 3px solid ' + primary + ';';
            } else { // RTF
                cardBg = isDarkBg ? `${background}E6` : '#ffffff';
                cardBorder = isDarkBg ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)';
                navBg = isDarkBg ? background : '#ffffff';
                navStyle = 'box-shadow: 0 2px 8px rgba(0,0,0,0.05);';
            }

            return `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site d'exemple - ${style}</title>
    <link href="https://fonts.googleapis.com/css2?family=${font.heading.replace(' ', '+')}:wght@400;600;700;900&family=${font.body.replace(' ', '+')}:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: ${scrollBehavior};
        }

        body {
            font-family: '${font.body}', sans-serif;
            background: ${background};
            color: ${textColor};
            line-height: 1.6;
            overflow-x: hidden;
        }

        ${animationCSS}

        ${scrollStoryCSS}

        h1, h2, h3, h4, h5, h6 {
            font-family: '${font.heading}', sans-serif;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: ${navBg};
            ${navStyle}
            padding: ${spacing};
            z-index: 1000;
            transition: ${transition};
        }

        .nav-content {
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 900;
            color: ${primary};
            text-decoration: none;
            transition: ${transition};
        }

        .nav-links {
            display: flex;
            gap: calc(${spacing} * 1.5);
            list-style: none;
        }

        .nav-links a {
            color: ${textColor};
            text-decoration: none;
            font-weight: 500;
            transition: ${transition};
            padding: 8px 16px;
            border-radius: ${borderRadius};
        }

        .nav-links a:hover {
            color: ${primary};
            background: ${style === 'GLS' ? 'rgba(255,255,255,0.1)' : primary + '15'};
            ${animations >= 2 ? 'transform: translateY(-2px);' : ''}
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: calc(${spacing} * 4) ${spacing};
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, ${primary}20 0%, transparent 70%);
            ${animations >= 2 ? 'animation: float 6s ease-in-out infinite;' : ''}
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            ${animations >= 1 ? 'animation: fadeIn 1s ease;' : ''}
        }

        .hero h1 {
            font-size: clamp(2.5rem, 5vw, 4.5rem);
            margin-bottom: ${spacing};
            color: ${textColor};
            ${animations >= 1 ? 'animation: slideUp 1s ease;' : ''}
        }

        .hero p {
            font-size: 1.25rem;
            color: ${textSecondary};
            margin-bottom: calc(${spacing} * 2);
            ${animations >= 1 ? 'animation: slideUp 1s ease 0.2s both;' : ''}
        }

        .btn {
            display: inline-block;
            padding: ${density === 1 ? '12px 24px' : density === 2 ? '16px 32px' : '20px 40px'};
            background: ${primary};
            color: white;
            text-decoration: none;
            border-radius: ${borderRadius};
            font-weight: 600;
            transition: ${transition};
            border: none;
            cursor: pointer;
            font-size: 1rem;
            ${animations >= 1 ? 'animation: slideUp 1s ease 0.4s both;' : ''}
        }

        .btn:hover {
            background: ${accent};
            ${animations >= 2 ? 'transform: translateY(-4px); box-shadow: 0 8px 24px ' + primary + '40;' : ''}
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid ${primary};
            color: ${primary};
            margin-left: ${spacing};
        }

        .btn-secondary:hover {
            background: ${primary};
            color: white;
        }

        /* Sections */
        section {
            padding: calc(${spacing} * 4) 60px;
            max-width: 1800px;
            margin: 0 auto;
        }

        .section-title {
            font-size: clamp(2rem, 4vw, 3rem);
            text-align: center;
            margin-bottom: calc(${spacing} * 2);
            color: ${textColor};
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.125rem;
            color: ${textSecondary};
            max-width: 600px;
            margin: 0 auto calc(${spacing} * 3);
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: ${spacing};
        }

        .feature-card {
            background: ${cardBg};
            padding: calc(${spacing} * 1.5);
            border-radius: ${borderRadius};
            border: 1px solid ${cardBorder};
            transition: ${transition};
            ${style === 'GLS' ? 'backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);' : ''}
            ${style === 'LUX' ? 'box-shadow: 0 8px 32px rgba(0,0,0,' + (isDarkBg ? '0.3' : '0.1') + ');' : ''}
        }

        .feature-card:hover {
            ${animations >= 1 ? 'transform: translateY(-8px);' : ''}
            ${style === 'LUX' ? 'box-shadow: 0 16px 48px rgba(0,0,0,' + (isDarkBg ? '0.4' : '0.15') + ');' : ''}
            border-color: ${primary};
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: ${spacing};
            color: ${primary};
            ${animations === 2 ? 'animation: pulse 2s ease-in-out infinite;' : ''}
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: calc(${spacing} * 0.5);
            color: ${textColor};
        }

        .feature-card p {
            color: ${textSecondary};
            line-height: 1.6;
        }

        /* Gallery */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: ${spacing};
        }

        .gallery-item {
            height: 300px;
            border-radius: ${borderRadius};
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: ${transition};
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: ${transition};
        }

        .gallery-item:hover img {
            ${animations >= 1 ? 'transform: scale(1.1);' : ''}
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, ${primary}DD 0%, transparent 100%);
            display: flex;
            align-items: flex-end;
            padding: ${spacing};
            opacity: 0;
            transition: ${transition};
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-overlay h3 {
            color: white;
            font-size: 1.25rem;
        }

        /* Contact Form */
        .contact-form {
            max-width: 600px;
            margin: 0 auto;
            background: ${cardBg};
            padding: calc(${spacing} * 2);
            border-radius: ${borderRadius};
            border: 1px solid ${cardBorder};
            ${style === 'GLS' ? 'backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);' : ''}
            ${style === 'LUX' ? 'box-shadow: 0 8px 32px rgba(0,0,0,' + (isDarkBg ? '0.3' : '0.1') + ');' : ''}
        }

        .form-group {
            margin-bottom: ${spacing};
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: ${textColor};
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: ${density === 1 ? '8px 12px' : density === 2 ? '12px 16px' : '16px 20px'};
            border: 1px solid ${cardBorder};
            border-radius: ${borderRadius};
            background: ${isDarkBg ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.02)'};
            color: ${textColor};
            font-family: '${font.body}', sans-serif;
            font-size: 1rem;
            transition: ${transition};
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: ${primary};
            ${style === 'GLS' ? 'box-shadow: 0 0 0 3px ' + primary + '20;' : ''}
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Footer */
        footer {
            background: ${navBg};
            ${navStyle}
            padding: calc(${spacing} * 3) ${spacing};
            margin-top: calc(${spacing} * 4);
        }

        .footer-content {
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: ${spacing};
        }

        .footer-section h3 {
            margin-bottom: ${spacing};
            color: ${primary};
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 8px;
        }

        .footer-section a {
            color: ${textSecondary};
            text-decoration: none;
            transition: ${transition};
        }

        .footer-section a:hover {
            color: ${primary};
        }

        .footer-bottom {
            text-align: center;
            margin-top: calc(${spacing} * 2);
            padding-top: ${spacing};
            border-top: 1px solid ${cardBorder};
            color: ${textSecondary};
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-content">
            <a href="#" class="logo">Votre Site</a>
            <ul class="nav-links">
                <li><a href="#accueil">Accueil</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#galerie">Galerie</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <section class="hero" id="accueil">
        <div class="hero-content">
            <h1>Bienvenue sur votre site</h1>
            <p>DÃ©couvrez notre plateforme innovante conÃ§ue avec le style ${style} et des couleurs soigneusement choisies pour une expÃ©rience utilisateur optimale.</p>
            <div>
                <a href="#services" class="btn">DÃ©couvrir</a>
                <a href="#contact" class="btn btn-secondary">Nous contacter</a>
            </div>
        </div>
    </section>

    ${scrollStoryHTML}

    <section id="services">
        <h2 class="section-title">Nos Services</h2>
        <p class="section-subtitle">Des solutions adaptÃ©es Ã  vos besoins avec une interface moderne et accessible</p>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">ðŸš€</div>
                <h3>Performance</h3>
                <p>Une expÃ©rience ultra-rapide grÃ¢ce Ã  une architecture optimisÃ©e et moderne.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ðŸŽ¨</div>
                <h3>Design</h3>
                <p>Une interface Ã©lÃ©gante qui s'adapte Ã  votre identitÃ© visuelle avec ${radius === 1 ? 'des angles nets' : radius === 2 ? 'des coins arrondis' : 'des formes douces'}.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">â™¿</div>
                <h3>AccessibilitÃ©</h3>
                <p>Un contraste optimal garantissant une lisibilitÃ© parfaite pour tous les utilisateurs.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ðŸ“±</div>
                <h3>Responsive</h3>
                <p>Une expÃ©rience fluide sur tous les appareils, du mobile au desktop.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">âš¡</div>
                <h3>InteractivitÃ©</h3>
                <p>Des animations ${animations === 0 ? 'dÃ©sactivÃ©es pour plus de sobriÃ©tÃ©' : animations === 1 ? 'subtiles' : 'fluides et engageantes'}.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ðŸ”’</div>
                <h3>SÃ©curitÃ©</h3>
                <p>Vos donnÃ©es sont protÃ©gÃ©es grÃ¢ce Ã  des protocoles de sÃ©curitÃ© avancÃ©s.</p>
            </div>
        </div>
    </section>

    <section id="galerie">
        <h2 class="section-title">Notre Galerie</h2>
        <p class="section-subtitle">DÃ©couvrez quelques-unes de nos rÃ©alisations</p>
        <div class="gallery">
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=1" alt="Projet 1" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 1</h3>
                </div>
            </div>
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=2" alt="Projet 2" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 2</h3>
                </div>
            </div>
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=3" alt="Projet 3" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 3</h3>
                </div>
            </div>
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=4" alt="Projet 4" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 4</h3>
                </div>
            </div>
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=5" alt="Projet 5" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 5</h3>
                </div>
            </div>
            <div class="gallery-item">
                <img src="https://picsum.photos/400/300?random=6" alt="Projet 6" loading="lazy">
                <div class="gallery-overlay">
                    <h3>Projet 6</h3>
                </div>
            </div>
        </div>
    </section>

    <section id="contact">
        <h2 class="section-title">Contactez-nous</h2>
        <p class="section-subtitle">Une question ? N'hÃ©sitez pas Ã  nous Ã©crire</p>
        <form class="contact-form" onsubmit="event.preventDefault(); alert('Formulaire d\\'exemple - aucune donnÃ©e n\\'est envoyÃ©e');">
            <div class="form-group">
                <label for="name">Nom complet</label>
                <input type="text" id="name" placeholder="Marie MÃ¼ller" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="marie@exemple.ch" required>
            </div>
            <div class="form-group">
                <label for="message">Message</label>
                <textarea id="message" placeholder="Votre message..." required></textarea>
            </div>
            <button type="submit" class="btn">Envoyer le message</button>
        </form>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Ã€ propos</h3>
                <p>Un site d'exemple crÃ©Ã© avec Alpstone Studio, dÃ©montrant le style ${style} avec des animations ${animations === 0 ? 'dÃ©sactivÃ©es' : animations === 1 ? 'subtiles' : 'avancÃ©es'} et un dÃ©filement ${scroll === 1 ? 'instantanÃ©' : 'fluide'}.</p>
            </div>
            <div class="footer-section">
                <h3>Liens rapides</h3>
                <ul>
                    <li><a href="#accueil">Accueil</a></li>
                    <li><a href="#services">Services</a></li>
                    <li><a href="#galerie">Galerie</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact</h3>
                <ul>
                    <li>Email: contact@votresite.ch</li>
                    <li>TÃ©l: +41 26 321 45 67</li>
                    <li>Adresse: 1700 Fribourg, Suisse</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Votre Site. Tous droits rÃ©servÃ©s. Design crÃ©Ã© avec Alpstone Studio.</p>
        </div>
    </footer>
    <script>${smoothScrollJS}<\/script>
</body>
</html>`;
        }

        // Replace alert and prompt calls
        function validateStep(step) {
            switch(step) {
                case 1:
                    if (!designState.style) {
                        showAlert('Style requis', 'Veuillez sÃ©lectionner un style visuel avant de continuer.', 'warning');
                        return false;
                    }
                    break;
                case 3:
                    if (!designState.typography) {
                        showAlert('Typographie requise', 'Veuillez sÃ©lectionner une typographie avant de continuer.', 'warning');
                        return false;
                    }
                    break;
            }
            return true;
        }
    </script>
</body>
</html>
