<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Concepteur de site - Créez l'identité visuelle de votre site web">
    <title>Concepteur de site | Alpstone Studio</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Roboto:wght@400;500;700&family=Playfair+Display:wght@400;700;900&family=Source+Sans+Pro:wght@400;600;700&family=Montserrat:wght@400;600;700;900&family=Open+Sans:wght@400;600;700&family=Poppins:wght@400;600;700;900&family=Nunito:wght@400;600;700;900&family=Raleway:wght@400;600;700;900&family=Lato:wght@400;700;900&family=Kaushan+Script&family=Aref+Ruqaa:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/png" sizes="32x32"
        href="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png">
    <style>
        :root {
            --primary-color: #438DD7;
            --primary-dark: #20375D;
            --text-dark: #1a1a1a;
            --text-light: rgba(0, 0, 0, 0.6);
            --bg-light: #f5f7fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
            min-height: 100vh;
        }

        /* When user disables animations, force-stop all CSS animations/transitions */
        .no-animations *,
        .no-animations *::before,
        .no-animations *::after {
            animation: none !important;
            transition: none !important;
            scroll-behavior: auto !important;
            will-change: auto !important;
        }

        /* Light animations: keep small, subtle transitions */
        .anim-light *,
        .anim-light *::before,
        .anim-light *::after {
            transition-duration: 150ms !important;
            transition-timing-function: ease !important;
            animation-duration: 300ms !important;
        }

        /* Tweak common interactions for light vs present */
        .anim-light .step-content.active { animation-duration: 0.2s !important; }
        .anim-present .step-content.active { animation-duration: 0.4s !important; }

        .anim-light .back-button:hover { transform: translateX(-2px) !important; }
        .anim-present .back-button:hover { transform: translateX(-4px) !important; }

        .anim-light .step.active .step-number { transform: scale(1.04) !important; }
        .anim-present .step.active .step-number { transform: scale(1.08) !important; }

        /* Present animations: full experience */
        .anim-present *,
        .anim-present *::before,
        .anim-present *::after {
            transition-duration: 300ms !important;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1) !important;
            animation-duration: 600ms !important;
        }

        /* Container principal */
        .onboarding-container {
            min-height: 100vh;
            padding: 90px 20px 110px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Header */
        .onboarding-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(67, 141, 215, 0.1);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            z-index: 1000;
        }

        .onboarding-logo {
            height: 36px;
            margin-right: 8px;
            vertical-align: middle;
        }

        .onboarding-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-dark);
            display: inline-block;
            vertical-align: middle;
        }

        .onboarding-subtitle {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 4px;
        }

        /* Back Button */
        .back-button {
            position: fixed;
            top: 12px;
            left: 16px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            border: 1px solid rgba(67, 141, 215, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s ease;
            z-index: 1001;
            line-height: 1;
        }

        .back-button:hover {
            background: rgba(67, 141, 215, 0.1);
            transform: translateX(-4px);
        }

        /* Step Indicator */
        .step-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(67, 141, 215, 0.15);
            border-radius: 50px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            user-select: none;
            -webkit-user-select: none;
        }

        .step-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #fff;
            border: 2px solid rgba(67, 141, 215, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .step.active .step-number {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.08);
        }

        .step.completed .step-number {
            background: var(--primary-dark);
            color: white;
            border-color: var(--primary-dark);
        }

        .step-label {
            font-size: 0.7rem;
            color: var(--text-light);
            font-weight: 500;
            user-select: none;
            -webkit-user-select: none;
            pointer-events: none;
        }

        .step.active .step-label {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Content Area */
        .onboarding-content {
            width: 100%;
            max-width: 1000px;
        }

        .content-main {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 48px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            min-height: 500px;
        }

        /* Step Content */
        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-dark);
        }

        .step-description {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: 32px;
            line-height: 1.6;
        }

        /* Style Grid */
        .style-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }

        .style-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px 20px 20px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .style-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
            border-color: rgba(67, 141, 215, 0.3);
        }

        .style-card.selected {
            border-color: var(--primary-color);
            background: rgba(67, 141, 215, 0.04);
            box-shadow: 0 0 0 3px rgba(67, 141, 215, 0.15);
        }

        .style-preview {
            width: 100%;
            height: 80px;
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Style Preview Animations */
        .style-preview-min {
            background: #ffffff;
            flex-direction: column;
            gap: 6px;
            border: 1px solid #e0e0e0;
        }

        .preview-header {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
        }

        .preview-card {
            width: 100%;
            height: 16px;
            background: #f5f5f5;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .style-preview-gls {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            gap: 10px;
        }

        .preview-glass-card {
            width: 40px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
        }

        .style-preview-sft {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            flex-direction: column;
            gap: 8px;
        }

        .preview-soft-card {
            width: 70%;
            height: 28px;
            background: #ffffff;
            border-radius: 14px;
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.2);
        }

        .preview-soft-btn {
            width: 40%;
            height: 18px;
            background: #4285F4;
            border-radius: 12px;
        }

        .style-preview-edt {
            background: #ffffff;
            flex-direction: column;
            gap: 8px;
            border: 3px solid #E91E63;
        }

        .preview-edt-header {
            width: 100%;
            height: 12px;
            border-top: 4px solid #E91E63;
        }

        .preview-edt-box {
            width: 60%;
            height: 35px;
            border: 3px solid #E91E63;
            border-radius: 4px;
        }

        .style-preview-lux {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            gap: 10px;
        }

        .preview-lux-card {
            width: 45px;
            height: 50px;
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 6px;
        }

        .preview-lux-accent {
            width: 20px;
            height: 20px;
            background: #D4AF37;
            border-radius: 50%;
        }

        .style-preview-brt {
            background: #000000;
            gap: 12px;
        }

        .preview-brt-box {
            width: 45px;
            height: 45px;
            background: #ffffff;
            border: 3px solid #FF5722;
            border-radius: 4px;
            box-shadow: 6px 6px 0 #FF5722;
        }

        .preview-brt-line {
            width: 25px;
            height: 4px;
            background: #FF5722;
        }

        .style-preview-rtf {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 100%);
            gap: 10px;
        }

        .preview-rtf-grid {
            width: 40px;
            height: 40px;
            border: 2px solid #9C27B0;
            border-radius: 4px;
            box-shadow: 0 0 15px rgba(156, 39, 176, 0.6);
        }

        .preview-rtf-glow {
            width: 15px;
            height: 15px;
            background: #9C27B0;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(156, 39, 176, 0.8);
        }

        .style-category {
            font-size: 0.75rem;
            color: var(--primary-color);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .style-name {
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 6px;
        }

        .style-description {
            font-size: 0.85rem;
            color: var(--text-light);
            line-height: 1.4;
        }

        .style-examples-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 6px 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .style-examples-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* Colors Section with Preview */
        .colors-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        @media (max-width: 768px) {
            .colors-section {
                grid-template-columns: 1fr;
            }
        }

        .colors-pickers {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .color-section {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            padding: 20px;
        }

        .color-role-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-dark);
        }

        .color-picker-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .custom-color-picker {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .custom-color-picker:hover {
            transform: scale(1.05);
        }

        .color-input {
            display: none;
        }

        .color-text-input {
            flex: 1;
            padding: 12px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-family: monospace;
            font-size: 1rem;
        }

        .color-text-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Color Preview Card */
        .color-preview-card {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 24px;
            min-height: 350px;
        }

        .color-preview-title {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 24px;
            text-align: center;
        }

        .color-mockup {
            background: var(--preview-bg, #ffffff);
            border-radius: 12px;
            padding: 20px;
            min-height: 280px;
        }

        .mockup-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .mockup-logo {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .mockup-links {
            display: flex;
            gap: 16px;
            font-size: 0.85rem;
        }

        .mockup-hero {
            text-align: center;
            padding: 24px 0;
        }

        .mockup-hero h2 {
            font-size: 1.4rem;
            margin-bottom: 8px;
        }

        .mockup-hero p {
            font-size: 0.9rem;
            margin-bottom: 16px;
            opacity: 0.7;
        }

        .mockup-btn {
            display: inline-block;
            padding: 10px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .mockup-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .mockup-card {
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .mockup-card-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            margin: 0 auto 8px;
        }

        .mockup-card-title {
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Typography Section */
        .typo-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        @media (max-width: 768px) {
            .typo-section {
                grid-template-columns: 1fr;
            }
        }

        .typo-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .typo-option {
            background: #ffffff;
            border-radius: 16px;
            padding: 20px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .typo-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            border-color: rgba(67, 141, 215, 0.3);
        }

        .typo-option.selected {
            border-color: var(--primary-color);
            background: rgba(67, 141, 215, 0.04);
        }

        .typo-sample {
            font-size: 2.5rem;
            font-weight: 600;
            min-width: 80px;
            text-align: center;
            user-select: none;
            -webkit-user-select: none;
        }

        .typo-info {
            flex: 1;
        }

        .typo-name {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .typo-desc {
            font-size: 0.85rem;
            color: var(--text-light);
            line-height: 1.4;
        }

        /* Typography Preview */
        .typo-preview-card {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 32px;
            min-height: 350px;
        }

        .typo-preview-title {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 28px;
            text-align: center;
        }

        .typo-preview-content {
            color: white;
            user-select: none;
            -webkit-user-select: none;
        }

        .typo-preview-content h1 {
            font-size: 2rem;
            margin-bottom: 16px;
            line-height: 1.2;
        }

        .typo-preview-content h2 {
            font-size: 1.4rem;
            margin-bottom: 12px;
            opacity: 0.9;
        }

        .typo-preview-content p {
            font-size: 1rem;
            line-height: 1.7;
            opacity: 0.8;
            margin-bottom: 16px;
        }

        .typo-preview-content .caption {
            font-size: 0.85rem;
            opacity: 0.6;
            font-style: italic;
        }

        /* Settings - Substeps */
        .substep-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 32px;
        }

        .substep-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(67, 141, 215, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .substep-dot.active {
            background: var(--primary-color);
            width: 32px;
            border-radius: 6px;
        }

        .substep-content {
            display: none;
        }

        .substep-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .substep-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
        }

        .substep-description {
            color: var(--text-light);
            margin-bottom: 28px;
            text-align: center;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .setting-options {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 32px;
        }

        .setting-option {
            padding: 16px 32px;
            border-radius: 12px;
            border: 2px solid rgba(0, 0, 0, 0.08);
            background: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .setting-option:hover {
            border-color: rgba(67, 141, 215, 0.3);
            transform: translateY(-2px);
        }

        .setting-option.selected {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Demo Preview Area */
        .demo-preview-area {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 32px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .demo-preview-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-bottom: 28px;
            text-align: center;
            line-height: 1.4;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .demo-preview-content {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            width: 100%;
        }

        /* Demo animations */
        .demo-radius-box {
            width: 180px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            transition: border-radius 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .demo-radius-box.sharp {
            border-radius: 4px;
        }

        .demo-radius-box.moderate {
            border-radius: 20px;
        }

        .demo-radius-box.soft {
            border-radius: 40px;
        }

        .demo-density-container {
            display: flex;
            flex-direction: column;
            transition: gap 0.5s ease;
            width: 100%;
            max-width: 280px;
        }

        .demo-density-container.compact {
            gap: 8px;
        }

        .demo-density-container.balanced {
            gap: 16px;
        }

        .demo-density-container.airy {
            gap: 28px;
        }

        .demo-density-item {
            background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
            border-radius: 8px;
            padding: 16px 20px;
            color: white;
            font-size: 0.9rem;
            transition: all 0.5s ease;
        }

        .demo-anim-container {
            display: flex;
            gap: 24px;
            align-items: center;
        }

        .demo-anim-btn {
            padding: 20px 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
        }

        .demo-anim-btn.anim-none {
            transition: none;
        }

        .demo-anim-btn.anim-light {
            transition: all 0.2s ease;
        }

        .demo-anim-btn.anim-light:hover {
            transform: translateY(-3px);
        }

        .demo-anim-btn.anim-present {
            transition: all 0.3s ease;
        }

        .demo-anim-btn.anim-present:hover {
            transform: translateY(-6px) scale(1.05);
            box-shadow: 0 16px 32px rgba(67, 141, 215, 0.4);
        }

        .demo-trans-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .demo-trans-box {
            width: 140px;
            height: 140px;
            background: var(--primary-color);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .demo-trans-box.instant {
            transition: transform 0s, background 0s;
        }

        .demo-trans-box.fluid {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), background 0.4s ease;
        }

        .demo-trans-box:hover {
            transform: rotate(180deg) scale(1.1);
            background: var(--primary-dark);
        }

        .demo-trans-hint {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Demo Scroll Standard - tout défile ensemble */
        .demo-scroll-standard {
            width: 100%;
            max-width: 420px;
            height: 280px;
            background: linear-gradient(180deg, #000000 0%, #0a0a0a 100%);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .demo-scroll-standard-content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 30px;
            display: flex;
            align-items: flex-start;
            gap: 25px;
            animation: scrollStandardMove 6s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .demo-scroll-standard-image {
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .demo-scroll-standard-image i {
            font-size: 2.2rem;
            color: white;
        }

        .demo-scroll-standard-texts {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .demo-scroll-standard-text h4 {
            color: white;
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .demo-scroll-standard-text p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.75rem;
            line-height: 1.4;
        }

        @keyframes scrollStandardMove {

            0%,
            10% {
                transform: translateY(0);
            }

            45%,
            55% {
                transform: translateY(-120px);
            }

            90%,
            100% {
                transform: translateY(0);
            }
        }

        /* Demo Scroll Animé - Style Apple */
        .demo-scroll-animated {
            width: 100%;
            max-width: 420px;
            height: 280px;
            background: linear-gradient(180deg, #000000 0%, #0a0a0a 100%);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        /* Image carrée fixe au centre-gauche */
        .demo-scroll-image {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            z-index: 10;
        }

        .demo-scroll-image::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.3), transparent 50%);
            border-radius: 26px;
            z-index: -1;
            opacity: 0.5;
        }

        .demo-scroll-image i {
            font-size: 2.8rem;
            color: white;
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
        }

        /* Zone de texte à droite */
        .demo-scroll-text-area {
            position: absolute;
            right: 20px;
            top: 0;
            bottom: 0;
            width: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Container des textes qui défilent */
        .demo-scroll-texts {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Chaque bloc de texte */
        .demo-scroll-text {
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            transform: translateY(100px);
            opacity: 0;
            text-align: left;
            padding: 0 10px;
        }

        .demo-scroll-text h4 {
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .demo-scroll-text p {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            line-height: 1.5;
        }

        /* Animation séquentielle des textes - 12s total, 3 textes = 4s chacun */
        .demo-scroll-text:nth-child(1) {
            animation: textCycle 12s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .demo-scroll-text:nth-child(2) {
            animation: textCycle 12s cubic-bezier(0.4, 0, 0.2, 1) infinite 4s;
        }

        .demo-scroll-text:nth-child(3) {
            animation: textCycle 12s cubic-bezier(0.4, 0, 0.2, 1) infinite 8s;
        }

        @keyframes textCycle {

            /* Entrée par le bas */
            0% {
                opacity: 0;
                transform: translateY(60px);
                filter: blur(8px);
            }

            /* Arrivé au centre, visible */
            8%,
            25% {
                opacity: 1;
                transform: translateY(-50%);
                filter: blur(0);
            }

            /* Sortie vers le haut */
            33% {
                opacity: 0;
                transform: translateY(-150px);
                filter: blur(8px);
            }

            /* Reste invisible */
            100% {
                opacity: 0;
                transform: translateY(60px);
                filter: blur(8px);
            }
        }

        /* Indicateur de scroll subtil */
        .demo-scroll-indicator {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
        }

        .demo-scroll-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
        }

        .demo-scroll-dot:nth-child(1) {
            animation: dotPulse 12s infinite;
        }

        .demo-scroll-dot:nth-child(2) {
            animation: dotPulse 12s infinite 4s;
        }

        .demo-scroll-dot:nth-child(3) {
            animation: dotPulse 12s infinite 8s;
        }

        @keyframes dotPulse {

            0%,
            33% {
                background: rgba(255, 255, 255, 0.8);
                transform: scale(1.2);
            }

            34%,
            100% {
                background: rgba(255, 255, 255, 0.2);
                transform: scale(1);
            }
        }


        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 32px;
            gap: 16px;
        }

        .btn-nav {
            padding: 16px 40px;
            border-radius: 12px;
            border: 2px solid transparent;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-prev {
            background: transparent;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .btn-prev:hover {
            background: rgba(67, 141, 215, 0.1);
        }

        .btn-next {
            background: var(--primary-color);
            color: white;
        }

        .btn-next:hover {
            background: var(--primary-dark);
        }

        .btn-validate {
            background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%);
        }

        /* Welcome Screen */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .welcome-content {
            text-align: center;
            max-width: 600px;
            padding: 20px;
        }

        .welcome-screen .onboarding-logo {
            height: 80px;
            margin-bottom: 24px;
        }

        .welcome-screen .onboarding-title {
            font-size: 3rem;
            margin-bottom: 12px;
        }

        .welcome-screen .onboarding-subtitle {
            font-size: 1.2rem;
            margin-bottom: 32px;
        }

        .welcome-actions {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .welcome-btn {
            padding: 24px 32px;
            border-radius: 16px;
            border: none;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            width: 280px;
        }

        .welcome-btn i {
            font-size: 2.5rem;
        }

        .welcome-btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .welcome-btn-primary:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(67, 141, 215, 0.4);
        }

        .welcome-btn-secondary {
            background: white;
            color: var(--text-dark);
            border: 2px solid var(--primary-color);
        }

        .welcome-btn-secondary:hover {
            background: rgba(67, 141, 215, 0.1);
        }

        .welcome-btn-subtitle {
            font-size: 0.85rem;
            font-weight: 400;
            opacity: 0.8;
        }

        /* External Examples Modal */
        .examples-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            z-index: 3000;
            overflow-y: auto;
        }

        .examples-modal.active {
            display: block;
        }

        .examples-modal-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        .examples-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .examples-modal-title {
            color: white;
            font-size: 2rem;
        }

        .examples-modal-close {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .examples-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
        }

        .example-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .example-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .example-card-content {
            padding: 24px;
        }

        .example-card h4 {
            color: var(--text-dark);
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .example-card p {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .example-card-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            text-decoration: none;
            font-weight: 600;
            border-radius: 10px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .example-card-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 141, 215, 0.4);
        }

        /* Full Screen Preview */
        .fullscreen-preview {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #1a1a1a;
            z-index: 5000;
            display: none;
        }

        .fullscreen-preview.active {
            display: block;
        }

        .preview-iframe-fullscreen {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Floating Toolbar - Style Step Indicator */
        .floating-toolbar {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 5001;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            gap: 16px;
        }

        .toolbar-tabs {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(67, 141, 215, 0.15);
            border-radius: 50px;
            padding: 12px 20px;
            display: flex;
            gap: 8px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            scrollbar-width: none;
        }

        .toolbar-tabs::-webkit-scrollbar {
            display: none;
        }

        .toolbar-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 4px 8px;
            border-radius: 12px;
            user-select: none;
            -webkit-user-select: none;
        }

        .toolbar-tab:hover {
            background: rgba(67, 141, 215, 0.05);
        }

        .toolbar-tab-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #fff;
            border: 2px solid rgba(67, 141, 215, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            font-size: 0.95rem;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .toolbar-tab.active .toolbar-tab-icon {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.08);
        }

        .toolbar-tab-label {
            font-size: 0.7rem;
            color: var(--text-light);
            font-weight: 500;
            white-space: nowrap;
            user-select: none;
            -webkit-user-select: none;
            pointer-events: none;
        }

        .toolbar-tab.active .toolbar-tab-label {
            color: var(--primary-color);
            font-weight: 600;
        }

        .toolbar-panel {
            display: none;
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(67, 141, 215, 0.15);
            border-radius: 20px;
            padding: 20px 24px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);
            animation: panelSlideUp 0.3s ease;
            max-width: 90vw;
        }

        .toolbar-panel-close {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            color: var(--text-light);
            transition: all 0.2s ease;
            background: rgba(0, 0, 0, 0.05);
            z-index: 10;
        }

        .toolbar-panel-close:hover {
            background: rgba(0, 0, 0, 0.1);
            color: var(--text-dark);
        }

        .toolbar-panel.active {
            display: block;
        }

        @keyframes panelSlideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .toolbar-panel-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .toolbar-colors-grid {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .toolbar-color-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .toolbar-color {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            cursor: pointer;
            padding: 0;
            transition: all 0.3s ease;
        }

        .toolbar-color:hover {
            transform: scale(1.1);
            border-color: var(--primary-color);
        }

        .toolbar-color-label {
            font-size: 0.65rem;
            color: var(--text-light);
        }

        .toolbar-select {
            background: white;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 10px 16px;
            color: var(--text-dark);
            font-size: 0.9rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .toolbar-select:hover {
            border-color: var(--primary-color);
        }

        .toolbar-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .toolbar-btn-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            color: var(--text-dark);
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .toolbar-btn:hover {
            border-color: rgba(67, 141, 215, 0.3);
            transform: translateY(-2px);
        }

        /* Click / press animation: scale down on active/pressed */
        /* Click / press animation: scale down on active/pressed for all buttons */
        button:active,
        button.pressed,
        .btn:active,
        .btn.pressed,
        .toolbar-btn:active,
        .toolbar-btn.pressed,
        .modal-btn:active,
        .modal-btn.pressed,
        .toolbar-action:active,
        .toolbar-action.pressed,
        .style-examples-btn:active,
        .style-examples-btn.pressed,
        .style-card:active,
        .style-card.pressed,
        .example-card-btn:active,
        .example-card-btn.pressed {
            transform: scale(0.95) !important;
            transition: all 0.3s ease !important;
        }

        .toolbar-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .toolbar-actions {
            display: flex;
            gap: 12px;
        }

        .toolbar-action {
            padding: 12px 24px;
            background: var(--primary-color);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar-action:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .toolbar-close-btn {
            padding: 12px 24px;
            background: rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 12px;
            color: var(--text-dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .toolbar-close-btn:hover {
            background: #e74c3c;
            color: white;
        }

        .toolbar-divider {
            width: 1px;
            height: 30px;
            background: rgba(0, 0, 0, 0.1);
            margin: 0 8px;
            align-self: center;
        }

        .toolbar-direct-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            background: transparent;
            border: none;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            -webkit-user-select: none;
        }

        .toolbar-direct-btn i {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .toolbar-direct-btn.btn-copy i {
            background: var(--primary-color);
            color: white;
        }

        .toolbar-direct-btn.btn-copy:hover i {
            background: var(--primary-dark);
            transform: scale(1.08);
        }

        .toolbar-direct-btn.btn-close i {
            background: #e74c3c;
            color: white;
        }

        .toolbar-direct-btn.btn-close:hover i {
            background: #c0392b;
            transform: scale(1.08);
        }

        .toolbar-direct-btn span {
            color: var(--text-light);
        }

        /* Token Display */
        .token-display {
            background: var(--primary-dark);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-top: 24px;
        }

        .token-label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .token-value {
            font-family: monospace;
            font-size: 0.95rem;
            word-break: break-all;
            background: rgba(0, 0, 0, 0.2);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .token-actions {
            display: flex;
            gap: 12px;
        }

        .token-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .token-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Custom Modal */
        .custom-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 6000;
        }

        .custom-modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .modal-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .modal-icon.success {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
        }

        .modal-icon.error {
            background: rgba(244, 67, 54, 0.1);
            color: #F44336;
        }

        .modal-icon.info {
            background: rgba(67, 141, 215, 0.1);
            color: var(--primary-color);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-body {
            margin-bottom: 24px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .modal-input {
            width: 100%;
            padding: 14px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .modal-btn-primary:hover {
            background: var(--primary-dark);
        }

        .modal-btn-secondary {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-dark);
        }

        /* Color Picker Modal */
        .color-picker-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .color-picker-modal.active {
            display: flex;
        }

        .color-picker-content {
            background: white;
            border-radius: 24px;
            padding: 32px;
            max-width: 420px;
            width: 90%;
        }

        .color-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .color-picker-title {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .color-picker-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.05);
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .color-picker-close:hover {
            background: rgba(255, 0, 0, 0.1);
        }

        /* Google-style color picker - Saturation/Brightness area */
        .color-picker-sv-area {
            position: relative;
            width: 100%;
            height: 220px;
            border-radius: 12px;
            cursor: crosshair;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .color-picker-sv-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to right, #fff, transparent);
        }

        .color-picker-sv-area::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent, #000);
        }

        .sv-cursor {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.3), 0 2px 8px rgba(0, 0, 0, 0.3);
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 10;
        }

        /* Hue slider */
        .color-picker-hue-section {
            margin-bottom: 20px;
        }

        .hue-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 16px;
            border-radius: 8px;
            outline: none;
            cursor: pointer;
            background: linear-gradient(to right,
                    hsl(0, 100%, 50%),
                    hsl(60, 100%, 50%),
                    hsl(120, 100%, 50%),
                    hsl(180, 100%, 50%),
                    hsl(240, 100%, 50%),
                    hsl(300, 100%, 50%),
                    hsl(360, 100%, 50%));
        }

        .hue-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            border: 3px solid rgba(0, 0, 0, 0.2);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .hue-slider::-moz-range-thumb {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            border: 3px solid rgba(0, 0, 0, 0.2);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        /* Color preview and hex input */
        .color-picker-bottom {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .color-picker-preview {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 3px solid white;
        }

        .color-picker-hex-input {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }

        .color-picker-hex-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 141, 215, 0.1);
        }

        /* Color presets */
        .color-picker-section {
            margin-bottom: 20px;
        }

        .color-picker-label {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: block;
            color: #666;
        }

        .color-presets {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
        }

        .color-preset {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .color-preset:hover {
            transform: scale(1.1);
            border-color: rgba(0, 0, 0, 0.3);
        }

        .color-preset.selected {
            border-color: #333;
            box-shadow: 0 0 0 2px white, 0 0 0 4px #333;
        }

        /* Step 5: Preview Trigger */
        .preview-trigger {
            text-align: center;
            padding: 60px 20px;
        }

        .preview-trigger-icon {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 24px;
        }

        .preview-trigger h3 {
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        .preview-trigger p {
            color: var(--text-light);
            margin-bottom: 32px;
        }

        .preview-trigger-btn {
            padding: 20px 48px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preview-trigger-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(67, 141, 215, 0.4);
        }

        /* ============================================
           RESPONSIVE DESIGN - TABLETTES
           ============================================ */
        @media (max-width: 768px) {

            /* Header */
            .onboarding-title {
                font-size: 1.1rem;
            }

            .onboarding-subtitle {
                font-size: 0.75rem;
            }

            .onboarding-logo {
                height: 32px;
            }

            /* Content */
            .content-main {
                padding: 32px 24px;
            }

            .step-title {
                font-size: 1.6rem;
            }

            .step-description {
                font-size: 1rem;
            }

            /* Style grid */
            .style-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 12px;
            }

            /* Navigation buttons */
            .nav-buttons {
                gap: 12px;
            }

            .btn-nav {
                padding: 14px 28px;
                font-size: 0.95rem;
            }

            /* Step indicator */
            .step-indicator {
                padding: 10px 16px;
                gap: 8px;
            }

            .step-number {
                width: 32px;
                height: 32px;
            }

            .step-label {
                font-size: 0.65rem;
            }

            /* Toolbar */
            .toolbar-tabs {
                padding: 10px 16px;
                gap: 6px;
            }

            .toolbar-tab {
                padding: 4px 6px;
            }

            .toolbar-tab-icon {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }

            .toolbar-tab-label {
                font-size: 0.65rem;
            }

            .toolbar-panel {
                padding: 16px 20px;
                max-width: 95vw;
            }

            .toolbar-btn-group {
                gap: 6px;
            }

            .toolbar-btn {
                padding: 8px 14px;
                font-size: 0.8rem;
            }
        }

        /* ============================================
           RESPONSIVE DESIGN - MOBILE
           ============================================ */
        @media (max-width: 480px) {

            /* Container */
            .onboarding-container {
                padding: 80px 12px 100px;
            }

            /* Header */
            .onboarding-header {
                padding: 8px 12px;
            }

            .onboarding-title {
                font-size: 1rem;
                display: block;
            }

            .onboarding-subtitle {
                font-size: 0.7rem;
                margin-top: 2px;
            }

            .onboarding-logo {
                height: 28px;
                margin-right: 6px;
            }

            /* Back button - taille minimum 44px pour accessibilité */
            .back-button {
                width: 44px;
                height: 44px;
                top: 10px;
                left: 12px;
            }

            /* Content */
            .content-main {
                padding: 24px 16px;
                border-radius: 16px;
            }

            .step-title {
                font-size: 1.4rem;
                margin-bottom: 10px;
            }

            .step-description {
                font-size: 0.95rem;
                margin-bottom: 24px;
            }

            /* Style cards */
            .style-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .style-card {
                padding: 16px;
            }

            .style-preview {
                height: 70px;
                margin-bottom: 10px;
            }

            .style-category {
                font-size: 0.65rem;
            }

            .style-name {
                font-size: 0.95rem;
            }

            .style-description {
                font-size: 0.75rem;
            }

            /* Bouton exemples - taille minimum */
            .style-examples-btn {
                padding: 8px 14px;
                font-size: 0.7rem;
                min-height: 32px;
            }

            /* Colors section */
            .color-picker-wrapper {
                flex-direction: column;
                align-items: stretch;
            }

            .custom-color-picker {
                width: 100%;
                height: 50px;
            }

            .color-text-input {
                padding: 10px;
                font-size: 0.95rem;
            }

            .color-section {
                padding: 16px;
            }

            .color-role-title {
                font-size: 0.95rem;
                margin-bottom: 12px;
            }

            /* Color preview card */
            .color-preview-card {
                padding: 16px;
                min-height: 280px;
            }

            .mockup-nav {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }

            .mockup-links {
                gap: 12px;
                font-size: 0.8rem;
            }

            .mockup-hero h2 {
                font-size: 1.2rem;
            }

            .mockup-hero p {
                font-size: 0.85rem;
            }

            .mockup-btn {
                padding: 8px 20px;
                font-size: 0.8rem;
            }

            .mockup-cards {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            /* Typography */
            .typo-option {
                padding: 16px;
                gap: 16px;
            }

            .typo-sample {
                font-size: 2rem;
                min-width: 60px;
            }

            .typo-name {
                font-size: 0.95rem;
            }

            .typo-desc {
                font-size: 0.8rem;
            }

            .typo-preview-card {
                padding: 20px;
                min-height: 280px;
            }

            .typo-preview-content h1 {
                font-size: 1.6rem;
            }

            .typo-preview-content h2 {
                font-size: 1.2rem;
            }

            .typo-preview-content p {
                font-size: 0.95rem;
            }

            /* Settings */
            .substep-title {
                font-size: 1.3rem;
            }

            .substep-description {
                font-size: 0.9rem;
                margin-bottom: 20px;
            }

            .setting-options {
                flex-direction: column;
                gap: 10px;
            }

            .setting-option {
                padding: 12px 20px;
                font-size: 0.95rem;
                text-align: center;
                width: 100%;
            }

            .demo-preview-area {
                padding: 20px;
                min-height: 250px;
            }

            .demo-preview-label {
                font-size: 0.8rem;
                margin-bottom: 16px;
            }

            /* Navigation */
            .nav-buttons {
                flex-direction: column-reverse;
                gap: 10px;
            }

            .btn-nav {
                width: 100%;
                padding: 14px 24px;
                justify-content: center;
                min-height: 48px;
            }

            /* Step indicator */
            .step-indicator {
                bottom: 12px;
                padding: 8px 12px;
                gap: 6px;
                flex-wrap: wrap;
                max-width: 95%;
            }

            .step {
                gap: 2px;
            }

            .step-number {
                width: 28px;
                height: 28px;
                font-size: 0.85rem;
            }

            .step-label {
                font-size: 0.6rem;
            }

            /* Welcome screen */
            .welcome-screen .onboarding-title {
                font-size: 2rem;
            }

            .welcome-screen .onboarding-subtitle {
                font-size: 1rem;
                margin-bottom: 24px;
            }

            .welcome-screen .onboarding-logo {
                height: 60px;
                margin-bottom: 16px;
            }

            .welcome-actions {
                flex-direction: column;
                gap: 16px;
            }

            .welcome-btn {
                width: 100%;
                padding: 20px 24px;
                font-size: 1rem;
            }

            .welcome-btn i {
                font-size: 2rem;
            }

            .welcome-btn-subtitle {
                font-size: 0.8rem;
            }

            /* Examples modal */
            .examples-modal-content {
                padding: 40px 20px;
            }

            .examples-modal-title {
                font-size: 1.5rem;
            }

            .examples-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .example-card h4 {
                font-size: 1.1rem;
            }

            .example-card p {
                font-size: 0.85rem;
            }

            /* Toolbar floating */
            .floating-toolbar {
                bottom: 12px;
                gap: 12px;
            }

            .toolbar-tabs {
                padding: 8px 12px;
                gap: 4px;
                max-width: 95vw;
                overflow-x: auto;
            }

            .toolbar-tab {
                padding: 4px;
            }

            .toolbar-tab-icon {
                width: 28px;
                height: 28px;
                font-size: 0.75rem;
            }

            .toolbar-tab-label {
                font-size: 0.6rem;
            }

            .toolbar-panel {
                padding: 12px 16px;
                max-width: 95vw;
            }

            .toolbar-panel-title {
                font-size: 0.7rem;
                margin-bottom: 10px;
            }

            .toolbar-colors-grid {
                flex-wrap: wrap;
                gap: 10px;
            }

            .toolbar-color {
                width: 40px;
                height: 40px;
            }

            .toolbar-btn-group {
                gap: 6px;
            }

            .toolbar-btn {
                padding: 10px 14px;
                font-size: 0.75rem;
                flex: 1;
                min-width: fit-content;
            }

            .toolbar-select {
                width: 100%;
                padding: 10px 14px;
                font-size: 0.85rem;
            }

            .toolbar-actions {
                flex-direction: column;
                gap: 10px;
            }

            .toolbar-action,
            .toolbar-close-btn {
                width: 100%;
                justify-content: center;
                padding: 12px;
                font-size: 0.85rem;
            }

            /* Token display */
            .token-display {
                padding: 16px;
            }

            .token-label {
                font-size: 0.85rem;
            }

            .token-value {
                font-size: 0.85rem;
                padding: 12px;
            }

            .token-btn {
                padding: 12px;
                font-size: 0.9rem;
                min-height: 44px;
            }

            /* Preview trigger */
            .preview-trigger {
                padding: 40px 16px;
            }

            .preview-trigger-icon {
                font-size: 3rem;
                margin-bottom: 16px;
            }

            .preview-trigger h3 {
                font-size: 1.3rem;
                margin-bottom: 10px;
            }

            .preview-trigger p {
                font-size: 0.9rem;
                margin-bottom: 24px;
            }

            .preview-trigger-btn {
                padding: 16px 32px;
                font-size: 1rem;
                width: 100%;
                min-height: 52px;
            }

            /* Color picker modal */
            .color-picker-content {
                padding: 24px 16px;
                width: 95%;
            }

            .color-picker-title {
                font-size: 1.1rem;
            }

            .color-picker-preview {
                height: 60px;
                font-size: 0.95rem;
            }

            .color-presets {
                grid-template-columns: repeat(6, 1fr);
            }

            /* Modal */
            .modal-content {
                padding: 28px 20px;
                width: 95%;
            }

            .modal-title {
                font-size: 1.3rem;
            }

            .modal-body {
                font-size: 0.95rem;
            }

            .modal-btn {
                padding: 12px 20px;
                min-height: 44px;
            }

            /* Demo animations adaptées */
            .demo-radius-box {
                width: 140px;
                height: 100px;
                font-size: 0.9rem;
            }

            .demo-anim-btn {
                padding: 16px 28px;
                font-size: 0.95rem;
            }

            .demo-trans-box {
                width: 100px;
                height: 100px;
                font-size: 1.5rem;
            }

            .demo-trans-hint {
                font-size: 0.85rem;
            }

            .demo-scroll-standard,
            .demo-scroll-animated {
                max-width: 100%;
                height: 240px;
            }

            .demo-scroll-image {
                width: 90px;
                height: 90px;
                left: 20px;
            }

            .demo-scroll-image i {
                font-size: 2rem;
            }

            .demo-scroll-text-area {
                width: calc(100% - 130px);
                right: 15px;
            }

            .demo-scroll-text h4 {
                font-size: 0.95rem;
            }

            .demo-scroll-text p {
                font-size: 0.75rem;
            }

            .demo-scroll-standard-image {
                width: 80px;
                height: 80px;
            }

            .demo-scroll-standard-image i {
                font-size: 1.8rem;
            }

            .demo-scroll-standard-text h4 {
                font-size: 0.9rem;
            }

            .demo-scroll-standard-text p {
                font-size: 0.7rem;
            }
        }
    </style>
</head>

<body>
    <!-- Back Button -->
    <a href="index.html" class="back-button" title="Retour à l'accueil">
        <i class="fas fa-arrow-left"></i>
    </a>

    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <img src="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png" alt="Alpstone Studio"
                class="onboarding-logo">
            <h1 class="onboarding-title">Concepteur de site</h1>
            <p class="onboarding-subtitle">Trouvez l'inspiration parfaite pour votre projet</p>

            <div class="welcome-actions">
                <button class="welcome-btn welcome-btn-primary" onclick="startOnboarding()">
                    <i class="fas fa-paint-brush"></i>
                    <span>Créer mon design</span>
                    <span class="welcome-btn-subtitle">Commencer la création</span>
                </button>
                <button class="welcome-btn welcome-btn-secondary" onclick="showTokenInput()">
                    <i class="fas fa-key"></i>
                    <span>J'ai déjà un code</span>
                    <span class="welcome-btn-subtitle">Charger une configuration</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Modal -->
    <div class="custom-modal" id="customModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon" id="modalIcon"><i class="fas fa-info-circle"></i></div>
                <h3 class="modal-title" id="modalTitle">Titre</h3>
            </div>
            <div class="modal-body" id="modalBody">Message</div>
            <div id="modalInputContainer"></div>
            <div class="modal-actions" id="modalActions">
                <button class="modal-btn modal-btn-primary" id="modalConfirm">OK</button>
            </div>
        </div>
    </div>

    <!-- External Examples Modal -->
    <div class="examples-modal" id="examplesModal">
        <div class="examples-modal-content">
            <div class="examples-modal-header">
                <h2 class="examples-modal-title" id="examplesTitle">Sites d'inspiration</h2>
                <button class="examples-modal-close" onclick="closeExamples()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="examples-grid" id="examplesGrid"></div>
        </div>
    </div>

    <!-- Full Screen Preview -->
    <div class="fullscreen-preview" id="fullscreenPreview">
        <iframe class="preview-iframe-fullscreen" id="previewIframe"></iframe>
        <div class="floating-toolbar" id="floatingToolbar">
            <!-- Tabs Navigation -->
            <div class="toolbar-tabs">
                <div class="toolbar-tab" onclick="switchToolbarTab('colors')">
                    <div class="toolbar-tab-icon">
                        <i class="fas fa-palette"></i>
                    </div>
                    <div class="toolbar-tab-label">Couleurs</div>
                </div>
                <div class="toolbar-tab" onclick="switchToolbarTab('typo')">
                    <div class="toolbar-tab-icon">
                        <i class="fas fa-font"></i>
                    </div>
                    <div class="toolbar-tab-label">Typo</div>
                </div>
                <div class="toolbar-tab" onclick="switchToolbarTab('style')">
                    <div class="toolbar-tab-icon">
                        <i class="fas fa-shapes"></i>
                    </div>
                    <div class="toolbar-tab-label">Style</div>
                </div>
                <div class="toolbar-tab" onclick="switchToolbarTab('effects')">
                    <div class="toolbar-tab-icon">
                        <i class="fas fa-magic"></i>
                    </div>
                    <div class="toolbar-tab-label">Effets</div>
                </div>
                <!-- Boutons directs au lieu du menu Actions -->
                <div class="toolbar-divider"></div>
                <button class="toolbar-direct-btn btn-copy" onclick="copyToken()">
                    <i class="fas fa-copy"></i>
                    <span>Copier</span>
                </button>
                <button class="toolbar-direct-btn btn-close" onclick="closeFullscreenPreview()">
                    <i class="fas fa-times"></i>
                    <span>Fermer</span>
                </button>
            </div>

            <!-- Panels -->
            <!-- Colors Panel -->
            <!-- Colors Panel -->
            <div class="toolbar-panel" id="panel-colors">
                <div class="toolbar-panel-close" onclick="closeToolbarPanel()"><i class="fas fa-times"></i></div>
                <div class="toolbar-panel-title">Palette de couleurs</div>
                <div class="toolbar-colors-grid">
                    <div class="toolbar-color-item">
                        <div class="toolbar-color" id="toolbar-primary" onclick="openToolbarColorPicker('primary')">
                        </div>
                        <span class="toolbar-color-label">Principale</span>
                    </div>
                    <div class="toolbar-color-item">
                        <div class="toolbar-color" id="toolbar-bg" onclick="openToolbarColorPicker('background')"></div>
                        <span class="toolbar-color-label">Fond</span>
                    </div>
                    <div class="toolbar-color-item">
                        <div class="toolbar-color" id="toolbar-accent" onclick="openToolbarColorPicker('accent')"></div>
                        <span class="toolbar-color-label">Accent</span>
                    </div>
                </div>
            </div>

            <!-- Typography Panel -->
            <!-- Typography Panel -->
            <div class="toolbar-panel" id="panel-typo">
                <div class="toolbar-panel-close" onclick="closeToolbarPanel()"><i class="fas fa-times"></i></div>
                <div class="toolbar-panel-title">Style typographique</div>
                <select class="toolbar-select" id="toolbar-typo" onchange="updateFromToolbar()">
                    <option value="M1">Moderne & lisible</option>
                    <option value="M2">Élégant & premium</option>
                    <option value="M3">Expressif & créatif</option>
                    <option value="M4">Neutre & corporate</option>
                </select>
            </div>

            <!-- Style Panel -->
            <!-- Style Panel -->
            <div class="toolbar-panel" id="panel-style">
                <div class="toolbar-panel-close" onclick="closeToolbarPanel()"><i class="fas fa-times"></i></div>
                <div class="toolbar-panel-title">Arrondis</div>
                <div class="toolbar-btn-group">
                    <button class="toolbar-btn" data-setting="radius" data-value="1"
                        onclick="setToolbarSetting('radius', 1)">Nets</button>
                    <button class="toolbar-btn" data-setting="radius" data-value="2"
                        onclick="setToolbarSetting('radius', 2)">Modérés</button>
                    <button class="toolbar-btn active" data-setting="radius" data-value="3"
                        onclick="setToolbarSetting('radius', 3)">Doux</button>
                </div>

                <div class="toolbar-panel-title" style="margin-top: 16px;">Densité</div>
                <div class="toolbar-btn-group">
                    <button class="toolbar-btn" data-setting="density" data-value="1"
                        onclick="setToolbarSetting('density', 1)">Compacte</button>
                    <button class="toolbar-btn active" data-setting="density" data-value="2"
                        onclick="setToolbarSetting('density', 2)">Équilibrée</button>
                    <button class="toolbar-btn" data-setting="density" data-value="3"
                        onclick="setToolbarSetting('density', 3)">Aérée</button>
                </div>
            </div>

            <!-- Effects Panel -->
            <!-- Effects Panel -->
            <div class="toolbar-panel" id="panel-effects">
                <div class="toolbar-panel-close" onclick="closeToolbarPanel()"><i class="fas fa-times"></i></div>
                <div class="toolbar-panel-title">Animations</div>
                <div class="toolbar-btn-group">
                    <button class="toolbar-btn" data-setting="anim" data-value="0"
                        onclick="setToolbarSetting('anim', 0)">Aucune</button>
                    <button class="toolbar-btn" data-setting="anim" data-value="1"
                        onclick="setToolbarSetting('anim', 1)">Légères</button>
                    <button class="toolbar-btn active" data-setting="anim" data-value="2"
                        onclick="setToolbarSetting('anim', 2)">Présentes</button>
                </div>

                <div class="toolbar-panel-title" style="margin-top: 16px;">Scroll animé</div>
                <div class="toolbar-btn-group">
                    <button class="toolbar-btn active" data-setting="scroll" data-value="1"
                        onclick="setToolbarSetting('scroll', 1)">Normal</button>
                    <button class="toolbar-btn" data-setting="scroll" data-value="2"
                        onclick="setToolbarSetting('scroll', 2)">Cinématique</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="onboarding-container" id="onboardingContainer" style="display: none;">
        <!-- Header -->
        <div class="onboarding-header">
            <div>
                <img src="Logos/Alpstone-studio-vertical/Transparent-background-vertical.png" alt="Alpstone Studio"
                    class="onboarding-logo">
                <h1 class="onboarding-title">Concepteur de site</h1>
                <p class="onboarding-subtitle">Trouvez l'inspiration parfaite pour votre projet</p>
            </div>
        </div>

        <!-- Content -->
        <div class="onboarding-content">
            <div class="content-main">
                <!-- Step 1: Style Selection -->
                <div class="step-content active" data-step="1">
                    <h2 class="step-title">Choisissez votre inspiration</h2>
                    <p class="step-description">Sélectionnez l'inspiration qui correspond le mieux à votre vision. Ces
                        styles serviront de base pour créer votre design unique.</p>

                    <div class="style-grid">
                        <div class="style-card" data-style="MIN" data-category="Classique">
                            <button class="style-examples-btn" onclick="showExamples('MIN', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-min">
                                <div class="preview-header"></div>
                                <div class="preview-card"></div>
                                <div class="preview-card"></div>
                            </div>
                            <div class="style-category">Classique</div>
                            <div class="style-name">Minimaliste</div>
                            <div class="style-description">Épuré et moderne</div>
                        </div>

                        <div class="style-card" data-style="GLS" data-category="Moderne">
                            <button class="style-examples-btn" onclick="showExamples('GLS', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-gls">
                                <div class="preview-glass-card"></div>
                                <div class="preview-glass-card"></div>
                            </div>
                            <div class="style-category">Moderne</div>
                            <div class="style-name">Verre Moderne</div>
                            <div class="style-description">Transparences premium</div>
                        </div>

                        <div class="style-card" data-style="SFT" data-category="Classique">
                            <button class="style-examples-btn" onclick="showExamples('SFT', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-sft">
                                <div class="preview-soft-card"></div>
                                <div class="preview-soft-btn"></div>
                            </div>
                            <div class="style-category">Classique</div>
                            <div class="style-name">Doux</div>
                            <div class="style-description">Doux et arrondi</div>
                        </div>

                        <div class="style-card" data-style="EDT" data-category="Audacieux">
                            <button class="style-examples-btn" onclick="showExamples('EDT', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-edt">
                                <div class="preview-edt-header"></div>
                                <div class="preview-edt-box"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Éditorial</div>
                            <div class="style-description">Coloré et expressif</div>
                        </div>

                        <div class="style-card" data-style="LUX" data-category="Premium">
                            <button class="style-examples-btn" onclick="showExamples('LUX', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-lux">
                                <div class="preview-lux-card"></div>
                                <div class="preview-lux-accent"></div>
                            </div>
                            <div class="style-category">Premium</div>
                            <div class="style-name">Luxe</div>
                            <div class="style-description">Élégance sombre</div>
                        </div>

                        <div class="style-card" data-style="BRT" data-category="Audacieux">
                            <button class="style-examples-btn" onclick="showExamples('BRT', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-brt">
                                <div class="preview-brt-box"></div>
                                <div class="preview-brt-line"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Brutaliste</div>
                            <div class="style-description">Industriel audacieux</div>
                        </div>

                        <div class="style-card" data-style="RTF" data-category="Audacieux">
                            <button class="style-examples-btn" onclick="showExamples('RTF', event)">
                                <i class="fas fa-external-link-alt"></i> Voir exemples
                            </button>
                            <div class="style-preview style-preview-rtf">
                                <div class="preview-rtf-grid"></div>
                                <div class="preview-rtf-glow"></div>
                            </div>
                            <div class="style-category">Audacieux</div>
                            <div class="style-name">Rétro Futur</div>
                            <div class="style-description">Néons et géométrie</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Colors -->
                <div class="step-content" data-step="2">
                    <h2 class="step-title">Définissez vos couleurs</h2>
                    <p class="step-description">Choisissez les couleurs principales de votre identité visuelle</p>

                    <div class="colors-section">
                        <div class="colors-pickers">
                            <div class="color-section">
                                <h3 class="color-role-title">Couleur Principale</h3>
                                <div class="color-picker-wrapper">
                                    <div class="custom-color-picker" id="picker-primary" data-color-type="primary"
                                        style="background-color: #438DD7;" onclick="openColorPicker('primary')"></div>
                                    <input type="color" id="color-primary" class="color-input" value="#438DD7">
                                    <input type="text" id="color-primary-text" class="color-text-input" value="#438DD7">
                                </div>
                            </div>

                            <div class="color-section">
                                <h3 class="color-role-title">Couleur d'Arrière-plan</h3>
                                <div class="color-picker-wrapper">
                                    <div class="custom-color-picker" id="picker-background" data-color-type="background"
                                        style="background-color: #FFFFFF;" onclick="openColorPicker('background')">
                                    </div>
                                    <input type="color" id="color-background" class="color-input" value="#FFFFFF">
                                    <input type="text" id="color-background-text" class="color-text-input"
                                        value="#FFFFFF">
                                </div>
                            </div>

                            <div class="color-section">
                                <h3 class="color-role-title">Couleur d'Accent</h3>
                                <div class="color-picker-wrapper">
                                    <div class="custom-color-picker" id="picker-accent" data-color-type="accent"
                                        style="background-color: #20375D;" onclick="openColorPicker('accent')"></div>
                                    <input type="color" id="color-accent" class="color-input" value="#20375D">
                                    <input type="text" id="color-accent-text" class="color-text-input" value="#20375D">
                                </div>
                            </div>
                        </div>

                        <div class="color-preview-card">
                            <div class="color-preview-title">Aperçu de votre palette</div>
                            <div class="color-mockup" id="colorMockup">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Typography -->
                <div class="step-content" data-step="3">
                    <h2 class="step-title">Style typographique</h2>
                    <p class="step-description">Sélectionnez l'ambiance typographique de votre site</p>

                    <div class="typo-section">
                        <div class="typo-options">
                            <div class="typo-option" data-typo="M1">
                                <div class="typo-sample" style="font-family: 'Inter', sans-serif;">Aa</div>
                                <div class="typo-info">
                                    <div class="typo-name">Moderne & lisible</div>
                                    <div class="typo-desc">Inter - Neutre, universel</div>
                                </div>
                            </div>

                            <div class="typo-option" data-typo="M2">
                                <div class="typo-sample" style="font-family: 'Aref Ruqaa', serif;">Aa</div>
                                <div class="typo-info">
                                    <div class="typo-name">Élégant & premium</div>
                                    <div class="typo-desc">Serif raffiné</div>
                                </div>
                            </div>

                            <div class="typo-option" data-typo="M3">
                                <div class="typo-sample" style="font-family: 'Kaushan Script', cursive;">Aa</div>
                                <div class="typo-info">
                                    <div class="typo-name">Expressif & créatif</div>
                                    <div class="typo-desc">Script dynamique</div>
                                </div>
                            </div>

                            <div class="typo-option" data-typo="M4">
                                <div class="typo-sample" style="font-family: 'Times New Roman', serif;">Aa</div>
                                <div class="typo-info">
                                    <div class="typo-name">Neutre & corporate</div>
                                    <div class="typo-desc">Classique, sobre</div>
                                </div>
                            </div>
                        </div>

                        <div class="typo-preview-card">
                            <div class="typo-preview-title">Aperçu de la typographie</div>
                            <div class="typo-preview-content" id="typoPreview">
                                <!-- Dynamic content -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Ambiance -->
                <div class="step-content" data-step="4">
                    <h2 class="step-title">Ambiance & interactions</h2>
                    <p class="step-description">Affinez l'expérience utilisateur de votre site</p>

                    <div class="substep-indicator" id="substep-indicator">
                        <div class="substep-dot active" data-substep="1"></div>
                        <div class="substep-dot" data-substep="2"></div>
                        <div class="substep-dot" data-substep="3"></div>
                        <div class="substep-dot" data-substep="4"></div>
                        <div class="substep-dot" data-substep="5"></div>
                    </div>

                    <!-- Sub-step 1: Animations -->
                    <div class="substep-content active" data-substep="1">
                        <h3 class="substep-title">Animations</h3>
                        <p class="substep-description">Choisissez le niveau d'animations pour votre site</p>
                        <div class="setting-options">
                            <div class="setting-option" data-setting="anim" data-value="0">Aucune</div>
                            <div class="setting-option" data-setting="anim" data-value="1">Légères</div>
                            <div class="setting-option selected" data-setting="anim" data-value="2">Présentes</div>
                        </div>
                        <div class="demo-preview-area">
                            <div class="demo-preview-label">
                                <i class="fas fa-mouse-pointer"></i>
                                Survolez le bouton pour voir l'effet
                            </div>
                            <div class="demo-preview-content" id="demo-anim"></div>
                        </div>
                    </div>

                    <!-- Sub-step 2: Arrondis -->
                    <div class="substep-content" data-substep="2">
                        <h3 class="substep-title">Arrondis</h3>
                        <p class="substep-description">Définissez le style des bords de vos éléments</p>
                        <div class="setting-options">
                            <div class="setting-option" data-setting="radius" data-value="1">Nets</div>
                            <div class="setting-option" data-setting="radius" data-value="2">Modérés</div>
                            <div class="setting-option selected" data-setting="radius" data-value="3">Doux</div>
                        </div>
                        <div class="demo-preview-area">
                            <div class="demo-preview-content" id="demo-radius"></div>
                        </div>
                    </div>

                    <!-- Sub-step 3: Densité -->
                    <div class="substep-content" data-substep="3">
                        <h3 class="substep-title">Densité</h3>
                        <p class="substep-description">Ajustez l'espacement entre les éléments</p>
                        <div class="setting-options">
                            <div class="setting-option" data-setting="density" data-value="1">Compacte</div>
                            <div class="setting-option selected" data-setting="density" data-value="2">Équilibrée</div>
                            <div class="setting-option" data-setting="density" data-value="3">Aérée</div>
                        </div>
                        <div class="demo-preview-area">
                            <div class="demo-preview-content" id="demo-density"></div>
                        </div>
                    </div>

                    <!-- Sub-step 4: Transitions -->
                    <div class="substep-content" data-substep="4">
                        <h3 class="substep-title">Transitions</h3>
                        <p class="substep-description">Choisissez la vitesse des transitions</p>
                        <div class="setting-options">
                            <div class="setting-option" data-setting="trans" data-value="1">Instantanées</div>
                            <div class="setting-option selected" data-setting="trans" data-value="2">Fluides</div>
                        </div>
                        <div class="demo-preview-area">
                            <div class="demo-preview-content" id="demo-trans"></div>
                        </div>
                    </div>

                    <!-- Sub-step 5: Scroll Animé -->
                    <div class="substep-content" data-substep="5">
                        <h3 class="substep-title">Scroll Animé</h3>
                        <p class="substep-description">Créez une expérience immersive où certains éléments restent fixes
                            pendant que d'autres glissent</p>
                        <div class="setting-options">
                            <div class="setting-option selected" data-setting="scroll" data-value="1">Normal</div>
                            <div class="setting-option" data-setting="scroll" data-value="2">Cinématique</div>
                        </div>
                        <div class="demo-preview-area">
                            <div class="demo-preview-content" id="demo-scroll"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Final Preview -->
                <div class="step-content" data-step="5">
                    <h2 class="step-title">Visualisez votre site</h2>
                    <p class="step-description">Votre configuration est prête ! Visualisez le résultat et ajustez si
                        nécessaire.</p>

                    <div class="preview-trigger">
                        <div class="preview-trigger-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h3>Aperçu de votre site</h3>
                        <p>Cliquez pour voir votre site en plein écran avec tous vos réglages appliqués.</p>
                        <button class="preview-trigger-btn" onclick="openFullscreenPreview()">
                            <i class="fas fa-expand"></i> Voir l'aperçu en grand
                        </button>
                    </div>

                    <div class="token-display">
                        <div class="token-label">Votre Code de Design</div>
                        <div class="token-value" id="token-value">
                            DG1|S:MIN|C:438DD7-FFFFFF-20375D|T:M1|A:2|R:3|D:2|TR:2|SC:1</div>
                        <div class="token-actions">
                            <button class="token-btn" onclick="copyToken()">
                                <i class="fas fa-copy"></i> Copier
                            </button>
                            <button class="token-btn" onclick="openFullscreenPreview()">
                                <i class="fas fa-external-link-alt"></i> Ouvrir l'aperçu
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="nav-buttons">
                    <button class="btn-nav btn-prev" onclick="previousStep()" style="visibility: hidden;">
                        <i class="fas fa-chevron-left"></i> Précédent
                    </button>
                    <button class="btn-nav btn-next" onclick="nextStep()">
                        Suivant <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Inspiration</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Couleurs</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Typo</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Ambiance</div>
            </div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">Aperçu</div>
            </div>
        </div>
    </div>

    <!-- Color Picker Modal - Google Style -->
    <div class="color-picker-modal" id="colorPickerModal">
        <div class="color-picker-content">
            <div class="color-picker-header">
                <h3 class="color-picker-title">Choisir une couleur</h3>
                <button class="color-picker-close" onclick="closeColorPicker()"><i class="fas fa-times"></i></button>
            </div>

            <!-- Saturation/Brightness selection area -->
            <div class="color-picker-sv-area" id="svArea">
                <div class="sv-cursor" id="svCursor"></div>
            </div>

            <!-- Hue slider -->
            <div class="color-picker-hue-section">
                <input type="range" class="hue-slider" id="hueSlider" min="0" max="360" value="210">
            </div>

            <!-- Preview and hex input -->
            <div class="color-picker-bottom">
                <div class="color-picker-preview" id="pickerPreview"></div>
                <input type="text" class="color-picker-hex-input" id="hexInput" value="#438DD7" maxlength="7">
            </div>

            <!-- Color presets -->
            <div class="color-picker-section" style="margin-top: 20px;">
                <label class="color-picker-label">Couleurs prédéfinies</label>
                <div class="color-presets" id="colorPresets"></div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // STATE MANAGEMENT
        // ============================================
        let currentStep = 1;
        const totalSteps = 5;
        let currentSubstep = 1;
        const totalSubsteps = 5;

        const designState = {
            version: 'DG1',
            style: '',
            colors: {
                primary: '#438DD7',
                background: '#FFFFFF',
                accent: '#20375D'
            },
            typography: 'M1',
            settings: {
                animations: 2,
                radius: 3,
                density: 2,
                transitions: 2,
                scroll: 1
            }
        };

        // Style names
        const styleNames = {
            'MIN': 'Minimaliste',
            'GLS': 'Verre Moderne',
            'SFT': 'Doux',
            'EDT': 'Éditorial',
            'LUX': 'Luxe',
            'BRT': 'Brutaliste',
            'RTF': 'Rétro Futur'
        };

        // Font families
        const fontFamilies = {
            'M1': "'Inter', sans-serif",
            'M2': "'Aref Ruqaa', serif",
            'M3': "'Kaushan Script', cursive",
            'M4': "'Times New Roman', serif"
        };

        // External examples data
        const externalExamples = {
            'MIN': [
                { name: 'Apple', url: 'https://apple.com', description: 'Design minimaliste emblématique', image: 'content/images/brand/apple2.png' },
                { name: 'Linear', url: 'https://linear.app', description: 'Interface épurée pour la productivité', image: 'https://picsum.photos/400/250?random=2' },
                { name: 'Notion', url: 'https://notion.so', description: 'Simplicité et fonctionnalité', image: 'https://picsum.photos/400/250?random=3' }
            ],
            'GLS': [
                { name: 'Reflect', url: 'https://reflect.app', description: 'Effets de verre colorés', image: 'https://picsum.photos/400/250?random=4' },
                { name: 'Genesis', url: 'https://www.genesis.live', description: 'Effet de transparence aérés', image: 'https://picsum.photos/400/250?random=5' },
            ],
            'SFT': [
                { name: 'Figma', url: 'https://figma.com', description: 'Design doux et collaboratif', image: 'https://picsum.photos/400/250?random=7' },
                { name: 'Dribbble', url: 'https://dribbble.com', description: 'Communauté créative', image: 'https://picsum.photos/400/250?random=8' },
                { name: 'Material Design', url: 'https://material.io', description: 'Référence du design system', image: 'https://picsum.photos/400/250?random=9' }
            ],
            'EDT': [
                { name: 'Medium', url: 'https://medium.com', description: 'Typographie éditoriale', image: 'https://picsum.photos/400/250?random=10' },
                { name: 'NY Times', url: 'https://nytimes.com', description: 'Design journalistique', image: 'https://picsum.photos/400/250?random=11' },
                { name: 'Bloomberg', url: 'https://bloomberg.com', description: 'Style magazine premium', image: 'https://picsum.photos/400/250?random=12' }
            ],
            'LUX': [
                { name: 'Tesla', url: 'https://tesla.com', description: 'Luxe technologique', image: 'https://picsum.photos/400/250?random=13' },
                { name: 'Bang & Olufsen', url: 'https://bang-olufsen.com', description: 'Design audio premium', image: 'https://picsum.photos/400/250?random=14' },
                { name: 'Rolex', url: 'https://rolex.com', description: 'Excellence horlogère', image: 'https://picsum.photos/400/250?random=15' }
            ],
            'BRT': [
                { name: 'Awwwards', url: 'https://awwwards.com', description: 'Design web avant-gardiste', image: 'https://picsum.photos/400/250?random=16' },
                { name: 'Arc', url: 'https://arc.net', description: 'Interface glass innovante', image: 'https://picsum.photos/400/250?random=6' },
                { name: 'DesignStudio', url: 'https://design.studio', description: 'Agence créative brutale', image: 'https://picsum.photos/400/250?random=17' },
            ],
            'RTF': [
                { name: 'Preload', url: 'https://synthwave.design', description: 'Portefolio synthwave', image: 'https://picsum.photos/400/250?random=19' },
                { name: 'Neon Templates', url: 'https://chronothreads.webflow.io', description: 'vêtements designs et reflets', image: 'https://picsum.photos/400/250?random=20' },
            ]
        };

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            initStyleCards();
            initColorPickers();
            initTypoOptions();
            initSettings();
            initSubsteps();
            initStepIndicatorClicks();
            updateColorPreview();
            updateTypoPreview();
            updateSettingDemos();
            initButtonPressAnimations();
        });

        // ============================================
        // STYLE CARDS
        // ============================================
        function initStyleCards() {
            document.querySelectorAll('.style-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    if (e.target.closest('.style-examples-btn')) return;

                    document.querySelectorAll('.style-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    designState.style = card.dataset.style;
                });
            });
        }

        // ============================================
        // EXTERNAL EXAMPLES
        // ============================================
        function showExamples(styleCode, event) {
            event.stopPropagation();

            const examples = externalExamples[styleCode] || [];
            const title = `Sites d'inspiration - ${styleNames[styleCode]}`;

            document.getElementById('examplesTitle').textContent = title;

            const grid = document.getElementById('examplesGrid');
            grid.innerHTML = examples.map(ex => `
                <div class="example-card">
                    <div class="example-card-content">
                        <h4>${ex.name}</h4>
                        <p>${ex.description}</p>
                        <a href="${ex.url}" target="_blank" rel="noopener" class="example-card-btn">
                            Visiter le site <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                </div>
            `).join('');

            document.getElementById('examplesModal').classList.add('active');
        }

        function closeExamples() {
            document.getElementById('examplesModal').classList.remove('active');
        }

        // ============================================
        // COLOR PREVIEW
        // ============================================
        function updateColorPreview() {
            const { primary, background, accent } = designState.colors;
            const isDark = getLuminance(background) < 0.5;
            const textColor = isDark ? '#ffffff' : '#1a1a1a';
            const textSecondary = isDark ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.6)';

            const mockup = document.getElementById('colorMockup');
            mockup.style.setProperty('--preview-bg', background);
            mockup.innerHTML = `
                <div class="mockup-nav" style="border-color: ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'};">
                    <div class="mockup-logo" style="color: ${primary};">Logo</div>
                    <div class="mockup-links" style="color: ${textSecondary};">
                        <span>Accueil</span>
                        <span>Services</span>
                        <span>Contact</span>
                    </div>
                </div>
                <div class="mockup-hero">
                    <h2 style="color: ${textColor};">Bienvenue sur votre site</h2>
                    <p style="color: ${textSecondary};">Un design qui reflète votre identité</p>
                    <span class="mockup-btn" style="background: ${primary}; color: white;">Découvrir</span>
                </div>
                <div class="mockup-cards">
                    <div class="mockup-card" style="background: ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.03)'};">
                        <div class="mockup-card-icon" style="background: ${primary};"></div>
                        <div class="mockup-card-title" style="color: ${textColor};">Service 1</div>
                    </div>
                    <div class="mockup-card" style="background: ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.03)'};">
                        <div class="mockup-card-icon" style="background: ${accent};"></div>
                        <div class="mockup-card-title" style="color: ${textColor};">Service 2</div>
                    </div>
                    <div class="mockup-card" style="background: ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.03)'};">
                        <div class="mockup-card-icon" style="background: ${primary};"></div>
                        <div class="mockup-card-title" style="color: ${textColor};">Service 3</div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // TYPOGRAPHY PREVIEW
        // ============================================
        function updateTypoPreview() {
            const font = fontFamilies[designState.typography] || fontFamilies['M1'];
            const preview = document.getElementById('typoPreview');
            preview.style.fontFamily = font;
            preview.innerHTML = `
                <h1>Votre titre principal</h1>
                <h2>Un sous-titre accrocheur</h2>
                <p>Voici un exemple de texte qui pourrait apparaître sur votre site. La typographie joue un rôle crucial dans l'identité visuelle et la lisibilité de votre contenu.</p>
                <p class="caption">"La typographie est la voix de votre marque" — Designer</p>
            `;
        }

        // ============================================
        // COLOR PICKERS
        // ============================================
        let currentColorType = 'primary';
        const colorPresets = [
            '#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#9400D3', '#FF1493',
            '#FF6B6B', '#FFB347', '#FFFF99', '#77DD77', '#779ECB', '#B19CD9', '#FFB6C1', '#FFC0CB',
            '#8B0000', '#FF8C00', '#FFD700', '#008000', '#000080', '#800080', '#DC143C', '#FF69B4',
            '#000000', '#404040', '#808080', '#C0C0C0', '#FFFFFF', '#F5F5DC', '#FAEBD7', '#1a1a1a'
        ];

        // Color picker state (HSV)
        let pickerHue = 210;      // 0-360
        let pickerSat = 70;       // 0-100
        let pickerVal = 84;       // 0-100 (brightness/value)
        let isDraggingSV = false;
        // Timestamp of last SV drag end/start to avoid accidental modal close on drag release
        let lastSVDragTime = 0;

        function initColorPickers() {
            ['primary', 'background', 'accent'].forEach(type => {
                const textInput = document.getElementById(`color-${type}-text`);
                textInput.addEventListener('input', (e) => {
                    let color = e.target.value;
                    if (/^#[0-9A-F]{6}$/i.test(color)) {
                        designState.colors[type] = color;
                        document.getElementById(`picker-${type}`).style.backgroundColor = color;
                        updateColorPreview();
                    }
                });
            });

            // Hue slider
            document.getElementById('hueSlider').addEventListener('input', (e) => {
                pickerHue = parseInt(e.target.value);
                updateSVAreaBackground();
                updatePickerFromHSV();
            });

            // Hex input
            document.getElementById('hexInput').addEventListener('input', (e) => {
                let color = e.target.value;
                if (!color.startsWith('#')) color = '#' + color;
                if (/^#[0-9A-F]{6}$/i.test(color)) {
                    const hsv = hexToHsv(color);
                    pickerHue = hsv.h;
                    pickerSat = hsv.s;
                    pickerVal = hsv.v;
                    document.getElementById('hueSlider').value = pickerHue;
                    updateSVAreaBackground();
                    updateSVCursor();
                    updatePickerPreview(color);
                }
            });

            // SV Area mouse/touch events
            const svArea = document.getElementById('svArea');

            svArea.addEventListener('mousedown', (e) => {
                isDraggingSV = true;
                lastSVDragTime = Date.now();
                handleSVDrag(e);
            });

            document.addEventListener('mousemove', (e) => {
                if (isDraggingSV) handleSVDrag(e);
            });

            document.addEventListener('mouseup', () => {
                // Marquer le moment de fin de drag et laisser un petit délai
                lastSVDragTime = Date.now();
                setTimeout(() => {
                    isDraggingSV = false;
                }, 50);
            });

            // Touch events for mobile
            svArea.addEventListener('touchstart', (e) => {
                isDraggingSV = true;
                lastSVDragTime = Date.now();
                handleSVDrag(e.touches[0]);
                e.preventDefault();
            });

            svArea.addEventListener('touchmove', (e) => {
                if (isDraggingSV) {
                    handleSVDrag(e.touches[0]);
                    e.preventDefault();
                }
            });

            svArea.addEventListener('touchend', () => {
                lastSVDragTime = Date.now();
                isDraggingSV = false;
            });
        }

        function handleSVDrag(e) {
            const svArea = document.getElementById('svArea');
            const rect = svArea.getBoundingClientRect();

            let x = e.clientX - rect.left;
            let y = e.clientY - rect.top;

            // Clamp to bounds
            x = Math.max(0, Math.min(x, rect.width));
            y = Math.max(0, Math.min(y, rect.height));

            // Calculate saturation (x) and value/brightness (y)
            pickerSat = (x / rect.width) * 100;
            pickerVal = 100 - (y / rect.height) * 100;

            updateSVCursor();
            updatePickerFromHSV();
        }

        function updateSVAreaBackground() {
            const svArea = document.getElementById('svArea');
            svArea.style.backgroundColor = `hsl(${pickerHue}, 100%, 50%)`;
        }

        function updateSVCursor() {
            const svArea = document.getElementById('svArea');
            const cursor = document.getElementById('svCursor');

            const x = (pickerSat / 100) * svArea.offsetWidth;
            const y = ((100 - pickerVal) / 100) * svArea.offsetHeight;

            cursor.style.left = x + 'px';
            cursor.style.top = y + 'px';
        }

        function updatePickerFromHSV() {
            const color = hsvToHex(pickerHue, pickerSat, pickerVal);
            document.getElementById('hexInput').value = color.toUpperCase();
            updatePickerPreview(color);

            // Update design state and color preview
            if (currentColorType) {
                designState.colors[currentColorType] = color;

                // Update main color picker if it exists
                const textInput = document.getElementById(`color-${currentColorType}-text`);
                if (textInput) textInput.value = color;

                const picker = document.getElementById(`picker-${currentColorType}`);
                if (picker) picker.style.backgroundColor = color;

                // Update toolbar color picker
                const toolbarId = currentColorType === 'background' ? 'toolbar-bg' : `toolbar-${currentColorType}`;
                const toolbarPicker = document.getElementById(toolbarId);
                if (toolbarPicker) toolbarPicker.style.backgroundColor = color;

                updateColorPreview();
            }
        }

        function openColorPicker(colorType) {
            currentColorType = colorType;
            const currentColor = designState.colors[colorType];

            // Convert current color to HSV
            const hsv = hexToHsv(currentColor);
            pickerHue = hsv.h;
            pickerSat = hsv.s;
            pickerVal = hsv.v;

            // Update UI
            document.getElementById('hueSlider').value = pickerHue;
            document.getElementById('hexInput').value = currentColor.toUpperCase();
            updateSVAreaBackground();

            document.getElementById('colorPickerModal').classList.add('active');

            // Need to update cursor position after modal is visible
            setTimeout(() => {
                updateSVCursor();
            }, 10);

            updatePickerPreview(currentColor);

            // Populate presets
            const presetsContainer = document.getElementById('colorPresets');
            presetsContainer.innerHTML = '';
            colorPresets.forEach(color => {
                const preset = document.createElement('div');
                preset.className = 'color-preset';
                preset.style.backgroundColor = color;
                preset.onclick = () => {
                    const hsv = hexToHsv(color);
                    pickerHue = hsv.h;
                    pickerSat = hsv.s;
                    pickerVal = hsv.v;
                    document.getElementById('hueSlider').value = pickerHue;
                    updateSVAreaBackground();
                    updateSVCursor();
                    updatePickerFromHSV();
                    document.querySelectorAll('.color-preset').forEach(p => p.classList.remove('selected'));
                    preset.classList.add('selected');
                };
                presetsContainer.appendChild(preset);
            });
        }

        function closeColorPicker() {
            document.getElementById('colorPickerModal').classList.remove('active');
            // Regenerate preview when closing to apply changes
            if (typeof regeneratePreview === 'function') {
                regeneratePreview();
            }
            if (typeof generateToken === 'function') {
                generateToken();
            }
        }

        function applyAndCloseColorPicker() {
            // Regenerate preview if in fullscreen mode
            if (typeof regeneratePreview === 'function') {
                regeneratePreview();
            }
            if (typeof generateToken === 'function') {
                generateToken();
            }
            closeColorPicker();
        }

        function applyPickerColor(color) {
            const hsv = hexToHsv(color);
            pickerHue = hsv.h;
            pickerSat = hsv.s;
            pickerVal = hsv.v;
            document.getElementById('hueSlider').value = pickerHue;
            updateSVAreaBackground();
            updateSVCursor();
            updatePickerFromHSV();
        }

        function updatePickerPreview(color) {
            const preview = document.getElementById('pickerPreview');
            preview.style.backgroundColor = color;
        }

        // Convert HSV to Hex
        function hsvToHex(h, s, v) {
            s = s / 100;
            v = v / 100;

            const c = v * s;
            const x = c * (1 - Math.abs((h / 60) % 2 - 1));
            const m = v - c;

            let r, g, b;
            if (h < 60) { r = c; g = x; b = 0; }
            else if (h < 120) { r = x; g = c; b = 0; }
            else if (h < 180) { r = 0; g = c; b = x; }
            else if (h < 240) { r = 0; g = x; b = c; }
            else if (h < 300) { r = x; g = 0; b = c; }
            else { r = c; g = 0; b = x; }

            const toHex = (n) => Math.round((n + m) * 255).toString(16).padStart(2, '0');
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
        }

        // Convert Hex to HSV
        function hexToHsv(hex) {
            const rgb = parseInt(hex.slice(1), 16);
            let r = ((rgb >> 16) & 0xff) / 255;
            let g = ((rgb >> 8) & 0xff) / 255;
            let b = (rgb & 0xff) / 255;

            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            const d = max - min;

            let h = 0;
            const s = max === 0 ? 0 : (d / max) * 100;
            const v = max * 100;

            if (d !== 0) {
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) * 60; break;
                    case g: h = ((b - r) / d + 2) * 60; break;
                    case b: h = ((r - g) / d + 4) * 60; break;
                }
            }

            return { h, s, v };
        }

        // Keep hslToHex for compatibility
        function hslToHex(h, s, l) {
            l /= 100;
            const a = s * Math.min(l, 1 - l) / 100;
            const f = n => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return `#${f(0)}${f(8)}${f(4)}`;
        }

        function getLuminance(hex) {
            const rgb = parseInt(hex.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;
            return (0.299 * r + 0.587 * g + 0.114 * b) / 255;
        }

        // ============================================
        // TYPOGRAPHY
        // ============================================
        function initTypoOptions() {
            document.querySelectorAll('.typo-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.typo-option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    designState.typography = option.dataset.typo;
                    updateTypoPreview();
                });
            });
        }

        // Attach press handlers to toolbar buttons to ensure visual feedback on click/touch
        function initButtonPressAnimations() {
            const selectors = 'button, .btn, .toolbar-btn, .modal-btn, .toolbar-action, .style-examples-btn, .style-card, .example-card-btn, .example-card .example-card-btn';
            document.querySelectorAll(selectors).forEach(el => {
                // mouse
                el.addEventListener('mousedown', () => el.classList.add('pressed'));
                el.addEventListener('mouseup', () => el.classList.remove('pressed'));
                el.addEventListener('mouseleave', () => el.classList.remove('pressed'));
                // touch
                el.addEventListener('touchstart', () => el.classList.add('pressed'), { passive: true });
                el.addEventListener('touchend', () => el.classList.remove('pressed'));
            });
        }

        // ============================================
        // SETTINGS
        // ============================================
        function initSettings() {
            document.querySelectorAll('.setting-option').forEach(option => {
                option.addEventListener('click', () => {
                    const setting = option.dataset.setting;
                    const value = parseInt(option.dataset.value);

                    document.querySelectorAll(`.setting-option[data-setting="${setting}"]`).forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');

                    const mappedSetting = setting === 'anim' ? 'animations' :
                        setting === 'trans' ? 'transitions' : setting;
                    designState.settings[mappedSetting] = value;

                    updateSettingDemos();
                });
            });
        }

        function initSubsteps() {
            document.querySelectorAll('.substep-dot').forEach(dot => {
                dot.addEventListener('click', () => {
                    currentSubstep = parseInt(dot.dataset.substep);
                    updateSubstepDisplay();
                });
            });
        }

        // ============================================
        // SETTING DEMOS
        // ============================================
        function updateSettingDemos() {
            const { primary, accent } = designState.colors;
            const { animations, radius, density, transitions, scroll } = designState.settings;

            // Animation demo
            const animClasses = ['anim-none', 'anim-light', 'anim-present'];
            document.getElementById('demo-anim').innerHTML = `
                <button class="demo-anim-btn ${animClasses[animations]}" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                    Survolez-moi
                </button>
            `;

            // Radius demo
            const radiusClasses = ['sharp', 'moderate', 'soft'];
            const radiusLabels = ['Angles nets', 'Angles modérés', 'Angles doux'];
            document.getElementById('demo-radius').innerHTML = `
                <div class="demo-radius-box ${radiusClasses[radius - 1]}" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                    ${radiusLabels[radius - 1]}
                </div>
            `;

            // Density demo
            const densityClasses = ['compact', 'balanced', 'airy'];
            document.getElementById('demo-density').innerHTML = `
                <div class="demo-density-container ${densityClasses[density - 1]}" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                    <div class="demo-density-item">Élément 1</div>
                    <div class="demo-density-item">Élément 2</div>
                    <div class="demo-density-item">Élément 3</div>
                </div>
            `;

            // Transitions demo
            const transClasses = ['instant', 'fluid'];
            document.getElementById('demo-trans').innerHTML = `
                <div class="demo-trans-container">
                    <div class="demo-trans-box ${transClasses[transitions - 1]}" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <div class="demo-trans-hint">
                        <i class="fas fa-mouse-pointer"></i>
                        Survolez le carré pour voir la transition
                    </div>
                </div>
            `;

            // Scroll demo
            const scrollEnabled = scroll === 2;

            if (scrollEnabled) {
                // Scroll animé style Apple : image carrée fixe, textes qui apparaissent/disparaissent
                document.getElementById('demo-scroll').innerHTML = `
                    <div class="demo-scroll-animated" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                        <div class="demo-scroll-image">
                            <i class="fas fa-cube"></i>
                        </div>
                        <div class="demo-scroll-text-area">
                            <div class="demo-scroll-texts">
                                <div class="demo-scroll-text">
                                    <h4>Design innovant</h4>
                                    <p>Une expérience visuelle unique qui captive vos visiteurs.</p>
                                </div>
                                <div class="demo-scroll-text">
                                    <h4>Performance</h4>
                                    <p>Optimisé pour une fluidité parfaite sur tous les appareils.</p>
                                </div>
                                <div class="demo-scroll-text">
                                    <h4>Élégance</h4>
                                    <p>Chaque détail pensé pour créer une impression durable.</p>
                                </div>
                            </div>
                        </div>
                        <div class="demo-scroll-indicator">
                            <div class="demo-scroll-dot"></div>
                            <div class="demo-scroll-dot"></div>
                            <div class="demo-scroll-dot"></div>
                        </div>
                    </div>
                `;
            } else {
                // Scroll standard : tout défile ensemble (mêmes éléments mais tout bouge)
                document.getElementById('demo-scroll').innerHTML = `
                    <div class="demo-scroll-standard" style="--primary-color: ${primary}; --primary-dark: ${accent};">
                        <div class="demo-scroll-standard-content">
                            <div class="demo-scroll-standard-image">
                                <i class="fas fa-cube"></i>
                            </div>
                            <div class="demo-scroll-standard-texts">
                                <div class="demo-scroll-standard-text">
                                    <h4>Design innovant</h4>
                                    <p>Une expérience visuelle unique qui captive vos visiteurs.</p>
                                </div>
                                <div class="demo-scroll-standard-text">
                                    <h4>Performance</h4>
                                    <p>Optimisé pour une fluidité parfaite sur tous les appareils.</p>
                                </div>
                                <div class="demo-scroll-standard-text">
                                    <h4>Élégance</h4>
                                    <p>Chaque détail pensé pour créer une impression durable.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // ============================================
        // NAVIGATION
        // ============================================
        function nextStep() {
            if (currentStep === 4 && currentSubstep < totalSubsteps) {
                currentSubstep++;
                updateSubstepDisplay();
                updateSettingDemos();
                return;
            }

            if (currentStep < totalSteps) {
                if (!validateStep(currentStep)) return;

                currentStep++;
                currentSubstep = 1;
                updateStepDisplay();

                if (currentStep === 5) {
                    generateToken();
                }
            }
        }

        function previousStep() {
            if (currentStep === 4 && currentSubstep > 1) {
                currentSubstep--;
                updateSubstepDisplay();
                updateSettingDemos();
                return;
            }

            if (currentStep > 1) {
                currentStep--;
                if (currentStep === 4) {
                    currentSubstep = totalSubsteps;
                }
                updateStepDisplay();
            }
        }

        function goToStep(step) {
            if (step < 1 || step > totalSteps) return;
            if (step === currentStep) return;

            currentStep = step;
            currentSubstep = 1;
            updateStepDisplay();

            if (currentStep === 5) {
                generateToken();
            }
        }

        function initStepIndicatorClicks() {
            document.querySelectorAll('.step-indicator .step').forEach(step => {
                step.style.cursor = 'pointer';
                step.addEventListener('click', () => {
                    const stepNum = parseInt(step.dataset.step);
                    goToStep(stepNum);
                });
            });
        }

        function updateStepDisplay() {
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                }
            });

            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelector(`.step-content[data-step="${currentStep}"]`).classList.add('active');

            if (currentStep === 4) {
                updateSubstepDisplay();
                updateSettingDemos();
            }

            const prevBtn = document.querySelector('.btn-prev');
            const nextBtn = document.querySelector('.btn-next');

            prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';

            if (currentStep === totalSteps) {
                nextBtn.innerHTML = '<i class="fas fa-check"></i> Terminé';
                nextBtn.classList.add('btn-validate');
                nextBtn.onclick = copyToken;
            } else {
                nextBtn.innerHTML = 'Suivant <i class="fas fa-chevron-right"></i>';
                nextBtn.classList.remove('btn-validate');
                nextBtn.onclick = nextStep;
            }

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateSubstepDisplay() {
            document.querySelectorAll('.substep-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index + 1 === currentSubstep);
            });

            document.querySelectorAll('.substep-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelector(`.substep-content[data-substep="${currentSubstep}"]`)?.classList.add('active');

            updateSettingDemos();
        }

        function validateStep(step) {
            if (step === 1 && !designState.style) {
                showAlert('Sélection requise', 'Veuillez sélectionner une inspiration', 'info');
                return false;
            }
            if (step === 3 && !designState.typography) {
                showAlert('Sélection requise', 'Veuillez sélectionner une typographie', 'info');
                return false;
            }
            return true;
        }

        // ============================================
        // FULLSCREEN PREVIEW
        // ============================================
        function openFullscreenPreview() {
            syncToolbarWithState();
            regeneratePreview();
            document.getElementById('fullscreenPreview').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeFullscreenPreview() {
            document.getElementById('fullscreenPreview').classList.remove('active');
            document.body.style.overflow = '';
        }

        function switchToolbarTab(tabName) {
            const clickedTab = event.currentTarget;
            const isAlreadyActive = clickedTab.classList.contains('active');

            // Remove active from all tabs
            document.querySelectorAll('.toolbar-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active from all panels
            document.querySelectorAll('.toolbar-panel').forEach(panel => {
                panel.classList.remove('active');
            });

            // If it wasn't active before, activate it now
            if (!isAlreadyActive) {
                // Add active to clicked tab
                clickedTab.classList.add('active');

                // Show corresponding panel
                const panel = document.getElementById(`panel-${tabName}`);
                if (panel) {
                    panel.classList.add('active');
                }
            }
        }

        function closeToolbarPanel() {
            document.querySelectorAll('.toolbar-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.toolbar-panel').forEach(panel => {
                panel.classList.remove('active');
            });
        }

        function syncToolbarWithState() {
            document.getElementById('toolbar-primary').style.backgroundColor = designState.colors.primary;
            document.getElementById('toolbar-bg').style.backgroundColor = designState.colors.background;
            document.getElementById('toolbar-accent').style.backgroundColor = designState.colors.accent;
            document.getElementById('toolbar-typo').value = designState.typography || 'M1';

            // Update button groups
            updateToolbarButtonGroup('radius', designState.settings.radius);
            updateToolbarButtonGroup('density', designState.settings.density);
            updateToolbarButtonGroup('anim', designState.settings.animations);
            updateToolbarButtonGroup('scroll', designState.settings.scroll);
        }

        function updateToolbarButtonGroup(setting, value) {
            document.querySelectorAll(`.toolbar-btn[data-setting="${setting}"]`).forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.value) === value);
            });
        }

        function updateFromToolbar() {
            // Typography only - colors are updated through the color picker
            designState.typography = document.getElementById('toolbar-typo').value;

            regeneratePreview();
            generateToken();
        }

        // Open color picker for toolbar color selection
        function openToolbarColorPicker(colorType) {
            openColorPicker(colorType);
        }

        function setToolbarSetting(setting, value) {
            const mappedSetting = setting === 'anim' ? 'animations' : setting;
            designState.settings[mappedSetting] = value;
            updateToolbarButtonGroup(setting, value);
            // Apply animation setting to the UI
            applyAnimationSetting();
            // Update demo visuals when toolbar setting changes
            updateSettingDemos();
            regeneratePreview();
            generateToken();
        }

        function applyAnimationSetting() {
            try {
                const animations = designState.settings.animations;
                const root = document.documentElement;
                if (animations === 0) {
                    root.classList.add('no-animations');
                    root.classList.remove('anim-light');
                    root.classList.remove('anim-present');
                } else if (animations === 1) {
                    root.classList.remove('no-animations');
                    root.classList.add('anim-light');
                    root.classList.remove('anim-present');
                } else {
                    root.classList.remove('no-animations');
                    root.classList.remove('anim-light');
                    root.classList.add('anim-present');
                }
            } catch (e) { console.error(e); }
        }

        function regeneratePreview() {
            const iframe = document.getElementById('previewIframe');
            const html = generateSiteHTML();
            const blob = new Blob([html], { type: 'text/html' });
            iframe.src = URL.createObjectURL(blob);

            // Fermer les panels quand on interagit avec l'iframe
            iframe.onload = function () {
                try {
                    iframe.contentWindow.addEventListener('scroll', closeToolbarPanel, { passive: true });
                    iframe.contentWindow.addEventListener('click', closeToolbarPanel);
                } catch (e) {
                    // Ignore cross-origin errors
                }
            };
        }

        // ============================================
        // SITE GENERATION
        // ============================================
        function generateSiteHTML() {
            const { style, colors, typography, settings } = designState;
            const { primary, background, accent } = colors;
            const { radius, density, animations, scroll } = settings;

            const borderRadius = radius === 1 ? '4px' : radius === 2 ? '12px' : '24px';
            const spacing = density === 1 ? '16px' : density === 2 ? '24px' : '40px';
            const font = fontFamilies[typography] || fontFamilies['M1'];
            const parallaxEnabled = scroll === 2;

            // Animation scale helpers: 0 = none, 1 = light, 2 = present
            const btnTransition = animations === 0 ? 'none' : animations === 1 ? 'all 0.18s ease' : 'all 0.3s ease';
            const btnHoverTransform = animations === 0 ? '' : animations === 1 ? 'transform: translateY(-2px) scale(1.02); box-shadow: 0 6px 16px rgba(0,0,0,0.08);' : 'transform: translateY(-4px) scale(1.05); box-shadow: 0 12px 32px rgba(0,0,0,0.15);';
            const featureTransition = animations === 0 ? 'none' : animations === 1 ? 'all 0.18s ease' : 'all 0.3s ease';
            const featureHover = animations === 0 ? '' : animations === 1 ? 'transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.08);' : 'transform: translateY(-8px); box-shadow: 0 12px 32px rgba(0,0,0,0.15);';

            const isDark = getLuminance(background) < 0.5;
            const textColor = isDark ? '#ffffff' : '#1a1a1a';
            const textSecondary = isDark ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.6)';

            const parallaxCSS = parallaxEnabled ? `
        .scroll-story {
            position: relative;
            background: linear-gradient(180deg, #000000 0%, #0a0a0a 50%, #000000 100%);
            min-height: 600vh;
        }
        .scroll-story-sticky {
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .scroll-story-image {
            width: 320px;
            height: 320px;
            background: linear-gradient(145deg, ${primary} 0%, ${accent} 100%);
            border-radius: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow:
                0 60px 150px rgba(0,0,0,0.6),
                0 0 80px rgba(${primary}, 0.3);
            flex-shrink: 0;
            will-change: transform;
        }
        .scroll-story-image i {
            font-size: 6rem;
            color: white;
            will-change: transform;
        }
        .scroll-story-texts {
            position: absolute;
            right: 10%;
            top: 50%;
            transform: translateY(-50%);
            width: 40%;
            max-width: 500px;
        }
        .scroll-story-text {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            opacity: 0;
            transform: translateY(100px) scale(0.9);
            filter: blur(10px);
            transition: all 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .scroll-story-text.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            filter: blur(0);
        }
        .scroll-story-text.exit-up {
            opacity: 0;
            transform: translateY(-100px) scale(0.9);
            filter: blur(10px);
        }
        .scroll-story-text h3 {
            color: #fff;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 24px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        .scroll-story-text p {
            color: rgba(255,255,255,0.8);
            font-size: 1.3rem;
            line-height: 1.8;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .scroll-story-dots {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 14px;
            z-index: 100;
            padding: 10px 16px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 30px;
        }
        .scroll-story-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .scroll-story-dot:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.15);
        }
        .scroll-story-dot.active {
            background: #fff;
            transform: scale(1.4);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.6);
        }
        @media (max-width: 900px) {
            .scroll-story {
                min-height: 500vh;
            }
            .scroll-story-sticky {
                flex-direction: column;
                padding: 60px 20px;
            }
            .scroll-story-image {
                width: 200px;
                height: 200px;
                margin-bottom: 50px;
            }
            .scroll-story-image i {
                font-size: 4rem;
            }
            .scroll-story-texts {
                position: relative;
                right: auto;
                top: auto;
                transform: none;
                width: 100%;
                text-align: center;
            }
            .scroll-story-text h3 {
                font-size: 2rem;
                margin-bottom: 16px;
            }
            .scroll-story-text p {
                font-size: 1.1rem;
                line-height: 1.6;
            }
        }
        @media (max-width: 480px) {
            .scroll-story {
                min-height: 450vh;
            }
            .scroll-story-image {
                width: 150px;
                height: 150px;
                margin-bottom: 40px;
            }
            .scroll-story-image i {
                font-size: 3rem;
            }
            .scroll-story-text h3 {
                font-size: 1.6rem;
            }
            .scroll-story-text p {
                font-size: 0.95rem;
            }
        }` : '';

            const parallaxHTML = parallaxEnabled ? `
    <section class="scroll-story">
        <div class="scroll-story-sticky">
            <div class="scroll-story-image">
                <i class="fas fa-cube"></i>
            </div>
            <div class="scroll-story-texts">
                <div class="scroll-story-text active">
                    <h3>Design Innovant</h3>
                    <p>Une expérience visuelle unique qui captive vos visiteurs dès les premiers instants et marque les esprits.</p>
                </div>
                <div class="scroll-story-text">
                    <h3>Interactions Fluides</h3>
                    <p>Chaque mouvement, chaque transition est pensée pour offrir une navigation naturelle et intuitive.</p>
                </div>
                <div class="scroll-story-text">
                    <h3>Performance Optimale</h3>
                    <p>Des animations ultra-rapides et fluides qui fonctionnent parfaitement sur tous les appareils.</p>
                </div>
                <div class="scroll-story-text">
                    <h3>Attention aux Détails</h3>
                    <p>Chaque pixel compte. Une typographie soignée, des espacements harmonieux, une cohérence parfaite.</p>
                </div>
                <div class="scroll-story-text">
                    <h3>Expérience Immersive</h3>
                    <p>Plongez dans un univers où chaque élément raconte une histoire et guide l'utilisateur naturellement.</p>
                </div>
                <div class="scroll-story-text">
                    <h3>Élégance Intemporelle</h3>
                    <p>Un design qui traverse le temps, alliant modernité et raffinement pour une impression durable.</p>
                </div>
            </div>
        </div>
        <div class="scroll-story-dots">
            <div class="scroll-story-dot active"></div>
            <div class="scroll-story-dot"></div>
            <div class="scroll-story-dot"></div>
            <div class="scroll-story-dot"></div>
            <div class="scroll-story-dot"></div>
            <div class="scroll-story-dot"></div>
        </div>
    </section>
    <script>
    (function(){
        const story = document.querySelector('.scroll-story');
        if (!story) return;
        const image = document.querySelector('.scroll-story-image');
        const icon = image.querySelector('i');
        const texts = document.querySelectorAll('.scroll-story-text');
        const dots = document.querySelectorAll('.scroll-story-dot');
        const n = texts.length;
        function update() {
            const rect = story.getBoundingClientRect();
            const progress = Math.max(0, Math.min(1, -rect.top / (story.offsetHeight - window.innerHeight)));
            const idx = Math.min(n - 1, Math.floor(progress * n));

            // Effets sur l'image
            const rotation = progress * 360;
            const scale = 1 + Math.sin(progress * Math.PI * 2) * 0.15;
            const iconRotation = -rotation * 0.5;

            image.style.transform = \`rotate(\${rotation}deg) scale(\${scale})\`;
            icon.style.transform = \`rotate(\${iconRotation}deg)\`;

            // Effets sur les textes
            texts.forEach((t, i) => {
                t.classList.remove('active', 'exit-up');
                if (i === idx) t.classList.add('active');
                else if (i < idx) t.classList.add('exit-up');
            });
            dots.forEach((d, i) => d.classList.toggle('active', i === idx));
        }
        window.addEventListener('scroll', update, { passive: true });
        update();
    })();
    <\/script>` : '';

            return `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Aref+Ruqaa:wght@400;700&family=Kaushan+Script&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: ${font};
            background: ${background};
            color: ${textColor};
            line-height: 1.6;
        }
        nav {
            padding: ${spacing};
            background: ${isDark ? 'rgba(255,255,255,0.02)' : 'rgba(0,0,0,0.01)'};
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid ${isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)'};
            position: ${parallaxEnabled ? 'sticky' : 'relative'};
            top: 0;
            z-index: 100;
        }
        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: ${primary};
        }
        .nav-links {
            display: flex;
            gap: ${spacing};
            list-style: none;
        }
        .nav-links a {
            color: ${textSecondary};
            text-decoration: none;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: ${primary}; }
        .hero {
            padding: calc(${spacing} * 4) ${spacing};
            text-align: center;
            min-height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .hero h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: ${spacing};
            color: ${textColor};
        }
        .hero p {
            font-size: 1.2rem;
            color: ${textSecondary};
            max-width: 600px;
            margin-bottom: calc(${spacing} * 1.5);
        }
        .btn {
            display: inline-block;
            padding: 16px 40px;
            background: ${primary};
            color: white;
            text-decoration: none;
            border-radius: ${borderRadius};
            font-weight: 600;
            transition: ${btnTransition};
        }
        .btn:hover {
            background: ${accent};
            ${btnHoverTransform}
        }
        .features {
            padding: calc(${spacing} * 3) ${spacing};
            max-width: 1200px;
            margin: 0 auto;
        }
        .features h2 {
            text-align: center;
            margin-bottom: calc(${spacing} * 2);
            color: ${textColor};
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: ${spacing};
        }
        .feature-card {
            background: ${isDark ? 'rgba(255,255,255,0.05)' : '#ffffff'};
            padding: ${spacing};
            border-radius: ${borderRadius};
            border: 1px solid ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.08)'};
            transition: ${featureTransition};
        }
        .feature-card:hover {
            ${featureHover}
        }
        .feature-card h3 {
            color: ${primary};
            margin-bottom: 12px;
        }
        .feature-card p {
            color: ${textSecondary};
        }
        ${parallaxCSS}
        .cta {
            padding: calc(${spacing} * 3) ${spacing};
            background: ${primary};
            text-align: center;
        }
        .cta h2 {
            color: white;
            margin-bottom: ${spacing};
        }
        .cta p {
            color: rgba(255,255,255,0.9);
            margin-bottom: calc(${spacing} * 1.5);
        }
        .cta .btn {
            background: white;
            color: ${primary};
        }
        .cta .btn:hover {
            background: ${accent};
            color: white;
        }
        footer {
            padding: calc(${spacing} * 2) ${spacing};
            text-align: center;
            color: ${textSecondary};
            border-top: 1px solid ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'};
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-content">
            <div class="logo">VotreLogo</div>
            <ul class="nav-links">
                <li><a href="#">Accueil</a></li>
                <li><a href="#">Services</a></li>
                <li><a href="#">À propos</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </nav>

    <section class="hero">
        <h1>Bienvenue sur votre site</h1>
        <p>Un design unique inspiré du style ${styleNames[style] || 'personnalisé'}. Moderne, élégant et parfaitement adapté à votre image de marque.</p>
        <a href="#" class="btn">Découvrir</a>
    </section>

    <section class="features">
        <h2>Nos Services</h2>
        <div class="features-grid">
            <div class="feature-card">
                <h3>Design Moderne</h3>
                <p>Une interface soignée et actuelle qui reflète les dernières tendances du web design.</p>
            </div>
            <div class="feature-card">
                <h3>Performance</h3>
                <p>Optimisé pour une navigation rapide et fluide sur tous les appareils.</p>
            </div>
            <div class="feature-card">
                <h3>Accessibilité</h3>
                <p>Conçu pour être accessible à tous les utilisateurs, sans exception.</p>
            </div>
        </div>
    </section>
    ${parallaxHTML}
    <section class="cta">
        <h2>Prêt à démarrer ?</h2>
        <p>Contactez-nous pour discuter de votre projet et donner vie à vos idées.</p>
        <a href="#" class="btn">Nous contacter</a>
    </section>

    <footer>
        <p>© 2026 VotreSite. Créé avec Alpstone Studio.</p>
    </footer>
</body>
</html>`;
        }

        // ============================================
        // TOKEN
        // ============================================
        function generateToken() {
            const { version, style, colors, typography, settings } = designState;
            const colorStr = `${colors.primary.replace('#', '')}-${colors.background.replace('#', '')}-${colors.accent.replace('#', '')}`;
            const token = `${version}|S:${style}|C:${colorStr}|T:${typography}|A:${settings.animations}|R:${settings.radius}|D:${settings.density}|TR:${settings.transitions}|SC:${settings.scroll}`;

            document.getElementById('token-value').textContent = token;
            return token;
        }

        function parseToken(token) {
            try {
                const parts = token.split('|');
                designState.version = parts[0];

                parts.forEach(part => {
                    if (part.startsWith('S:')) designState.style = part.substring(2);
                    else if (part.startsWith('C:')) {
                        const colors = part.substring(2).split('-');
                        designState.colors.primary = '#' + colors[0];
                        designState.colors.background = '#' + colors[1];
                        designState.colors.accent = '#' + colors[2];
                    }
                    else if (part.startsWith('T:')) designState.typography = part.substring(2);
                    else if (part.startsWith('A:')) designState.settings.animations = parseInt(part.substring(2));
                    else if (part.startsWith('R:')) designState.settings.radius = parseInt(part.substring(2));
                    else if (part.startsWith('D:')) designState.settings.density = parseInt(part.substring(2));
                    else if (part.startsWith('TR:')) designState.settings.transitions = parseInt(part.substring(3));
                    else if (part.startsWith('SC:')) designState.settings.scroll = parseInt(part.substring(3));
                });

                return true;
            } catch (e) {
                console.error('Invalid token:', e);
                return false;
            }
        }

        function copyToken() {
            const token = generateToken();
            navigator.clipboard.writeText(token).then(() => {
                showAlert('Code copié !', 'Votre code de design a été copié dans le presse-papier.', 'success');
            });
        }

        // ============================================
        // UI HELPERS
        // ============================================
        function startOnboarding() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('onboardingContainer').style.display = 'flex';
        }

        function showTokenInput() {
            showPrompt('Entrez votre code', 'Collez votre code de design pour charger votre configuration :', 'info', (token) => {
                if (token && parseToken(token)) {
                    updateUIFromState();
                    startOnboarding();
                    goToStep(5); // Aller directement à l'étape 5
                    showAlert('Code chargé !', 'Votre configuration a été restaurée.', 'success');
                } else if (token) {
                    showAlert('Code invalide', 'Le code entré n\'est pas valide.', 'error');
                }
            });
        }

        function updateUIFromState() {
            // Update style selection
            document.querySelectorAll('.style-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.style === designState.style);
            });

            // Update colors
            ['primary', 'background', 'accent'].forEach(type => {
                document.getElementById(`color-${type}-text`).value = designState.colors[type];
                document.getElementById(`picker-${type}`).style.backgroundColor = designState.colors[type];
            });

            // Update typography
            document.querySelectorAll('.typo-option').forEach(option => {
                option.classList.toggle('selected', option.dataset.typo === designState.typography);
            });

            // Update settings
            Object.keys(designState.settings).forEach(key => {
                const settingKey = key === 'animations' ? 'anim' : key === 'transitions' ? 'trans' : key;
                const value = designState.settings[key];
                document.querySelectorAll(`.setting-option[data-setting="${settingKey}"]`).forEach(option => {
                    option.classList.toggle('selected', parseInt(option.dataset.value) === value);
                });
            });

            updateColorPreview();
            updateTypoPreview();
            updateSettingDemos();
        }

        function showAlert(title, message, type) {
            const modal = document.getElementById('customModal');
            document.getElementById('modalIcon').className = `modal-icon ${type}`;
            document.getElementById('modalIcon').innerHTML = type === 'success' ? '<i class="fas fa-check-circle"></i>' :
                type === 'error' ? '<i class="fas fa-times-circle"></i>' :
                    '<i class="fas fa-info-circle"></i>';
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').textContent = message;
            document.getElementById('modalInputContainer').innerHTML = '';
            document.getElementById('modalActions').innerHTML = '<button class="modal-btn modal-btn-primary" onclick="closeModal()">OK</button>';
            modal.classList.add('active');
        }

        function showPrompt(title, message, type, callback) {
            const modal = document.getElementById('customModal');
            document.getElementById('modalIcon').className = `modal-icon ${type}`;
            document.getElementById('modalIcon').innerHTML = '<i class="fas fa-keyboard"></i>';
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').textContent = message;
            document.getElementById('modalInputContainer').innerHTML = '<input type="text" class="modal-input" id="promptInput" placeholder="Collez votre code...">';
            document.getElementById('modalActions').innerHTML = `
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Annuler</button>
                <button class="modal-btn modal-btn-primary" onclick="submitPrompt()">Valider</button>
            `;
            window.promptCallback = callback;
            modal.classList.add('active');
            setTimeout(() => document.getElementById('promptInput')?.focus(), 100);
        }

        function submitPrompt() {
            const value = document.getElementById('promptInput')?.value;
            if (window.promptCallback) {
                window.promptCallback(value);
                window.promptCallback = null;
            }
            closeModal();
        }

        function closeModal() {
            document.getElementById('customModal').classList.remove('active');
        }

        // Close modals on outside click
        document.getElementById('colorPickerModal')?.addEventListener('click', (e) => {
            // Ne pas fermer si on est en train de dragger le color picker
            // ou si un drag vient juste d'avoir lieu (évite fermeture lors du release hors du svArea)
            const now = Date.now();
            const recentDrag = (lastSVDragTime && (now - lastSVDragTime) < 300);
            if (e.target.id === 'colorPickerModal' && !isDraggingSV && !recentDrag) closeColorPicker();
        });

        document.getElementById('examplesModal')?.addEventListener('click', (e) => {
            if (e.target.id === 'examplesModal') closeExamples();
        });

        // Fermer les panels de la toolbar au scroll ou clic en dehors
        document.addEventListener('scroll', () => {
            closeToolbarPanel();
        }, { passive: true });

        document.addEventListener('click', (e) => {
            const toolbar = document.querySelector('.floating-toolbar');
            if (toolbar && !toolbar.contains(e.target)) {
                closeToolbarPanel();
            }
        });

        // Close fullscreen preview on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeFullscreenPreview();
            }
        });
    </script>
</body>

</html>